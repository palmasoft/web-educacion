var HotspotsMarker={"id":"3","lat":11.24356,"lng":-74.204514,"title":"INSTITUCI\u00d3N EDUCATIVA DISTRITAL T\u00c9CNICO INDUSTRIAL","description":"<strong>INSTITUCI\u00d3N EDUCATIVA DISTRITAL T\u00c9CNICO INDUSTRIAL<\/strong><br\/><br\/>\n\n","icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png"};var HotspotsConfig={"rootUrl":"https:\/\/educacion-jpllinas.c9users.io\/","baseUrl":"https:\/\/educacion-jpllinas.c9users.io\/index.php","mapStartPosition":"Santa Marta, Colombia","mapStartZoom":10,"mapStartZoomSingle":10,"centerType":1,"customUserZoom":15,"searchZoom":14,"apiKey":"","mapHeight":600,"mapHeightSingle":300,"startFullscreen":0,"getDirections":1,"mapBackgroundColor":"#E5E3DF","mapType":1,"panControl":1,"panControlPosition":"TOP_LEFT","zoomControl":1,"zoomControlStyle":"DEFAULT","zoomControlPosition":"TOP_LEFT","mapTypeControl":1,"mapTypeControlStyle":"DEFAULT","mapTypeControlPosition":"TOP_RIGHT","scaleControl":1,"fullscreenControl":1,"streetViewControl":1,"streetViewPosition":"TOP_LEFT","overviewMapControl":1,"scrollwheel":1,"gestureHandling":"greedy","styledMaps":"","userInterface":1,"print":1,"resizeMap":1,"mailMap":0,"listLength":99,"showDirections":1,"showAddress":1,"showCountry":0,"showZoomButton":1,"showAuthor":1,"showDate":0,"numOfCatsToShow":5,"categoryInfo":0,"showMarkerCount":1,"weatherLayer":0,"weatherLayerApiKey":"","weatherTemperatureUnit":"CELSIUS","trafficLayer":0,"transitLayer":0,"bicyclingLayer":0,"visualRefresh":1,"draggableDirections":1,"startClosedMenu":0,"startTab":"hotspots","language":"es-ES","tiles":0,"categories":[{"id":"107","cat_name":"Colegios","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"255,3,3","import_table":"","import_id":""},"boundaries":{"catid":"107","south":"11.243560","north":"11.243560","east":"-74.204514","west":"-74.204514"}},{"id":"91","cat_name":"Comuna 1","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"5,13,255","import_table":"","import_id":""}},{"id":"92","cat_name":"Comuna 2","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"5,13,255","import_table":"","import_id":""}},{"id":"93","cat_name":"Comuna 3","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"5,13,255","import_table":"","import_id":""}},{"id":"94","cat_name":"Comuna 4","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"5,13,255","import_table":"","import_id":""},"boundaries":{"catid":"94","south":"11.243361","north":"11.243361","east":"-74.203499","west":"-74.203499"}},{"id":"95","cat_name":"Comuna 5","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"5,13,255","import_table":"","import_id":""}},{"id":"96","cat_name":"Comuna 6","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"5,13,255","import_table":"","import_id":""}},{"id":"97","cat_name":"Comuna 7","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"5,13,255","import_table":"","import_id":""}},{"id":"98","cat_name":"Comuna 8","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"5,13,255","import_table":"","import_id":""}},{"id":"99","cat_name":"Comuna 9","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"5,13,255","import_table":"","import_id":""}},{"id":"100","cat_name":"Taganga","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"255,68,5","import_table":"","import_id":""},"boundaries":{"catid":"100","south":"11.265763","north":"11.265763","east":"-74.187767","west":"-74.187767"}},{"id":"101","cat_name":"Bonda","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"255,68,5","import_table":"","import_id":""}},{"id":"102","cat_name":"Minca","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"255,68,5","import_table":"","import_id":""}},{"id":"103","cat_name":"Sierra Nevada de Santa Marta","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"255,68,5","import_table":"","import_id":""}},{"id":"104","cat_name":"Troncal del Caribe","cat_description":"","cat_icon":"https:\/\/educacion-jpllinas.c9users.io\/images\/marcador-mapa-educacion-32x52.png","params":{"category_layout":"","image":"","image_alt":"","icon":"images\/marcador-mapa-educacion-32x52.png","hs-marker-image":"images\/marcador-mapa-educacion-32x52.png","tile_marker_color":"255,68,5","import_table":"","import_id":""}}],"tabs":[{"id":1,"tabName":"<span class=\"fa fa-location-arrow\"><\/span> Directions","dataName":"directions","content":""},{"id":2,"tabName":"<span class=\"fa fa-map-marker\"><\/span> Instituciones","dataName":"hotspots","content":""},{"id":3,"tabName":"<span class=\"fa fa-cog\"><\/span> Settings","dataName":"settings","content":""}],"translations":{"enterValidAddress":"Please enter a valid address","provideStartAddress":"Please provide start address","provideEndAddress":"Please provide end address","myLocation":"My location"}};/*!

 handlebars v2.0.0

Copyright (C) 2011-2014 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

@license
*/
(function(root,factory){if(typeof define==='function'&&define.amd){define([],factory);}else if(typeof exports==='object'){module.exports=factory();}else{root.Handlebars=root.Handlebars||factory();}}(this,function(){var __module4__=(function(){"use strict";var __exports__;function SafeString(string){this.string=string;}
SafeString.prototype.toString=function(){return""+this.string;};__exports__=SafeString;return __exports__;})();var __module3__=(function(__dependency1__){"use strict";var __exports__={};var SafeString=__dependency1__;var escape={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var badChars=/[&<>"'`]/g;var possible=/[&<>"'`]/;function escapeChar(chr){return escape[chr];}
function extend(obj){for(var i=1;i<arguments.length;i++){for(var key in arguments[i]){if(Object.prototype.hasOwnProperty.call(arguments[i],key)){obj[key]=arguments[i][key];}}}
return obj;}
__exports__.extend=extend;var toString=Object.prototype.toString;__exports__.toString=toString;var isFunction=function(value){return typeof value==='function';};if(isFunction(/x/)){isFunction=function(value){return typeof value==='function'&&toString.call(value)==='[object Function]';};}
var isFunction;__exports__.isFunction=isFunction;var isArray=Array.isArray||function(value){return(value&&typeof value==='object')?toString.call(value)==='[object Array]':false;};__exports__.isArray=isArray;function escapeExpression(string){if(string instanceof SafeString){return string.toString();}else if(string==null){return"";}else if(!string){return string+'';}
string=""+string;if(!possible.test(string)){return string;}
return string.replace(badChars,escapeChar);}
__exports__.escapeExpression=escapeExpression;function isEmpty(value){if(!value&&value!==0){return true;}else if(isArray(value)&&value.length===0){return true;}else{return false;}}
__exports__.isEmpty=isEmpty;function appendContextPath(contextPath,id){return(contextPath?contextPath+'.':'')+id;}
__exports__.appendContextPath=appendContextPath;return __exports__;})(__module4__);var __module5__=(function(){"use strict";var __exports__;var errorProps=['description','fileName','lineNumber','message','name','number','stack'];function Exception(message,node){var line;if(node&&node.firstLine){line=node.firstLine;message+=' - '+line+':'+node.firstColumn;}
var tmp=Error.prototype.constructor.call(this,message);for(var idx=0;idx<errorProps.length;idx++){this[errorProps[idx]]=tmp[errorProps[idx]];}
if(line){this.lineNumber=line;this.column=node.firstColumn;}}
Exception.prototype=new Error();__exports__=Exception;return __exports__;})();var __module2__=(function(__dependency1__,__dependency2__){"use strict";var __exports__={};var Utils=__dependency1__;var Exception=__dependency2__;var VERSION="2.0.0";__exports__.VERSION=VERSION;var COMPILER_REVISION=6;__exports__.COMPILER_REVISION=COMPILER_REVISION;var REVISION_CHANGES={1:'<= 1.0.rc.2',2:'== 1.0.0-rc.3',3:'== 1.0.0-rc.4',4:'== 1.x.x',5:'== 2.0.0-alpha.x',6:'>= 2.0.0-beta.1'};__exports__.REVISION_CHANGES=REVISION_CHANGES;var isArray=Utils.isArray,isFunction=Utils.isFunction,toString=Utils.toString,objectType='[object Object]';function HandlebarsEnvironment(helpers,partials){this.helpers=helpers||{};this.partials=partials||{};registerDefaultHelpers(this);}
__exports__.HandlebarsEnvironment=HandlebarsEnvironment;HandlebarsEnvironment.prototype={constructor:HandlebarsEnvironment,logger:logger,log:log,registerHelper:function(name,fn){if(toString.call(name)===objectType){if(fn){throw new Exception('Arg not supported with multiple helpers');}
Utils.extend(this.helpers,name);}else{this.helpers[name]=fn;}},unregisterHelper:function(name){delete this.helpers[name];},registerPartial:function(name,partial){if(toString.call(name)===objectType){Utils.extend(this.partials,name);}else{this.partials[name]=partial;}},unregisterPartial:function(name){delete this.partials[name];}};function registerDefaultHelpers(instance){instance.registerHelper('helperMissing',function(){if(arguments.length===1){return undefined;}else{throw new Exception("Missing helper: '"+arguments[arguments.length-1].name+"'");}});instance.registerHelper('blockHelperMissing',function(context,options){var inverse=options.inverse,fn=options.fn;if(context===true){return fn(this);}else if(context===false||context==null){return inverse(this);}else if(isArray(context)){if(context.length>0){if(options.ids){options.ids=[options.name];}
return instance.helpers.each(context,options);}else{return inverse(this);}}else{if(options.data&&options.ids){var data=createFrame(options.data);data.contextPath=Utils.appendContextPath(options.data.contextPath,options.name);options={data:data};}
return fn(context,options);}});instance.registerHelper('each',function(context,options){if(!options){throw new Exception('Must pass iterator to #each');}
var fn=options.fn,inverse=options.inverse;var i=0,ret="",data;var contextPath;if(options.data&&options.ids){contextPath=Utils.appendContextPath(options.data.contextPath,options.ids[0])+'.';}
if(isFunction(context)){context=context.call(this);}
if(options.data){data=createFrame(options.data);}
if(context&&typeof context==='object'){if(isArray(context)){for(var j=context.length;i<j;i++){if(data){data.index=i;data.first=(i===0);data.last=(i===(context.length-1));if(contextPath){data.contextPath=contextPath+i;}}
ret=ret+fn(context[i],{data:data});}}else{for(var key in context){if(context.hasOwnProperty(key)){if(data){data.key=key;data.index=i;data.first=(i===0);if(contextPath){data.contextPath=contextPath+key;}}
ret=ret+fn(context[key],{data:data});i++;}}}}
if(i===0){ret=inverse(this);}
return ret;});instance.registerHelper('if',function(conditional,options){if(isFunction(conditional)){conditional=conditional.call(this);}
if((!options.hash.includeZero&&!conditional)||Utils.isEmpty(conditional)){return options.inverse(this);}else{return options.fn(this);}});instance.registerHelper('unless',function(conditional,options){return instance.helpers['if'].call(this,conditional,{fn:options.inverse,inverse:options.fn,hash:options.hash});});instance.registerHelper('with',function(context,options){if(isFunction(context)){context=context.call(this);}
var fn=options.fn;if(!Utils.isEmpty(context)){if(options.data&&options.ids){var data=createFrame(options.data);data.contextPath=Utils.appendContextPath(options.data.contextPath,options.ids[0]);options={data:data};}
return fn(context,options);}else{return options.inverse(this);}});instance.registerHelper('log',function(message,options){var level=options.data&&options.data.level!=null?parseInt(options.data.level,10):1;instance.log(level,message);});instance.registerHelper('lookup',function(obj,field){return obj&&obj[field];});}
var logger={methodMap:{0:'debug',1:'info',2:'warn',3:'error'},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(level,message){if(logger.level<=level){var method=logger.methodMap[level];if(typeof console!=='undefined'&&console[method]){console[method].call(console,message);}}}};__exports__.logger=logger;var log=logger.log;__exports__.log=log;var createFrame=function(object){var frame=Utils.extend({},object);frame._parent=object;return frame;};__exports__.createFrame=createFrame;return __exports__;})(__module3__,__module5__);var __module6__=(function(__dependency1__,__dependency2__,__dependency3__){"use strict";var __exports__={};var Utils=__dependency1__;var Exception=__dependency2__;var COMPILER_REVISION=__dependency3__.COMPILER_REVISION;var REVISION_CHANGES=__dependency3__.REVISION_CHANGES;var createFrame=__dependency3__.createFrame;function checkRevision(compilerInfo){var compilerRevision=compilerInfo&&compilerInfo[0]||1,currentRevision=COMPILER_REVISION;if(compilerRevision!==currentRevision){if(compilerRevision<currentRevision){var runtimeVersions=REVISION_CHANGES[currentRevision],compilerVersions=REVISION_CHANGES[compilerRevision];throw new Exception("Template was precompiled with an older version of Handlebars than the current runtime. "+"Please update your precompiler to a newer version ("+runtimeVersions+") or downgrade your runtime to an older version ("+compilerVersions+").");}else{throw new Exception("Template was precompiled with a newer version of Handlebars than the current runtime. "+"Please update your runtime to a newer version ("+compilerInfo[1]+").");}}}
__exports__.checkRevision=checkRevision;function template(templateSpec,env){if(!env){throw new Exception("No environment passed to template");}
if(!templateSpec||!templateSpec.main){throw new Exception('Unknown template object: '+typeof templateSpec);}
env.VM.checkRevision(templateSpec.compiler);var invokePartialWrapper=function(partial,indent,name,context,hash,helpers,partials,data,depths){if(hash){context=Utils.extend({},context,hash);}
var result=env.VM.invokePartial.call(this,partial,name,context,helpers,partials,data,depths);if(result==null&&env.compile){var options={helpers:helpers,partials:partials,data:data,depths:depths};partials[name]=env.compile(partial,{data:data!==undefined,compat:templateSpec.compat},env);result=partials[name](context,options);}
if(result!=null){if(indent){var lines=result.split('\n');for(var i=0,l=lines.length;i<l;i++){if(!lines[i]&&i+1===l){break;}
lines[i]=indent+lines[i];}
result=lines.join('\n');}
return result;}else{throw new Exception("The partial "+name+" could not be compiled when running in runtime-only mode");}};var container={lookup:function(depths,name){var len=depths.length;for(var i=0;i<len;i++){if(depths[i]&&depths[i][name]!=null){return depths[i][name];}}},lambda:function(current,context){return typeof current==='function'?current.call(context):current;},escapeExpression:Utils.escapeExpression,invokePartial:invokePartialWrapper,fn:function(i){return templateSpec[i];},programs:[],program:function(i,data,depths){var programWrapper=this.programs[i],fn=this.fn(i);if(data||depths){programWrapper=program(this,i,fn,data,depths);}else if(!programWrapper){programWrapper=this.programs[i]=program(this,i,fn);}
return programWrapper;},data:function(data,depth){while(data&&depth--){data=data._parent;}
return data;},merge:function(param,common){var ret=param||common;if(param&&common&&(param!==common)){ret=Utils.extend({},common,param);}
return ret;},noop:env.VM.noop,compilerInfo:templateSpec.compiler};var ret=function(context,options){options=options||{};var data=options.data;ret._setup(options);if(!options.partial&&templateSpec.useData){data=initData(context,data);}
var depths;if(templateSpec.useDepths){depths=options.depths?[context].concat(options.depths):[context];}
return templateSpec.main.call(container,context,container.helpers,container.partials,data,depths);};ret.isTop=true;ret._setup=function(options){if(!options.partial){container.helpers=container.merge(options.helpers,env.helpers);if(templateSpec.usePartial){container.partials=container.merge(options.partials,env.partials);}}else{container.helpers=options.helpers;container.partials=options.partials;}};ret._child=function(i,data,depths){if(templateSpec.useDepths&&!depths){throw new Exception('must pass parent depths');}
return program(container,i,templateSpec[i],data,depths);};return ret;}
__exports__.template=template;function program(container,i,fn,data,depths){var prog=function(context,options){options=options||{};return fn.call(container,context,container.helpers,container.partials,options.data||data,depths&&[context].concat(depths));};prog.program=i;prog.depth=depths?depths.length:0;return prog;}
__exports__.program=program;function invokePartial(partial,name,context,helpers,partials,data,depths){var options={partial:true,helpers:helpers,partials:partials,data:data,depths:depths};if(partial===undefined){throw new Exception("The partial "+name+" could not be found");}else if(partial instanceof Function){return partial(context,options);}}
__exports__.invokePartial=invokePartial;function noop(){return"";}
__exports__.noop=noop;function initData(context,data){if(!data||!('root'in data)){data=data?createFrame(data):{};data.root=context;}
return data;}
return __exports__;})(__module3__,__module5__,__module2__);var __module1__=(function(__dependency1__,__dependency2__,__dependency3__,__dependency4__,__dependency5__){"use strict";var __exports__;var base=__dependency1__;var SafeString=__dependency2__;var Exception=__dependency3__;var Utils=__dependency4__;var runtime=__dependency5__;var create=function(){var hb=new base.HandlebarsEnvironment();Utils.extend(hb,base);hb.SafeString=SafeString;hb.Exception=Exception;hb.Utils=Utils;hb.escapeExpression=Utils.escapeExpression;hb.VM=runtime;hb.template=function(spec){return runtime.template(spec,hb);};return hb;};var Handlebars=create();Handlebars.create=create;Handlebars['default']=Handlebars;__exports__=Handlebars;return __exports__;})(__module2__,__module4__,__module5__,__module3__,__module6__);var __module7__=(function(__dependency1__){"use strict";var __exports__;var Exception=__dependency1__;function LocationInfo(locInfo){locInfo=locInfo||{};this.firstLine=locInfo.first_line;this.firstColumn=locInfo.first_column;this.lastColumn=locInfo.last_column;this.lastLine=locInfo.last_line;}
var AST={ProgramNode:function(statements,strip,locInfo){LocationInfo.call(this,locInfo);this.type="program";this.statements=statements;this.strip=strip;},MustacheNode:function(rawParams,hash,open,strip,locInfo){LocationInfo.call(this,locInfo);this.type="mustache";this.strip=strip;if(open!=null&&open.charAt){var escapeFlag=open.charAt(3)||open.charAt(2);this.escaped=escapeFlag!=='{'&&escapeFlag!=='&';}else{this.escaped=!!open;}
if(rawParams instanceof AST.SexprNode){this.sexpr=rawParams;}else{this.sexpr=new AST.SexprNode(rawParams,hash);}
this.id=this.sexpr.id;this.params=this.sexpr.params;this.hash=this.sexpr.hash;this.eligibleHelper=this.sexpr.eligibleHelper;this.isHelper=this.sexpr.isHelper;},SexprNode:function(rawParams,hash,locInfo){LocationInfo.call(this,locInfo);this.type="sexpr";this.hash=hash;var id=this.id=rawParams[0];var params=this.params=rawParams.slice(1);this.isHelper=!!(params.length||hash);this.eligibleHelper=this.isHelper||id.isSimple;},PartialNode:function(partialName,context,hash,strip,locInfo){LocationInfo.call(this,locInfo);this.type="partial";this.partialName=partialName;this.context=context;this.hash=hash;this.strip=strip;this.strip.inlineStandalone=true;},BlockNode:function(mustache,program,inverse,strip,locInfo){LocationInfo.call(this,locInfo);this.type='block';this.mustache=mustache;this.program=program;this.inverse=inverse;this.strip=strip;if(inverse&&!program){this.isInverse=true;}},RawBlockNode:function(mustache,content,close,locInfo){LocationInfo.call(this,locInfo);if(mustache.sexpr.id.original!==close){throw new Exception(mustache.sexpr.id.original+" doesn't match "+close,this);}
content=new AST.ContentNode(content,locInfo);this.type='block';this.mustache=mustache;this.program=new AST.ProgramNode([content],{},locInfo);},ContentNode:function(string,locInfo){LocationInfo.call(this,locInfo);this.type="content";this.original=this.string=string;},HashNode:function(pairs,locInfo){LocationInfo.call(this,locInfo);this.type="hash";this.pairs=pairs;},IdNode:function(parts,locInfo){LocationInfo.call(this,locInfo);this.type="ID";var original="",dig=[],depth=0,depthString='';for(var i=0,l=parts.length;i<l;i++){var part=parts[i].part;original+=(parts[i].separator||'')+part;if(part===".."||part==="."||part==="this"){if(dig.length>0){throw new Exception("Invalid path: "+original,this);}else if(part===".."){depth++;depthString+='../';}else{this.isScoped=true;}}else{dig.push(part);}}
this.original=original;this.parts=dig;this.string=dig.join('.');this.depth=depth;this.idName=depthString+this.string;this.isSimple=parts.length===1&&!this.isScoped&&depth===0;this.stringModeValue=this.string;},PartialNameNode:function(name,locInfo){LocationInfo.call(this,locInfo);this.type="PARTIAL_NAME";this.name=name.original;},DataNode:function(id,locInfo){LocationInfo.call(this,locInfo);this.type="DATA";this.id=id;this.stringModeValue=id.stringModeValue;this.idName='@'+id.stringModeValue;},StringNode:function(string,locInfo){LocationInfo.call(this,locInfo);this.type="STRING";this.original=this.string=this.stringModeValue=string;},NumberNode:function(number,locInfo){LocationInfo.call(this,locInfo);this.type="NUMBER";this.original=this.number=number;this.stringModeValue=Number(number);},BooleanNode:function(bool,locInfo){LocationInfo.call(this,locInfo);this.type="BOOLEAN";this.bool=bool;this.stringModeValue=bool==="true";},CommentNode:function(comment,locInfo){LocationInfo.call(this,locInfo);this.type="comment";this.comment=comment;this.strip={inlineStandalone:true};}};__exports__=AST;return __exports__;})(__module5__);var __module9__=(function(){"use strict";var __exports__;var handlebars=(function(){var parser={trace:function trace(){},yy:{},symbols_:{"error":2,"root":3,"program":4,"EOF":5,"program_repetition0":6,"statement":7,"mustache":8,"block":9,"rawBlock":10,"partial":11,"CONTENT":12,"COMMENT":13,"openRawBlock":14,"END_RAW_BLOCK":15,"OPEN_RAW_BLOCK":16,"sexpr":17,"CLOSE_RAW_BLOCK":18,"openBlock":19,"block_option0":20,"closeBlock":21,"openInverse":22,"block_option1":23,"OPEN_BLOCK":24,"CLOSE":25,"OPEN_INVERSE":26,"inverseAndProgram":27,"INVERSE":28,"OPEN_ENDBLOCK":29,"path":30,"OPEN":31,"OPEN_UNESCAPED":32,"CLOSE_UNESCAPED":33,"OPEN_PARTIAL":34,"partialName":35,"param":36,"partial_option0":37,"partial_option1":38,"sexpr_repetition0":39,"sexpr_option0":40,"dataName":41,"STRING":42,"NUMBER":43,"BOOLEAN":44,"OPEN_SEXPR":45,"CLOSE_SEXPR":46,"hash":47,"hash_repetition_plus0":48,"hashSegment":49,"ID":50,"EQUALS":51,"DATA":52,"pathSegments":53,"SEP":54,"$accept":0,"$end":1},terminals_:{2:"error",5:"EOF",12:"CONTENT",13:"COMMENT",15:"END_RAW_BLOCK",16:"OPEN_RAW_BLOCK",18:"CLOSE_RAW_BLOCK",24:"OPEN_BLOCK",25:"CLOSE",26:"OPEN_INVERSE",28:"INVERSE",29:"OPEN_ENDBLOCK",31:"OPEN",32:"OPEN_UNESCAPED",33:"CLOSE_UNESCAPED",34:"OPEN_PARTIAL",42:"STRING",43:"NUMBER",44:"BOOLEAN",45:"OPEN_SEXPR",46:"CLOSE_SEXPR",50:"ID",51:"EQUALS",52:"DATA",54:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[10,3],[14,3],[9,4],[9,4],[19,3],[22,3],[27,2],[21,3],[8,3],[8,3],[11,5],[11,4],[17,3],[17,1],[36,1],[36,1],[36,1],[36,1],[36,1],[36,3],[47,1],[49,3],[35,1],[35,1],[35,1],[41,2],[30,1],[53,3],[53,1],[6,0],[6,2],[20,0],[20,1],[23,0],[23,1],[37,0],[37,1],[38,0],[38,1],[39,0],[39,2],[40,0],[40,1],[48,1],[48,2]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:yy.prepareProgram($$[$0-1].statements,true);return $$[$0-1];break;case 2:this.$=new yy.ProgramNode(yy.prepareProgram($$[$0]),{},this._$);break;case 3:this.$=$$[$0];break;case 4:this.$=$$[$0];break;case 5:this.$=$$[$0];break;case 6:this.$=$$[$0];break;case 7:this.$=new yy.ContentNode($$[$0],this._$);break;case 8:this.$=new yy.CommentNode($$[$0],this._$);break;case 9:this.$=new yy.RawBlockNode($$[$0-2],$$[$0-1],$$[$0],this._$);break;case 10:this.$=new yy.MustacheNode($$[$0-1],null,'','',this._$);break;case 11:this.$=yy.prepareBlock($$[$0-3],$$[$0-2],$$[$0-1],$$[$0],false,this._$);break;case 12:this.$=yy.prepareBlock($$[$0-3],$$[$0-2],$$[$0-1],$$[$0],true,this._$);break;case 13:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],yy.stripFlags($$[$0-2],$$[$0]),this._$);break;case 14:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],yy.stripFlags($$[$0-2],$$[$0]),this._$);break;case 15:this.$={strip:yy.stripFlags($$[$0-1],$$[$0-1]),program:$$[$0]};break;case 16:this.$={path:$$[$0-1],strip:yy.stripFlags($$[$0-2],$$[$0])};break;case 17:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],yy.stripFlags($$[$0-2],$$[$0]),this._$);break;case 18:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],yy.stripFlags($$[$0-2],$$[$0]),this._$);break;case 19:this.$=new yy.PartialNode($$[$0-3],$$[$0-2],$$[$0-1],yy.stripFlags($$[$0-4],$$[$0]),this._$);break;case 20:this.$=new yy.PartialNode($$[$0-2],undefined,$$[$0-1],yy.stripFlags($$[$0-3],$$[$0]),this._$);break;case 21:this.$=new yy.SexprNode([$$[$0-2]].concat($$[$0-1]),$$[$0],this._$);break;case 22:this.$=new yy.SexprNode([$$[$0]],null,this._$);break;case 23:this.$=$$[$0];break;case 24:this.$=new yy.StringNode($$[$0],this._$);break;case 25:this.$=new yy.NumberNode($$[$0],this._$);break;case 26:this.$=new yy.BooleanNode($$[$0],this._$);break;case 27:this.$=$$[$0];break;case 28:$$[$0-1].isHelper=true;this.$=$$[$0-1];break;case 29:this.$=new yy.HashNode($$[$0],this._$);break;case 30:this.$=[$$[$0-2],$$[$0]];break;case 31:this.$=new yy.PartialNameNode($$[$0],this._$);break;case 32:this.$=new yy.PartialNameNode(new yy.StringNode($$[$0],this._$),this._$);break;case 33:this.$=new yy.PartialNameNode(new yy.NumberNode($$[$0],this._$));break;case 34:this.$=new yy.DataNode($$[$0],this._$);break;case 35:this.$=new yy.IdNode($$[$0],this._$);break;case 36:$$[$0-2].push({part:$$[$0],separator:$$[$0-1]});this.$=$$[$0-2];break;case 37:this.$=[{part:$$[$0]}];break;case 38:this.$=[];break;case 39:$$[$0-1].push($$[$0]);break;case 48:this.$=[];break;case 49:$$[$0-1].push($$[$0]);break;case 52:this.$=[$$[$0]];break;case 53:$$[$0-1].push($$[$0]);break;}},table:[{3:1,4:2,5:[2,38],6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],31:[2,38],32:[2,38],34:[2,38]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:[1,10],13:[1,11],14:16,16:[1,20],19:14,22:15,24:[1,18],26:[1,19],28:[2,2],29:[2,2],31:[1,12],32:[1,13],34:[1,17]},{1:[2,1]},{5:[2,39],12:[2,39],13:[2,39],16:[2,39],24:[2,39],26:[2,39],28:[2,39],29:[2,39],31:[2,39],32:[2,39],34:[2,39]},{5:[2,3],12:[2,3],13:[2,3],16:[2,3],24:[2,3],26:[2,3],28:[2,3],29:[2,3],31:[2,3],32:[2,3],34:[2,3]},{5:[2,4],12:[2,4],13:[2,4],16:[2,4],24:[2,4],26:[2,4],28:[2,4],29:[2,4],31:[2,4],32:[2,4],34:[2,4]},{5:[2,5],12:[2,5],13:[2,5],16:[2,5],24:[2,5],26:[2,5],28:[2,5],29:[2,5],31:[2,5],32:[2,5],34:[2,5]},{5:[2,6],12:[2,6],13:[2,6],16:[2,6],24:[2,6],26:[2,6],28:[2,6],29:[2,6],31:[2,6],32:[2,6],34:[2,6]},{5:[2,7],12:[2,7],13:[2,7],16:[2,7],24:[2,7],26:[2,7],28:[2,7],29:[2,7],31:[2,7],32:[2,7],34:[2,7]},{5:[2,8],12:[2,8],13:[2,8],16:[2,8],24:[2,8],26:[2,8],28:[2,8],29:[2,8],31:[2,8],32:[2,8],34:[2,8]},{17:21,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:27,30:22,41:23,50:[1,26],52:[1,25],53:24},{4:28,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],28:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{4:29,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],28:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{12:[1,30]},{30:32,35:31,42:[1,33],43:[1,34],50:[1,26],53:24},{17:35,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:36,30:22,41:23,50:[1,26],52:[1,25],53:24},{17:37,30:22,41:23,50:[1,26],52:[1,25],53:24},{25:[1,38]},{18:[2,48],25:[2,48],33:[2,48],39:39,42:[2,48],43:[2,48],44:[2,48],45:[2,48],46:[2,48],50:[2,48],52:[2,48]},{18:[2,22],25:[2,22],33:[2,22],46:[2,22]},{18:[2,35],25:[2,35],33:[2,35],42:[2,35],43:[2,35],44:[2,35],45:[2,35],46:[2,35],50:[2,35],52:[2,35],54:[1,40]},{30:41,50:[1,26],53:24},{18:[2,37],25:[2,37],33:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],50:[2,37],52:[2,37],54:[2,37]},{33:[1,42]},{20:43,27:44,28:[1,45],29:[2,40]},{23:46,27:47,28:[1,45],29:[2,42]},{15:[1,48]},{25:[2,46],30:51,36:49,38:50,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],47:57,48:58,49:60,50:[1,59],52:[1,25],53:24},{25:[2,31],42:[2,31],43:[2,31],44:[2,31],45:[2,31],50:[2,31],52:[2,31]},{25:[2,32],42:[2,32],43:[2,32],44:[2,32],45:[2,32],50:[2,32],52:[2,32]},{25:[2,33],42:[2,33],43:[2,33],44:[2,33],45:[2,33],50:[2,33],52:[2,33]},{25:[1,61]},{25:[1,62]},{18:[1,63]},{5:[2,17],12:[2,17],13:[2,17],16:[2,17],24:[2,17],26:[2,17],28:[2,17],29:[2,17],31:[2,17],32:[2,17],34:[2,17]},{18:[2,50],25:[2,50],30:51,33:[2,50],36:65,40:64,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],46:[2,50],47:66,48:58,49:60,50:[1,59],52:[1,25],53:24},{50:[1,67]},{18:[2,34],25:[2,34],33:[2,34],42:[2,34],43:[2,34],44:[2,34],45:[2,34],46:[2,34],50:[2,34],52:[2,34]},{5:[2,18],12:[2,18],13:[2,18],16:[2,18],24:[2,18],26:[2,18],28:[2,18],29:[2,18],31:[2,18],32:[2,18],34:[2,18]},{21:68,29:[1,69]},{29:[2,41]},{4:70,6:3,12:[2,38],13:[2,38],16:[2,38],24:[2,38],26:[2,38],29:[2,38],31:[2,38],32:[2,38],34:[2,38]},{21:71,29:[1,69]},{29:[2,43]},{5:[2,9],12:[2,9],13:[2,9],16:[2,9],24:[2,9],26:[2,9],28:[2,9],29:[2,9],31:[2,9],32:[2,9],34:[2,9]},{25:[2,44],37:72,47:73,48:58,49:60,50:[1,74]},{25:[1,75]},{18:[2,23],25:[2,23],33:[2,23],42:[2,23],43:[2,23],44:[2,23],45:[2,23],46:[2,23],50:[2,23],52:[2,23]},{18:[2,24],25:[2,24],33:[2,24],42:[2,24],43:[2,24],44:[2,24],45:[2,24],46:[2,24],50:[2,24],52:[2,24]},{18:[2,25],25:[2,25],33:[2,25],42:[2,25],43:[2,25],44:[2,25],45:[2,25],46:[2,25],50:[2,25],52:[2,25]},{18:[2,26],25:[2,26],33:[2,26],42:[2,26],43:[2,26],44:[2,26],45:[2,26],46:[2,26],50:[2,26],52:[2,26]},{18:[2,27],25:[2,27],33:[2,27],42:[2,27],43:[2,27],44:[2,27],45:[2,27],46:[2,27],50:[2,27],52:[2,27]},{17:76,30:22,41:23,50:[1,26],52:[1,25],53:24},{25:[2,47]},{18:[2,29],25:[2,29],33:[2,29],46:[2,29],49:77,50:[1,74]},{18:[2,37],25:[2,37],33:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],50:[2,37],51:[1,78],52:[2,37],54:[2,37]},{18:[2,52],25:[2,52],33:[2,52],46:[2,52],50:[2,52]},{12:[2,13],13:[2,13],16:[2,13],24:[2,13],26:[2,13],28:[2,13],29:[2,13],31:[2,13],32:[2,13],34:[2,13]},{12:[2,14],13:[2,14],16:[2,14],24:[2,14],26:[2,14],28:[2,14],29:[2,14],31:[2,14],32:[2,14],34:[2,14]},{12:[2,10]},{18:[2,21],25:[2,21],33:[2,21],46:[2,21]},{18:[2,49],25:[2,49],33:[2,49],42:[2,49],43:[2,49],44:[2,49],45:[2,49],46:[2,49],50:[2,49],52:[2,49]},{18:[2,51],25:[2,51],33:[2,51],46:[2,51]},{18:[2,36],25:[2,36],33:[2,36],42:[2,36],43:[2,36],44:[2,36],45:[2,36],46:[2,36],50:[2,36],52:[2,36],54:[2,36]},{5:[2,11],12:[2,11],13:[2,11],16:[2,11],24:[2,11],26:[2,11],28:[2,11],29:[2,11],31:[2,11],32:[2,11],34:[2,11]},{30:79,50:[1,26],53:24},{29:[2,15]},{5:[2,12],12:[2,12],13:[2,12],16:[2,12],24:[2,12],26:[2,12],28:[2,12],29:[2,12],31:[2,12],32:[2,12],34:[2,12]},{25:[1,80]},{25:[2,45]},{51:[1,78]},{5:[2,20],12:[2,20],13:[2,20],16:[2,20],24:[2,20],26:[2,20],28:[2,20],29:[2,20],31:[2,20],32:[2,20],34:[2,20]},{46:[1,81]},{18:[2,53],25:[2,53],33:[2,53],46:[2,53],50:[2,53]},{30:51,36:82,41:55,42:[1,52],43:[1,53],44:[1,54],45:[1,56],50:[1,26],52:[1,25],53:24},{25:[1,83]},{5:[2,19],12:[2,19],13:[2,19],16:[2,19],24:[2,19],26:[2,19],28:[2,19],29:[2,19],31:[2,19],32:[2,19],34:[2,19]},{18:[2,28],25:[2,28],33:[2,28],42:[2,28],43:[2,28],44:[2,28],45:[2,28],46:[2,28],50:[2,28],52:[2,28]},{18:[2,30],25:[2,30],33:[2,30],46:[2,30],50:[2,30]},{5:[2,16],12:[2,16],13:[2,16],16:[2,16],24:[2,16],26:[2,16],28:[2,16],29:[2,16],31:[2,16],32:[2,16],34:[2,16]}],defaultActions:{4:[2,1],44:[2,41],47:[2,43],57:[2,47],63:[2,10],70:[2,15],73:[2,45]},parseError:function parseError(str,hash){throw new Error(str);},parse:function parse(input){var self=this,stack=[0],vstack=[null],lstack=[],table=this.table,yytext="",yylineno=0,yyleng=0,recovering=0,TERROR=2,EOF=1;this.lexer.setInput(input);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;if(typeof this.lexer.yylloc=="undefined")
this.lexer.yylloc={};var yyloc=this.lexer.yylloc;lstack.push(yyloc);var ranges=this.lexer.options&&this.lexer.options.ranges;if(typeof this.yy.parseError==="function")
this.parseError=this.yy.parseError;function popStack(n){stack.length=stack.length-2*n;vstack.length=vstack.length-n;lstack.length=lstack.length-n;}
function lex(){var token;token=self.lexer.lex()||1;if(typeof token!=="number"){token=self.symbols_[token]||token;}
return token;}
var symbol,preErrorSymbol,state,action,a,r,yyval={},p,len,newState,expected;while(true){state=stack[stack.length-1];if(this.defaultActions[state]){action=this.defaultActions[state];}else{if(symbol===null||typeof symbol=="undefined"){symbol=lex();}
action=table[state]&&table[state][symbol];}
if(typeof action==="undefined"||!action.length||!action[0]){var errStr="";if(!recovering){expected=[];for(p in table[state])
if(this.terminals_[p]&&p>2){expected.push("'"+this.terminals_[p]+"'");}
if(this.lexer.showPosition){errStr="Parse error on line "+(yylineno+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+expected.join(", ")+", got '"+(this.terminals_[symbol]||symbol)+"'";}else{errStr="Parse error on line "+(yylineno+1)+": Unexpected "+(symbol==1?"end of input":"'"+(this.terminals_[symbol]||symbol)+"'");}
this.parseError(errStr,{text:this.lexer.match,token:this.terminals_[symbol]||symbol,line:this.lexer.yylineno,loc:yyloc,expected:expected});}}
if(action[0]instanceof Array&&action.length>1){throw new Error("Parse Error: multiple actions possible at state: "+state+", token: "+symbol);}
switch(action[0]){case 1:stack.push(symbol);vstack.push(this.lexer.yytext);lstack.push(this.lexer.yylloc);stack.push(action[1]);symbol=null;if(!preErrorSymbol){yyleng=this.lexer.yyleng;yytext=this.lexer.yytext;yylineno=this.lexer.yylineno;yyloc=this.lexer.yylloc;if(recovering>0)
recovering--;}else{symbol=preErrorSymbol;preErrorSymbol=null;}
break;case 2:len=this.productions_[action[1]][1];yyval.$=vstack[vstack.length-len];yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column};if(ranges){yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]];}
r=this.performAction.call(yyval,yytext,yyleng,yylineno,this.yy,action[1],vstack,lstack);if(typeof r!=="undefined"){return r;}
if(len){stack=stack.slice(0,-1*len*2);vstack=vstack.slice(0,-1*len);lstack=lstack.slice(0,-1*len);}
stack.push(this.productions_[action[1]][0]);vstack.push(yyval.$);lstack.push(yyval._$);newState=table[stack[stack.length-2]][stack[stack.length-1]];stack.push(newState);break;case 3:return true;}}
return true;}};var lexer=(function(){var lexer=({EOF:1,parseError:function parseError(str,hash){if(this.yy.parser){this.yy.parser.parseError(str,hash);}else{throw new Error(str);}},setInput:function(input){this._input=input;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match='';this.conditionStack=['INITIAL'];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges)this.yylloc.range=[0,0];this.offset=0;return this;},input:function(){var ch=this._input[0];this.yytext+=ch;this.yyleng++;this.offset++;this.match+=ch;this.matched+=ch;var lines=ch.match(/(?:\r\n?|\n).*/g);if(lines){this.yylineno++;this.yylloc.last_line++;}else{this.yylloc.last_column++;}
if(this.options.ranges)this.yylloc.range[1]++;this._input=this._input.slice(1);return ch;},unput:function(ch){var len=ch.length;var lines=ch.split(/(?:\r\n?|\n)/g);this._input=ch+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-len-1);this.offset-=len;var oldLines=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(lines.length-1)this.yylineno-=lines.length-1;var r=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:lines?(lines.length===oldLines.length?this.yylloc.first_column:0)+oldLines[oldLines.length-lines.length].length-lines[0].length:this.yylloc.first_column-len};if(this.options.ranges){this.yylloc.range=[r[0],r[0]+this.yyleng-len];}
return this;},more:function(){this._more=true;return this;},less:function(n){this.unput(this.match.slice(n));},pastInput:function(){var past=this.matched.substr(0,this.matched.length-this.match.length);return(past.length>20?'...':'')+past.substr(-20).replace(/\n/g,"");},upcomingInput:function(){var next=this.match;if(next.length<20){next+=this._input.substr(0,20-next.length);}
return(next.substr(0,20)+(next.length>20?'...':'')).replace(/\n/g,"");},showPosition:function(){var pre=this.pastInput();var c=new Array(pre.length+1).join("-");return pre+this.upcomingInput()+"\n"+c+"^";},next:function(){if(this.done){return this.EOF;}
if(!this._input)this.done=true;var token,match,tempMatch,index,col,lines;if(!this._more){this.yytext='';this.match='';}
var rules=this._currentRules();for(var i=0;i<rules.length;i++){tempMatch=this._input.match(this.rules[rules[i]]);if(tempMatch&&(!match||tempMatch[0].length>match[0].length)){match=tempMatch;index=i;if(!this.options.flex)break;}}
if(match){lines=match[0].match(/(?:\r\n?|\n).*/g);if(lines)this.yylineno+=lines.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:lines?lines[lines.length-1].length-lines[lines.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+match[0].length};this.yytext+=match[0];this.match+=match[0];this.matches=match;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng];}
this._more=false;this._input=this._input.slice(match[0].length);this.matched+=match[0];token=this.performAction.call(this,this.yy,this,rules[index],this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input)this.done=false;if(token)return token;else return;}
if(this._input===""){return this.EOF;}else{return this.parseError('Lexical error on line '+(this.yylineno+1)+'. Unrecognized text.\n'+this.showPosition(),{text:"",token:null,line:this.yylineno});}},lex:function lex(){var r=this.next();if(typeof r!=='undefined'){return r;}else{return this.lex();}},begin:function begin(condition){this.conditionStack.push(condition);},popState:function popState(){return this.conditionStack.pop();},_currentRules:function _currentRules(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules;},topState:function(){return this.conditionStack[this.conditionStack.length-2];},pushState:function begin(condition){this.begin(condition);}});lexer.options={};lexer.performAction=function anonymous(yy,yy_,$avoiding_name_collisions,YY_START){function strip(start,end){return yy_.yytext=yy_.yytext.substr(start,yy_.yyleng-end);}
var YYSTATE=YY_START
switch($avoiding_name_collisions){case 0:if(yy_.yytext.slice(-2)==="\\\\"){strip(0,1);this.begin("mu");}else if(yy_.yytext.slice(-1)==="\\"){strip(0,1);this.begin("emu");}else{this.begin("mu");}
if(yy_.yytext)return 12;break;case 1:return 12;break;case 2:this.popState();return 12;break;case 3:yy_.yytext=yy_.yytext.substr(5,yy_.yyleng-9);this.popState();return 15;break;case 4:return 12;break;case 5:strip(0,4);this.popState();return 13;break;case 6:return 45;break;case 7:return 46;break;case 8:return 16;break;case 9:this.popState();this.begin('raw');return 18;break;case 10:return 34;break;case 11:return 24;break;case 12:return 29;break;case 13:this.popState();return 28;break;case 14:this.popState();return 28;break;case 15:return 26;break;case 16:return 26;break;case 17:return 32;break;case 18:return 31;break;case 19:this.popState();this.begin('com');break;case 20:strip(3,5);this.popState();return 13;break;case 21:return 31;break;case 22:return 51;break;case 23:return 50;break;case 24:return 50;break;case 25:return 54;break;case 26:break;case 27:this.popState();return 33;break;case 28:this.popState();return 25;break;case 29:yy_.yytext=strip(1,2).replace(/\\"/g,'"');return 42;break;case 30:yy_.yytext=strip(1,2).replace(/\\'/g,"'");return 42;break;case 31:return 52;break;case 32:return 44;break;case 33:return 44;break;case 34:return 43;break;case 35:return 50;break;case 36:yy_.yytext=strip(1,2);return 50;break;case 37:return'INVALID';break;case 38:return 5;break;}};lexer.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/];lexer.conditions={"mu":{"rules":[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],"inclusive":false},"emu":{"rules":[2],"inclusive":false},"com":{"rules":[5],"inclusive":false},"raw":{"rules":[3,4],"inclusive":false},"INITIAL":{"rules":[0,1,38],"inclusive":true}};return lexer;})()
parser.lexer=lexer;function Parser(){this.yy={};}Parser.prototype=parser;parser.Parser=Parser;return new Parser;})();__exports__=handlebars;return __exports__;})();var __module10__=(function(__dependency1__){"use strict";var __exports__={};var Exception=__dependency1__;function stripFlags(open,close){return{left:open.charAt(2)==='~',right:close.charAt(close.length-3)==='~'};}
__exports__.stripFlags=stripFlags;function prepareBlock(mustache,program,inverseAndProgram,close,inverted,locInfo){if(mustache.sexpr.id.original!==close.path.original){throw new Exception(mustache.sexpr.id.original+' doesn\'t match '+close.path.original,mustache);}
var inverse=inverseAndProgram&&inverseAndProgram.program;var strip={left:mustache.strip.left,right:close.strip.right,openStandalone:isNextWhitespace(program.statements),closeStandalone:isPrevWhitespace((inverse||program).statements)};if(mustache.strip.right){omitRight(program.statements,null,true);}
if(inverse){var inverseStrip=inverseAndProgram.strip;if(inverseStrip.left){omitLeft(program.statements,null,true);}
if(inverseStrip.right){omitRight(inverse.statements,null,true);}
if(close.strip.left){omitLeft(inverse.statements,null,true);}
if(isPrevWhitespace(program.statements)&&isNextWhitespace(inverse.statements)){omitLeft(program.statements);omitRight(inverse.statements);}}else{if(close.strip.left){omitLeft(program.statements,null,true);}}
if(inverted){return new this.BlockNode(mustache,inverse,program,strip,locInfo);}else{return new this.BlockNode(mustache,program,inverse,strip,locInfo);}}
__exports__.prepareBlock=prepareBlock;function prepareProgram(statements,isRoot){for(var i=0,l=statements.length;i<l;i++){var current=statements[i],strip=current.strip;if(!strip){continue;}
var _isPrevWhitespace=isPrevWhitespace(statements,i,isRoot,current.type==='partial'),_isNextWhitespace=isNextWhitespace(statements,i,isRoot),openStandalone=strip.openStandalone&&_isPrevWhitespace,closeStandalone=strip.closeStandalone&&_isNextWhitespace,inlineStandalone=strip.inlineStandalone&&_isPrevWhitespace&&_isNextWhitespace;if(strip.right){omitRight(statements,i,true);}
if(strip.left){omitLeft(statements,i,true);}
if(inlineStandalone){omitRight(statements,i);if(omitLeft(statements,i)){if(current.type==='partial'){current.indent=(/([ \t]+$)/).exec(statements[i-1].original)?RegExp.$1:'';}}}
if(openStandalone){omitRight((current.program||current.inverse).statements);omitLeft(statements,i);}
if(closeStandalone){omitRight(statements,i);omitLeft((current.inverse||current.program).statements);}}
return statements;}
__exports__.prepareProgram=prepareProgram;function isPrevWhitespace(statements,i,isRoot){if(i===undefined){i=statements.length;}
var prev=statements[i-1],sibling=statements[i-2];if(!prev){return isRoot;}
if(prev.type==='content'){return(sibling||!isRoot?(/\r?\n\s*?$/):(/(^|\r?\n)\s*?$/)).test(prev.original);}}
function isNextWhitespace(statements,i,isRoot){if(i===undefined){i=-1;}
var next=statements[i+1],sibling=statements[i+2];if(!next){return isRoot;}
if(next.type==='content'){return(sibling||!isRoot?(/^\s*?\r?\n/):(/^\s*?(\r?\n|$)/)).test(next.original);}}
function omitRight(statements,i,multiple){var current=statements[i==null?0:i+1];if(!current||current.type!=='content'||(!multiple&&current.rightStripped)){return;}
var original=current.string;current.string=current.string.replace(multiple?(/^\s+/):(/^[ \t]*\r?\n?/),'');current.rightStripped=current.string!==original;}
function omitLeft(statements,i,multiple){var current=statements[i==null?statements.length-1:i-1];if(!current||current.type!=='content'||(!multiple&&current.leftStripped)){return;}
var original=current.string;current.string=current.string.replace(multiple?(/\s+$/):(/[ \t]+$/),'');current.leftStripped=current.string!==original;return current.leftStripped;}
return __exports__;})(__module5__);var __module8__=(function(__dependency1__,__dependency2__,__dependency3__,__dependency4__){"use strict";var __exports__={};var parser=__dependency1__;var AST=__dependency2__;var Helpers=__dependency3__;var extend=__dependency4__.extend;__exports__.parser=parser;var yy={};extend(yy,Helpers,AST);function parse(input){if(input.constructor===AST.ProgramNode){return input;}
parser.yy=yy;return parser.parse(input);}
__exports__.parse=parse;return __exports__;})(__module9__,__module7__,__module10__,__module3__);var __module11__=(function(__dependency1__,__dependency2__){"use strict";var __exports__={};var Exception=__dependency1__;var isArray=__dependency2__.isArray;var slice=[].slice;function Compiler(){}
__exports__.Compiler=Compiler;Compiler.prototype={compiler:Compiler,equals:function(other){var len=this.opcodes.length;if(other.opcodes.length!==len){return false;}
for(var i=0;i<len;i++){var opcode=this.opcodes[i],otherOpcode=other.opcodes[i];if(opcode.opcode!==otherOpcode.opcode||!argEquals(opcode.args,otherOpcode.args)){return false;}}
len=this.children.length;for(i=0;i<len;i++){if(!this.children[i].equals(other.children[i])){return false;}}
return true;},guid:0,compile:function(program,options){this.opcodes=[];this.children=[];this.depths={list:[]};this.options=options;this.stringParams=options.stringParams;this.trackIds=options.trackIds;var knownHelpers=this.options.knownHelpers;this.options.knownHelpers={'helperMissing':true,'blockHelperMissing':true,'each':true,'if':true,'unless':true,'with':true,'log':true,'lookup':true};if(knownHelpers){for(var name in knownHelpers){this.options.knownHelpers[name]=knownHelpers[name];}}
return this.accept(program);},accept:function(node){return this[node.type](node);},program:function(program){var statements=program.statements;for(var i=0,l=statements.length;i<l;i++){this.accept(statements[i]);}
this.isSimple=l===1;this.depths.list=this.depths.list.sort(function(a,b){return a-b;});return this;},compileProgram:function(program){var result=new this.compiler().compile(program,this.options);var guid=this.guid++,depth;this.usePartial=this.usePartial||result.usePartial;this.children[guid]=result;for(var i=0,l=result.depths.list.length;i<l;i++){depth=result.depths.list[i];if(depth<2){continue;}
else{this.addDepth(depth-1);}}
return guid;},block:function(block){var mustache=block.mustache,program=block.program,inverse=block.inverse;if(program){program=this.compileProgram(program);}
if(inverse){inverse=this.compileProgram(inverse);}
var sexpr=mustache.sexpr;var type=this.classifySexpr(sexpr);if(type==="helper"){this.helperSexpr(sexpr,program,inverse);}else if(type==="simple"){this.simpleSexpr(sexpr);this.opcode('pushProgram',program);this.opcode('pushProgram',inverse);this.opcode('emptyHash');this.opcode('blockValue',sexpr.id.original);}else{this.ambiguousSexpr(sexpr,program,inverse);this.opcode('pushProgram',program);this.opcode('pushProgram',inverse);this.opcode('emptyHash');this.opcode('ambiguousBlockValue');}
this.opcode('append');},hash:function(hash){var pairs=hash.pairs,i,l;this.opcode('pushHash');for(i=0,l=pairs.length;i<l;i++){this.pushParam(pairs[i][1]);}
while(i--){this.opcode('assignToHash',pairs[i][0]);}
this.opcode('popHash');},partial:function(partial){var partialName=partial.partialName;this.usePartial=true;if(partial.hash){this.accept(partial.hash);}else{this.opcode('push','undefined');}
if(partial.context){this.accept(partial.context);}else{this.opcode('getContext',0);this.opcode('pushContext');}
this.opcode('invokePartial',partialName.name,partial.indent||'');this.opcode('append');},content:function(content){if(content.string){this.opcode('appendContent',content.string);}},mustache:function(mustache){this.sexpr(mustache.sexpr);if(mustache.escaped&&!this.options.noEscape){this.opcode('appendEscaped');}else{this.opcode('append');}},ambiguousSexpr:function(sexpr,program,inverse){var id=sexpr.id,name=id.parts[0],isBlock=program!=null||inverse!=null;this.opcode('getContext',id.depth);this.opcode('pushProgram',program);this.opcode('pushProgram',inverse);this.ID(id);this.opcode('invokeAmbiguous',name,isBlock);},simpleSexpr:function(sexpr){var id=sexpr.id;if(id.type==='DATA'){this.DATA(id);}else if(id.parts.length){this.ID(id);}else{this.addDepth(id.depth);this.opcode('getContext',id.depth);this.opcode('pushContext');}
this.opcode('resolvePossibleLambda');},helperSexpr:function(sexpr,program,inverse){var params=this.setupFullMustacheParams(sexpr,program,inverse),id=sexpr.id,name=id.parts[0];if(this.options.knownHelpers[name]){this.opcode('invokeKnownHelper',params.length,name);}else if(this.options.knownHelpersOnly){throw new Exception("You specified knownHelpersOnly, but used the unknown helper "+name,sexpr);}else{id.falsy=true;this.ID(id);this.opcode('invokeHelper',params.length,id.original,id.isSimple);}},sexpr:function(sexpr){var type=this.classifySexpr(sexpr);if(type==="simple"){this.simpleSexpr(sexpr);}else if(type==="helper"){this.helperSexpr(sexpr);}else{this.ambiguousSexpr(sexpr);}},ID:function(id){this.addDepth(id.depth);this.opcode('getContext',id.depth);var name=id.parts[0];if(!name){this.opcode('pushContext');}else{this.opcode('lookupOnContext',id.parts,id.falsy,id.isScoped);}},DATA:function(data){this.options.data=true;this.opcode('lookupData',data.id.depth,data.id.parts);},STRING:function(string){this.opcode('pushString',string.string);},NUMBER:function(number){this.opcode('pushLiteral',number.number);},BOOLEAN:function(bool){this.opcode('pushLiteral',bool.bool);},comment:function(){},opcode:function(name){this.opcodes.push({opcode:name,args:slice.call(arguments,1)});},addDepth:function(depth){if(depth===0){return;}
if(!this.depths[depth]){this.depths[depth]=true;this.depths.list.push(depth);}},classifySexpr:function(sexpr){var isHelper=sexpr.isHelper;var isEligible=sexpr.eligibleHelper;var options=this.options;if(isEligible&&!isHelper){var name=sexpr.id.parts[0];if(options.knownHelpers[name]){isHelper=true;}else if(options.knownHelpersOnly){isEligible=false;}}
if(isHelper){return"helper";}
else if(isEligible){return"ambiguous";}
else{return"simple";}},pushParams:function(params){for(var i=0,l=params.length;i<l;i++){this.pushParam(params[i]);}},pushParam:function(val){if(this.stringParams){if(val.depth){this.addDepth(val.depth);}
this.opcode('getContext',val.depth||0);this.opcode('pushStringParam',val.stringModeValue,val.type);if(val.type==='sexpr'){this.sexpr(val);}}else{if(this.trackIds){this.opcode('pushId',val.type,val.idName||val.stringModeValue);}
this.accept(val);}},setupFullMustacheParams:function(sexpr,program,inverse){var params=sexpr.params;this.pushParams(params);this.opcode('pushProgram',program);this.opcode('pushProgram',inverse);if(sexpr.hash){this.hash(sexpr.hash);}else{this.opcode('emptyHash');}
return params;}};function precompile(input,options,env){if(input==null||(typeof input!=='string'&&input.constructor!==env.AST.ProgramNode)){throw new Exception("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+input);}
options=options||{};if(!('data'in options)){options.data=true;}
if(options.compat){options.useDepths=true;}
var ast=env.parse(input);var environment=new env.Compiler().compile(ast,options);return new env.JavaScriptCompiler().compile(environment,options);}
__exports__.precompile=precompile;function compile(input,options,env){if(input==null||(typeof input!=='string'&&input.constructor!==env.AST.ProgramNode)){throw new Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+input);}
options=options||{};if(!('data'in options)){options.data=true;}
if(options.compat){options.useDepths=true;}
var compiled;function compileInput(){var ast=env.parse(input);var environment=new env.Compiler().compile(ast,options);var templateSpec=new env.JavaScriptCompiler().compile(environment,options,undefined,true);return env.template(templateSpec);}
var ret=function(context,options){if(!compiled){compiled=compileInput();}
return compiled.call(this,context,options);};ret._setup=function(options){if(!compiled){compiled=compileInput();}
return compiled._setup(options);};ret._child=function(i,data,depths){if(!compiled){compiled=compileInput();}
return compiled._child(i,data,depths);};return ret;}
__exports__.compile=compile;function argEquals(a,b){if(a===b){return true;}
if(isArray(a)&&isArray(b)&&a.length===b.length){for(var i=0;i<a.length;i++){if(!argEquals(a[i],b[i])){return false;}}
return true;}}
return __exports__;})(__module5__,__module3__);var __module12__=(function(__dependency1__,__dependency2__){"use strict";var __exports__;var COMPILER_REVISION=__dependency1__.COMPILER_REVISION;var REVISION_CHANGES=__dependency1__.REVISION_CHANGES;var Exception=__dependency2__;function Literal(value){this.value=value;}
function JavaScriptCompiler(){}
JavaScriptCompiler.prototype={nameLookup:function(parent,name){if(JavaScriptCompiler.isValidJavaScriptVariableName(name)){return parent+"."+name;}else{return parent+"['"+name+"']";}},depthedLookup:function(name){this.aliases.lookup='this.lookup';return'lookup(depths, "'+name+'")';},compilerInfo:function(){var revision=COMPILER_REVISION,versions=REVISION_CHANGES[revision];return[revision,versions];},appendToBuffer:function(string){if(this.environment.isSimple){return"return "+string+";";}else{return{appendToBuffer:true,content:string,toString:function(){return"buffer += "+string+";";}};}},initializeBuffer:function(){return this.quotedString("");},namespace:"Handlebars",compile:function(environment,options,context,asObject){this.environment=environment;this.options=options;this.stringParams=this.options.stringParams;this.trackIds=this.options.trackIds;this.precompile=!asObject;this.name=this.environment.name;this.isChild=!!context;this.context=context||{programs:[],environments:[]};this.preamble();this.stackSlot=0;this.stackVars=[];this.aliases={};this.registers={list:[]};this.hashes=[];this.compileStack=[];this.inlineStack=[];this.compileChildren(environment,options);this.useDepths=this.useDepths||environment.depths.list.length||this.options.compat;var opcodes=environment.opcodes,opcode,i,l;for(i=0,l=opcodes.length;i<l;i++){opcode=opcodes[i];this[opcode.opcode].apply(this,opcode.args);}
this.pushSource('');if(this.stackSlot||this.inlineStack.length||this.compileStack.length){throw new Exception('Compile completed with content left on stack');}
var fn=this.createFunctionContext(asObject);if(!this.isChild){var ret={compiler:this.compilerInfo(),main:fn};var programs=this.context.programs;for(i=0,l=programs.length;i<l;i++){if(programs[i]){ret[i]=programs[i];}}
if(this.environment.usePartial){ret.usePartial=true;}
if(this.options.data){ret.useData=true;}
if(this.useDepths){ret.useDepths=true;}
if(this.options.compat){ret.compat=true;}
if(!asObject){ret.compiler=JSON.stringify(ret.compiler);ret=this.objectLiteral(ret);}
return ret;}else{return fn;}},preamble:function(){this.lastContext=0;this.source=[];},createFunctionContext:function(asObject){var varDeclarations='';var locals=this.stackVars.concat(this.registers.list);if(locals.length>0){varDeclarations+=", "+locals.join(", ");}
for(var alias in this.aliases){if(this.aliases.hasOwnProperty(alias)){varDeclarations+=', '+alias+'='+this.aliases[alias];}}
var params=["depth0","helpers","partials","data"];if(this.useDepths){params.push('depths');}
var source=this.mergeSource(varDeclarations);if(asObject){params.push(source);return Function.apply(this,params);}else{return'function('+params.join(',')+') {\n  '+source+'}';}},mergeSource:function(varDeclarations){var source='',buffer,appendOnly=!this.forceBuffer,appendFirst;for(var i=0,len=this.source.length;i<len;i++){var line=this.source[i];if(line.appendToBuffer){if(buffer){buffer=buffer+'\n    + '+line.content;}else{buffer=line.content;}}else{if(buffer){if(!source){appendFirst=true;source=buffer+';\n  ';}else{source+='buffer += '+buffer+';\n  ';}
buffer=undefined;}
source+=line+'\n  ';if(!this.environment.isSimple){appendOnly=false;}}}
if(appendOnly){if(buffer||!source){source+='return '+(buffer||'""')+';\n';}}else{varDeclarations+=", buffer = "+(appendFirst?'':this.initializeBuffer());if(buffer){source+='return buffer + '+buffer+';\n';}else{source+='return buffer;\n';}}
if(varDeclarations){source='var '+varDeclarations.substring(2)+(appendFirst?'':';\n  ')+source;}
return source;},blockValue:function(name){this.aliases.blockHelperMissing='helpers.blockHelperMissing';var params=[this.contextName(0)];this.setupParams(name,0,params);var blockName=this.popStack();params.splice(1,0,blockName);this.push('blockHelperMissing.call('+params.join(', ')+')');},ambiguousBlockValue:function(){this.aliases.blockHelperMissing='helpers.blockHelperMissing';var params=[this.contextName(0)];this.setupParams('',0,params,true);this.flushInline();var current=this.topStack();params.splice(1,0,current);this.pushSource("if (!"+this.lastHelper+") { "+current+" = blockHelperMissing.call("+params.join(", ")+"); }");},appendContent:function(content){if(this.pendingContent){content=this.pendingContent+content;}
this.pendingContent=content;},append:function(){this.flushInline();var local=this.popStack();this.pushSource('if ('+local+' != null) { '+this.appendToBuffer(local)+' }');if(this.environment.isSimple){this.pushSource("else { "+this.appendToBuffer("''")+" }");}},appendEscaped:function(){this.aliases.escapeExpression='this.escapeExpression';this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"));},getContext:function(depth){this.lastContext=depth;},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext));},lookupOnContext:function(parts,falsy,scoped){var i=0,len=parts.length;if(!scoped&&this.options.compat&&!this.lastContext){this.push(this.depthedLookup(parts[i++]));}else{this.pushContext();}
for(;i<len;i++){this.replaceStack(function(current){var lookup=this.nameLookup(current,parts[i],'context');if(!falsy){return' != null ? '+lookup+' : '+current;}else{return' && '+lookup;}});}},lookupData:function(depth,parts){if(!depth){this.pushStackLiteral('data');}else{this.pushStackLiteral('this.data(data, '+depth+')');}
var len=parts.length;for(var i=0;i<len;i++){this.replaceStack(function(current){return' && '+this.nameLookup(current,parts[i],'data');});}},resolvePossibleLambda:function(){this.aliases.lambda='this.lambda';this.push('lambda('+this.popStack()+', '+this.contextName(0)+')');},pushStringParam:function(string,type){this.pushContext();this.pushString(type);if(type!=='sexpr'){if(typeof string==='string'){this.pushString(string);}else{this.pushStackLiteral(string);}}},emptyHash:function(){this.pushStackLiteral('{}');if(this.trackIds){this.push('{}');}
if(this.stringParams){this.push('{}');this.push('{}');}},pushHash:function(){if(this.hash){this.hashes.push(this.hash);}
this.hash={values:[],types:[],contexts:[],ids:[]};},popHash:function(){var hash=this.hash;this.hash=this.hashes.pop();if(this.trackIds){this.push('{'+hash.ids.join(',')+'}');}
if(this.stringParams){this.push('{'+hash.contexts.join(',')+'}');this.push('{'+hash.types.join(',')+'}');}
this.push('{\n    '+hash.values.join(',\n    ')+'\n  }');},pushString:function(string){this.pushStackLiteral(this.quotedString(string));},push:function(expr){this.inlineStack.push(expr);return expr;},pushLiteral:function(value){this.pushStackLiteral(value);},pushProgram:function(guid){if(guid!=null){this.pushStackLiteral(this.programExpression(guid));}else{this.pushStackLiteral(null);}},invokeHelper:function(paramSize,name,isSimple){this.aliases.helperMissing='helpers.helperMissing';var nonHelper=this.popStack();var helper=this.setupHelper(paramSize,name);var lookup=(isSimple?helper.name+' || ':'')+nonHelper+' || helperMissing';this.push('(('+lookup+').call('+helper.callParams+'))');},invokeKnownHelper:function(paramSize,name){var helper=this.setupHelper(paramSize,name);this.push(helper.name+".call("+helper.callParams+")");},invokeAmbiguous:function(name,helperCall){this.aliases.functionType='"function"';this.aliases.helperMissing='helpers.helperMissing';this.useRegister('helper');var nonHelper=this.popStack();this.emptyHash();var helper=this.setupHelper(0,name,helperCall);var helperName=this.lastHelper=this.nameLookup('helpers',name,'helper');this.push('((helper = (helper = '+helperName+' || '+nonHelper+') != null ? helper : helperMissing'
+(helper.paramsInit?'),('+helper.paramsInit:'')+'),'
+'(typeof helper === functionType ? helper.call('+helper.callParams+') : helper))');},invokePartial:function(name,indent){var params=[this.nameLookup('partials',name,'partial'),"'"+indent+"'","'"+name+"'",this.popStack(),this.popStack(),"helpers","partials"];if(this.options.data){params.push("data");}else if(this.options.compat){params.push('undefined');}
if(this.options.compat){params.push('depths');}
this.push("this.invokePartial("+params.join(", ")+")");},assignToHash:function(key){var value=this.popStack(),context,type,id;if(this.trackIds){id=this.popStack();}
if(this.stringParams){type=this.popStack();context=this.popStack();}
var hash=this.hash;if(context){hash.contexts.push("'"+key+"': "+context);}
if(type){hash.types.push("'"+key+"': "+type);}
if(id){hash.ids.push("'"+key+"': "+id);}
hash.values.push("'"+key+"': ("+value+")");},pushId:function(type,name){if(type==='ID'||type==='DATA'){this.pushString(name);}else if(type==='sexpr'){this.pushStackLiteral('true');}else{this.pushStackLiteral('null');}},compiler:JavaScriptCompiler,compileChildren:function(environment,options){var children=environment.children,child,compiler;for(var i=0,l=children.length;i<l;i++){child=children[i];compiler=new this.compiler();var index=this.matchExistingProgram(child);if(index==null){this.context.programs.push('');index=this.context.programs.length;child.index=index;child.name='program'+index;this.context.programs[index]=compiler.compile(child,options,this.context,!this.precompile);this.context.environments[index]=child;this.useDepths=this.useDepths||compiler.useDepths;}else{child.index=index;child.name='program'+index;}}},matchExistingProgram:function(child){for(var i=0,len=this.context.environments.length;i<len;i++){var environment=this.context.environments[i];if(environment&&environment.equals(child)){return i;}}},programExpression:function(guid){var child=this.environment.children[guid],depths=child.depths.list,useDepths=this.useDepths,depth;var programParams=[child.index,'data'];if(useDepths){programParams.push('depths');}
return'this.program('+programParams.join(', ')+')';},useRegister:function(name){if(!this.registers[name]){this.registers[name]=true;this.registers.list.push(name);}},pushStackLiteral:function(item){return this.push(new Literal(item));},pushSource:function(source){if(this.pendingContent){this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent)));this.pendingContent=undefined;}
if(source){this.source.push(source);}},pushStack:function(item){this.flushInline();var stack=this.incrStack();this.pushSource(stack+" = "+item+";");this.compileStack.push(stack);return stack;},replaceStack:function(callback){var prefix='',inline=this.isInline(),stack,createdStack,usedLiteral;if(!this.isInline()){throw new Exception('replaceStack on non-inline');}
var top=this.popStack(true);if(top instanceof Literal){prefix=stack=top.value;usedLiteral=true;}else{createdStack=!this.stackSlot;var name=!createdStack?this.topStackName():this.incrStack();prefix='('+this.push(name)+' = '+top+')';stack=this.topStack();}
var item=callback.call(this,stack);if(!usedLiteral){this.popStack();}
if(createdStack){this.stackSlot--;}
this.push('('+prefix+item+')');},incrStack:function(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push("stack"+this.stackSlot);}
return this.topStackName();},topStackName:function(){return"stack"+this.stackSlot;},flushInline:function(){var inlineStack=this.inlineStack;if(inlineStack.length){this.inlineStack=[];for(var i=0,len=inlineStack.length;i<len;i++){var entry=inlineStack[i];if(entry instanceof Literal){this.compileStack.push(entry);}else{this.pushStack(entry);}}}},isInline:function(){return this.inlineStack.length;},popStack:function(wrapped){var inline=this.isInline(),item=(inline?this.inlineStack:this.compileStack).pop();if(!wrapped&&(item instanceof Literal)){return item.value;}else{if(!inline){if(!this.stackSlot){throw new Exception('Invalid stack pop');}
this.stackSlot--;}
return item;}},topStack:function(){var stack=(this.isInline()?this.inlineStack:this.compileStack),item=stack[stack.length-1];if(item instanceof Literal){return item.value;}else{return item;}},contextName:function(context){if(this.useDepths&&context){return'depths['+context+']';}else{return'depth'+context;}},quotedString:function(str){return'"'+str.replace(/\\/g,'\\\\').replace(/"/g,'\\"').replace(/\n/g,'\\n').replace(/\r/g,'\\r').replace(/\u2028/g,'\\u2028').replace(/\u2029/g,'\\u2029')+'"';},objectLiteral:function(obj){var pairs=[];for(var key in obj){if(obj.hasOwnProperty(key)){pairs.push(this.quotedString(key)+':'+obj[key]);}}
return'{'+pairs.join(',')+'}';},setupHelper:function(paramSize,name,blockHelper){var params=[],paramsInit=this.setupParams(name,paramSize,params,blockHelper);var foundHelper=this.nameLookup('helpers',name,'helper');return{params:params,paramsInit:paramsInit,name:foundHelper,callParams:[this.contextName(0)].concat(params).join(", ")};},setupOptions:function(helper,paramSize,params){var options={},contexts=[],types=[],ids=[],param,inverse,program;options.name=this.quotedString(helper);options.hash=this.popStack();if(this.trackIds){options.hashIds=this.popStack();}
if(this.stringParams){options.hashTypes=this.popStack();options.hashContexts=this.popStack();}
inverse=this.popStack();program=this.popStack();if(program||inverse){if(!program){program='this.noop';}
if(!inverse){inverse='this.noop';}
options.fn=program;options.inverse=inverse;}
var i=paramSize;while(i--){param=this.popStack();params[i]=param;if(this.trackIds){ids[i]=this.popStack();}
if(this.stringParams){types[i]=this.popStack();contexts[i]=this.popStack();}}
if(this.trackIds){options.ids="["+ids.join(",")+"]";}
if(this.stringParams){options.types="["+types.join(",")+"]";options.contexts="["+contexts.join(",")+"]";}
if(this.options.data){options.data="data";}
return options;},setupParams:function(helperName,paramSize,params,useRegister){var options=this.objectLiteral(this.setupOptions(helperName,paramSize,params));if(useRegister){this.useRegister('options');params.push('options');return'options='+options;}else{params.push(options);return'';}}};var reservedWords=("break else new var"+" case finally return void"+" catch for switch while"+" continue function this with"+" default if throw"+" delete in try"+" do instanceof typeof"+" abstract enum int short"+" boolean export interface static"+" byte extends long super"+" char final native synchronized"+" class float package throws"+" const goto private transient"+" debugger implements protected volatile"+" double import public let yield").split(" ");var compilerWords=JavaScriptCompiler.RESERVED_WORDS={};for(var i=0,l=reservedWords.length;i<l;i++){compilerWords[reservedWords[i]]=true;}
JavaScriptCompiler.isValidJavaScriptVariableName=function(name){return!JavaScriptCompiler.RESERVED_WORDS[name]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(name);};__exports__=JavaScriptCompiler;return __exports__;})(__module2__,__module5__);var __module0__=(function(__dependency1__,__dependency2__,__dependency3__,__dependency4__,__dependency5__){"use strict";var __exports__;var Handlebars=__dependency1__;var AST=__dependency2__;var Parser=__dependency3__.parser;var parse=__dependency3__.parse;var Compiler=__dependency4__.Compiler;var compile=__dependency4__.compile;var precompile=__dependency4__.precompile;var JavaScriptCompiler=__dependency5__;var _create=Handlebars.create;var create=function(){var hb=_create();hb.compile=function(input,options){return compile(input,options,hb);};hb.precompile=function(input,options){return precompile(input,options,hb);};hb.AST=AST;hb.Compiler=Compiler;hb.JavaScriptCompiler=JavaScriptCompiler;hb.Parser=Parser;hb.parse=parse;return hb;};Handlebars=create();Handlebars.create=create;Handlebars['default']=Handlebars;__exports__=Handlebars;return __exports__;})(__module1__,__module7__,__module8__,__module11__,__module12__);return __module0__;}));
/*! jQuery UI - v1.11.1 - 2014-10-08
 * http://jqueryui.com
 * Includes: core.js, widget.js, mouse.js, position.js, sortable.js, tabs.js, effect.js
 * Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */
(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else{factory(jQuery);}}(function($){/*!
	 * jQuery UI Core 1.11.1
	 * http://jqueryui.com
	 *
	 * Copyright 2014 jQuery Foundation and other contributors
	 * Released under the MIT license.
	 * http://jquery.org/license
	 *
	 * http://api.jqueryui.com/category/ui-core/
	 */
$.ui=$.ui||{};$.extend($.ui,{version:"1.11.1",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});$.fn.extend({scrollParent:function(includeHidden){var position=this.css("position"),excludeStaticParent=position==="absolute",overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,scrollParent=this.parents().filter(function(){var parent=$(this);if(excludeStaticParent&&parent.css("position")==="static"){return false;}
return overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"));}).eq(0);return position==="fixed"||!scrollParent.length?$(this[0].ownerDocument||document):scrollParent;},uniqueId:(function(){var uuid=0;return function(){return this.each(function(){if(!this.id){this.id="ui-id-"+(++uuid);}});};})(),removeUniqueId:function(){return this.each(function(){if(/^ui-id-\d+$/.test(this.id)){$(this).removeAttr("id");}});}});function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();if("area"===nodeName){map=element.parentNode;mapName=map.name;if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){return false;}
img=$("img[usemap='#"+mapName+"']")[0];return!!img&&visible(img);}
return(/input|select|textarea|button|object/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element);}
function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return $.css(this,"visibility")==="hidden";}).length;}
$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName);};}):function(elem,i,match){return!!$.data(elem,match[3]);},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")));},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN);}});if(!$("<a>").outerWidth(1).jquery){$.each(["Width","Height"],function(i,name){var side=name==="Width"?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function reduce(elem,size,border,margin){$.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0;if(border){size-=parseFloat($.css(elem,"border"+this+"Width"))||0;}
if(margin){size-=parseFloat($.css(elem,"margin"+this))||0;}});return size;}
$.fn["inner"+name]=function(size){if(size===undefined){return orig["inner"+name].call(this);}
return this.each(function(){$(this).css(type,reduce(this,size)+"px");});};$.fn["outer"+name]=function(size,margin){if(typeof size!=="number"){return orig["outer"+name].call(this,size);}
return this.each(function(){$(this).css(type,reduce(this,size,true,margin)+"px");});};});}
if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));};}
if($("<a>").data("a-b","a").removeData("a-b").data("a-b")){$.fn.removeData=(function(removeData){return function(key){if(arguments.length){return removeData.call(this,$.camelCase(key));}else{return removeData.call(this);}};})($.fn.removeData);}
$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());$.fn.extend({focus:(function(orig){return function(delay,fn){return typeof delay==="number"?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus();if(fn){fn.call(elem);}},delay);}):orig.apply(this,arguments);};})($.fn.focus),disableSelection:(function(){var eventType="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(eventType+".ui-disableSelection",function(event){event.preventDefault();});};})(),enableSelection:function(){return this.unbind(".ui-disableSelection");},zIndex:function(zIndex){if(zIndex!==undefined){return this.css("zIndex",zIndex);}
if(this.length){var elem=$(this[0]),position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value;}}
elem=elem.parent();}}
return 0;}});$.ui.plugin={add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]]);}},call:function(instance,name,args,allowDisconnected){var i,set=instance.plugins[name];if(!set){return;}
if(!allowDisconnected&&(!instance.element[0].parentNode||instance.element[0].parentNode.nodeType===11)){return;}
for(i=0;i<set.length;i++){if(instance.options[set[i][0]]){set[i][1].apply(instance.element,args);}}}};/*!
	 * jQuery UI Widget 1.11.1
	 * http://jqueryui.com
	 *
	 * Copyright 2014 jQuery Foundation and other contributors
	 * Released under the MIT license.
	 * http://jquery.org/license
	 *
	 * http://api.jqueryui.com/jQuery.widget/
	 */
var widget_uuid=0,widget_slice=Array.prototype.slice;$.cleanData=(function(orig){return function(elems){var events,elem,i;for(i=0;(elem=elems[i])!=null;i++){try{events=$._data(elem,"events");if(events&&events.remove){$(elem).triggerHandler("remove");}}catch(e){}}
orig(elems);};})($.cleanData);$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget;}
$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName);};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element);}
if(arguments.length){this._createWidget(options,element);}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base();basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return;}
proxiedPrototype[prop]=(function(){var _super=function(){return base.prototype[prop].apply(this,arguments);},_superApply=function(args){return base.prototype[prop].apply(this,args);};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue;};})();});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?(basePrototype.widgetEventPrefix||name):name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto);});delete existingConstructor._childConstructors;}else{base._childConstructors.push(constructor);}
$.widget.bridge(name,constructor);return constructor;};$.widget.extend=function(target){var input=widget_slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value);}else{target[key]=value;}}}}
return target;};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=widget_slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(options==="instance"){returnValue=instance;return false;}
if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'");}
if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance");}
methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false;}});}else{this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{});if(instance._init){instance._init();}}else{$.data(this,fullName,new object(options,this));}});}
return returnValue;};};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=widget_uuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy();}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow);}
this._create();this._trigger("create",null,this._getCreateEventData());this._init();},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");},_destroy:$.noop,widget:function(){return this.element;},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options);}
if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]];}
key=parts.pop();if(arguments.length===1){return curOption[key]===undefined?null:curOption[key];}
curOption[key]=value;}else{if(arguments.length===1){return this.options[key]===undefined?null:this.options[key];}
options[key]=value;}}
this._setOptions(options);return this;},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key]);}
return this;},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled",!!value);if(value){this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");}}
return this;},enable:function(){return this._setOptions({disabled:false});},disable:function(){return this._setOptions({disabled:true});},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false;}
if(!handlers){handlers=element;element=this.element;delegateElement=this.widget();}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element);}
$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return;}
return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++;}
var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy);}else{element.bind(eventName,handlerProxy);}});},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;element.unbind(eventName).undelegate(eventName);},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
var instance=this;return setTimeout(handlerProxy,delay||0);},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover");},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover");}});},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus");},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus");}});},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop];}}}
this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented());}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options};}
var hasOptions,effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options};}
hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay);}
if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options);}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback);}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0]);}
next();});}};});var widget=$.widget;/*!
	 * jQuery UI Mouse 1.11.1
	 * http://jqueryui.com
	 *
	 * Copyright 2014 jQuery Foundation and other contributors
	 * Released under the MIT license.
	 * http://jquery.org/license
	 *
	 * http://api.jqueryui.com/mouse/
	 */
var mouseHandled=false;$(document).mouseup(function(){mouseHandled=false;});var mouse=$.widget("ui.mouse",{version:"1.11.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.bind("mousedown."+this.widgetName,function(event){return that._mouseDown(event);}).bind("click."+this.widgetName,function(event){if(true===$.data(event.target,that.widgetName+".preventClickEvent")){$.removeData(event.target,that.widgetName+".preventClickEvent");event.stopImmediatePropagation();return false;}});this.started=false;},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);}},_mouseDown:function(event){if(mouseHandled){return;}
(this._mouseStarted&&this._mouseUp(event));this._mouseDownEvent=event;var that=this,btnIsLeft=(event.which===1),elIsCancel=(typeof this.options.cancel==="string"&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:false);if(!btnIsLeft||elIsCancel||!this._mouseCapture(event)){return true;}
this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=true;},this.options.delay);}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(event)!==false);if(!this._mouseStarted){event.preventDefault();return true;}}
if(true===$.data(event.target,this.widgetName+".preventClickEvent")){$.removeData(event.target,this.widgetName+".preventClickEvent");}
this._mouseMoveDelegate=function(event){return that._mouseMove(event);};this._mouseUpDelegate=function(event){return that._mouseUp(event);};this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);event.preventDefault();mouseHandled=true;return true;},_mouseMove:function(event){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button){return this._mouseUp(event);}else if(!event.which){return this._mouseUp(event);}
if(this._mouseStarted){this._mouseDrag(event);return event.preventDefault();}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,event)!==false);(this._mouseStarted?this._mouseDrag(event):this._mouseUp(event));}
return!this._mouseStarted;},_mouseUp:function(event){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(event.target===this._mouseDownEvent.target){$.data(event.target,this.widgetName+".preventClickEvent",true);}
this._mouseStop(event);}
mouseHandled=false;return false;},_mouseDistanceMet:function(event){return(Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance);},_mouseDelayMet:function(){return this.mouseDelayMet;},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true;}});/*!
	 * jQuery UI Position 1.11.1
	 * http://jqueryui.com
	 *
	 * Copyright 2014 jQuery Foundation and other contributors
	 * Released under the MIT license.
	 * http://jquery.org/license
	 *
	 * http://api.jqueryui.com/position/
	 */
(function(){$.ui=$.ui||{};var cachedScrollbarWidth,supportsOffsetFractions,max=Math.max,abs=Math.abs,round=Math.round,rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[\+\-]\d+(\.[\d]+)?%?/,rposition=/^\w+/,rpercent=/%$/,_position=$.fn.position;function getOffsets(offsets,width,height){return[parseFloat(offsets[0])*(rpercent.test(offsets[0])?width / 100:1),parseFloat(offsets[1])*(rpercent.test(offsets[1])?height / 100:1)];}
function parseCss(element,property){return parseInt($.css(element,property),10)||0;}
function getDimensions(elem){var raw=elem[0];if(raw.nodeType===9){return{width:elem.width(),height:elem.height(),offset:{top:0,left:0}};}
if($.isWindow(raw)){return{width:elem.width(),height:elem.height(),offset:{top:elem.scrollTop(),left:elem.scrollLeft()}};}
if(raw.preventDefault){return{width:0,height:0,offset:{top:raw.pageY,left:raw.pageX}};}
return{width:elem.outerWidth(),height:elem.outerHeight(),offset:elem.offset()};}
$.position={scrollbarWidth:function(){if(cachedScrollbarWidth!==undefined){return cachedScrollbarWidth;}
var w1,w2,div=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];$("body").append(div);w1=innerDiv.offsetWidth;div.css("overflow","scroll");w2=innerDiv.offsetWidth;if(w1===w2){w2=div[0].clientWidth;}
div.remove();return(cachedScrollbarWidth=w1-w2);},getScrollInfo:function(within){var overflowX=within.isWindow||within.isDocument?"":within.element.css("overflow-x"),overflowY=within.isWindow||within.isDocument?"":within.element.css("overflow-y"),hasOverflowX=overflowX==="scroll"||(overflowX==="auto"&&within.width<within.element[0].scrollWidth),hasOverflowY=overflowY==="scroll"||(overflowY==="auto"&&within.height<within.element[0].scrollHeight);return{width:hasOverflowY?$.position.scrollbarWidth():0,height:hasOverflowX?$.position.scrollbarWidth():0};},getWithinInfo:function(element){var withinElement=$(element||window),isWindow=$.isWindow(withinElement[0]),isDocument=!!withinElement[0]&&withinElement[0].nodeType===9;return{element:withinElement,isWindow:isWindow,isDocument:isDocument,offset:withinElement.offset()||{left:0,top:0},scrollLeft:withinElement.scrollLeft(),scrollTop:withinElement.scrollTop(),width:isWindow||isDocument?withinElement.width():withinElement.outerWidth(),height:isWindow||isDocument?withinElement.height():withinElement.outerHeight()};}};$.fn.position=function(options){if(!options||!options.of){return _position.apply(this,arguments);}
options=$.extend({},options);var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,target=$(options.of),within=$.position.getWithinInfo(options.within),scrollInfo=$.position.getScrollInfo(within),collision=(options.collision||"flip").split(" "),offsets={};dimensions=getDimensions(target);if(target[0].preventDefault){options.at="left top";}
targetWidth=dimensions.width;targetHeight=dimensions.height;targetOffset=dimensions.offset;basePosition=$.extend({},targetOffset);$.each(["my","at"],function(){var pos=(options[this]||"").split(" "),horizontalOffset,verticalOffset;if(pos.length===1){pos=rhorizontal.test(pos[0])?pos.concat(["center"]):rvertical.test(pos[0])?["center"].concat(pos):["center","center"];}
pos[0]=rhorizontal.test(pos[0])?pos[0]:"center";pos[1]=rvertical.test(pos[1])?pos[1]:"center";horizontalOffset=roffset.exec(pos[0]);verticalOffset=roffset.exec(pos[1]);offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0];options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]];});if(collision.length===1){collision[1]=collision[0];}
if(options.at[0]==="right"){basePosition.left+=targetWidth;}else if(options.at[0]==="center"){basePosition.left+=targetWidth / 2;}
if(options.at[1]==="bottom"){basePosition.top+=targetHeight;}else if(options.at[1]==="center"){basePosition.top+=targetHeight / 2;}
atOffset=getOffsets(offsets.at,targetWidth,targetHeight);basePosition.left+=atOffset[0];basePosition.top+=atOffset[1];return this.each(function(){var collisionPosition,using,elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseCss(this,"marginLeft"),marginTop=parseCss(this,"marginTop"),collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+scrollInfo.width,collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+scrollInfo.height,position=$.extend({},basePosition),myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());if(options.my[0]==="right"){position.left-=elemWidth;}else if(options.my[0]==="center"){position.left-=elemWidth / 2;}
if(options.my[1]==="bottom"){position.top-=elemHeight;}else if(options.my[1]==="center"){position.top-=elemHeight / 2;}
position.left+=myOffset[0];position.top+=myOffset[1];if(!supportsOffsetFractions){position.left=round(position.left);position.top=round(position.top);}
collisionPosition={marginLeft:marginLeft,marginTop:marginTop};$.each(["left","top"],function(i,dir){if($.ui.position[collision[i]]){$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem});}});if(options.using){using=function(props){var left=targetOffset.left-position.left,right=left+targetWidth-elemWidth,top=targetOffset.top-position.top,bottom=top+targetHeight-elemHeight,feedback={target:{element:target,left:targetOffset.left,top:targetOffset.top,width:targetWidth,height:targetHeight},element:{element:elem,left:position.left,top:position.top,width:elemWidth,height:elemHeight},horizontal:right<0?"left":left>0?"right":"center",vertical:bottom<0?"top":top>0?"bottom":"middle"};if(targetWidth<elemWidth&&abs(left+right)<targetWidth){feedback.horizontal="center";}
if(targetHeight<elemHeight&&abs(top+bottom)<targetHeight){feedback.vertical="middle";}
if(max(abs(left),abs(right))>max(abs(top),abs(bottom))){feedback.important="horizontal";}else{feedback.important="vertical";}
options.using.call(this,props,feedback);};}
elem.offset($.extend(position,{using:using}));});};$.ui.position={fit:{left:function(position,data){var within=data.within,withinOffset=within.isWindow?within.scrollLeft:within.offset.left,outerWidth=within.width,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset,newOverRight;if(data.collisionWidth>outerWidth){if(overLeft>0&&overRight<=0){newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset;position.left+=overLeft-newOverRight;}else if(overRight>0&&overLeft<=0){position.left=withinOffset;}else{if(overLeft>overRight){position.left=withinOffset+outerWidth-data.collisionWidth;}else{position.left=withinOffset;}}}else if(overLeft>0){position.left+=overLeft;}else if(overRight>0){position.left-=overRight;}else{position.left=max(position.left-collisionPosLeft,position.left);}},top:function(position,data){var within=data.within,withinOffset=within.isWindow?within.scrollTop:within.offset.top,outerHeight=data.within.height,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset,newOverBottom;if(data.collisionHeight>outerHeight){if(overTop>0&&overBottom<=0){newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset;position.top+=overTop-newOverBottom;}else if(overBottom>0&&overTop<=0){position.top=withinOffset;}else{if(overTop>overBottom){position.top=withinOffset+outerHeight-data.collisionHeight;}else{position.top=withinOffset;}}}else if(overTop>0){position.top+=overTop;}else if(overBottom>0){position.top-=overBottom;}else{position.top=max(position.top-collisionPosTop,position.top);}}},flip:{left:function(position,data){var within=data.within,withinOffset=within.offset.left+within.scrollLeft,outerWidth=within.width,offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-offsetLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,myOffset=data.my[0]==="left"?-data.elemWidth:data.my[0]==="right"?data.elemWidth:0,atOffset=data.at[0]==="left"?data.targetWidth:data.at[0]==="right"?-data.targetWidth:0,offset=-2*data.offset[0],newOverRight,newOverLeft;if(overLeft<0){newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset;if(newOverRight<0||newOverRight<abs(overLeft)){position.left+=myOffset+atOffset+offset;}}else if(overRight>0){newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-offsetLeft;if(newOverLeft>0||abs(newOverLeft)<overRight){position.left+=myOffset+atOffset+offset;}}},top:function(position,data){var within=data.within,withinOffset=within.offset.top+within.scrollTop,outerHeight=within.height,offsetTop=within.isWindow?within.scrollTop:within.offset.top,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-offsetTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,top=data.my[1]==="top",myOffset=top?-data.elemHeight:data.my[1]==="bottom"?data.elemHeight:0,atOffset=data.at[1]==="top"?data.targetHeight:data.at[1]==="bottom"?-data.targetHeight:0,offset=-2*data.offset[1],newOverTop,newOverBottom;if(overTop<0){newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset;if((position.top+myOffset+atOffset+offset)>overTop&&(newOverBottom<0||newOverBottom<abs(overTop))){position.top+=myOffset+atOffset+offset;}}else if(overBottom>0){newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-offsetTop;if((position.top+myOffset+atOffset+offset)>overBottom&&(newOverTop>0||abs(newOverTop)<overBottom)){position.top+=myOffset+atOffset+offset;}}}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments);$.ui.position.fit.left.apply(this,arguments);},top:function(){$.ui.position.flip.top.apply(this,arguments);$.ui.position.fit.top.apply(this,arguments);}}};(function(){var testElement,testElementParent,testElementStyle,offsetLeft,i,body=document.getElementsByTagName("body")[0],div=document.createElement("div");testElement=document.createElement(body?"div":"body");testElementStyle={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(body){$.extend(testElementStyle,{position:"absolute",left:"-1000px",top:"-1000px"});}
for(i in testElementStyle){testElement.style[i]=testElementStyle[i];}
testElement.appendChild(div);testElementParent=body||document.documentElement;testElementParent.insertBefore(testElement,testElementParent.firstChild);div.style.cssText="position: absolute; left: 10.7432222px;";offsetLeft=$(div).offset().left;supportsOffsetFractions=offsetLeft>10&&offsetLeft<11;testElement.innerHTML="";testElementParent.removeChild(testElement);})();})();var position=$.ui.position;/*!
	 * jQuery UI Sortable 1.11.1
	 * http://jqueryui.com
	 *
	 * Copyright 2014 jQuery Foundation and other contributors
	 * Released under the MIT license.
	 * http://jquery.org/license
	 *
	 * http://api.jqueryui.com/sortable/
	 */
var sortable=$.widget("ui.sortable",$.ui.mouse,{version:"1.11.1",widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(x,reference,size){return(x>=reference)&&(x<(reference+size));},_isFloating:function(item){return(/left|right/).test(item.css("float"))||(/inline|table-cell/).test(item.css("display"));},_create:function(){var o=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?o.axis==="x"||this._isFloating(this.items[0].item):false;this.offset=this.element.offset();this._mouseInit();this._setHandleClassName();this.ready=true;},_setOption:function(key,value){this._super(key,value);if(key==="handle"){this._setHandleClassName();}},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle");$.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle");});},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle");this._mouseDestroy();for(var i=this.items.length-1;i>=0;i--){this.items[i].item.removeData(this.widgetName+"-item");}
return this;},_mouseCapture:function(event,overrideHandle){var currentItem=null,validHandle=false,that=this;if(this.reverting){return false;}
if(this.options.disabled||this.options.type==="static"){return false;}
this._refreshItems(event);$(event.target).parents().each(function(){if($.data(this,that.widgetName+"-item")===that){currentItem=$(this);return false;}});if($.data(event.target,that.widgetName+"-item")===that){currentItem=$(event.target);}
if(!currentItem){return false;}
if(this.options.handle&&!overrideHandle){$(this.options.handle,currentItem).find("*").addBack().each(function(){if(this===event.target){validHandle=true;}});if(!validHandle){return false;}}
this.currentItem=currentItem;this._removeCurrentsFromItems();return true;},_mouseStart:function(event,overrideHandle,noActivation){var i,body,o=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(event);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(event);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide();}
this._createPlaceholder();if(o.containment){this._setContainment();}
if(o.cursor&&o.cursor!=="auto"){body=this.document.find("body");this.storedCursor=body.css("cursor");body.css("cursor",o.cursor);this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(body);}
if(o.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity");}
this.helper.css("opacity",o.opacity);}
if(o.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex");}
this.helper.css("zIndex",o.zIndex);}
if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset();}
this._trigger("start",event,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions();}
if(!noActivation){for(i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("activate",event,this._uiHash(this));}}
if($.ui.ddmanager){$.ui.ddmanager.current=this;}
if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}
this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(event);return true;},_mouseDrag:function(event){var i,item,itemElement,intersection,o=this.options,scrolled=false;this.position=this._generatePosition(event);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs;}
if(this.options.scroll){if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-event.pageY<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed;}else if(event.pageY-this.overflowOffset.top<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed;}
if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-event.pageX<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed;}else if(event.pageX-this.overflowOffset.left<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed;}}else{if(event.pageY-$(document).scrollTop()<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);}else if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed);}
if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);}else if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed);}}
if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event);}}
this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px";}
if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px";}
for(i=this.items.length-1;i>=0;i--){item=this.items[i];itemElement=item.item[0];intersection=this._intersectsWithPointer(item);if(!intersection){continue;}
if(item.instance!==this.currentContainer){continue;}
if(itemElement!==this.currentItem[0]&&this.placeholder[intersection===1?"next":"prev"]()[0]!==itemElement&&!$.contains(this.placeholder[0],itemElement)&&(this.options.type==="semi-dynamic"?!$.contains(this.element[0],itemElement):true)){this.direction=intersection===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(item)){this._rearrange(event,item);}else{break;}
this._trigger("change",event,this._uiHash());break;}}
this._contactContainers(event);if($.ui.ddmanager){$.ui.ddmanager.drag(this,event);}
this._trigger("sort",event,this._uiHash());this.lastPositionAbs=this.positionAbs;return false;},_mouseStop:function(event,noPropagation){if(!event){return;}
if($.ui.ddmanager&&!this.options.dropBehaviour){$.ui.ddmanager.drop(this,event);}
if(this.options.revert){var that=this,cur=this.placeholder.offset(),axis=this.options.axis,animation={};if(!axis||axis==="x"){animation.left=cur.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft);}
if(!axis||axis==="y"){animation.top=cur.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop);}
this.reverting=true;$(this.helper).animate(animation,parseInt(this.options.revert,10)||500,function(){that._clear(event);});}else{this._clear(event,noPropagation);}
return false;},cancel:function(){if(this.dragging){this._mouseUp({target:null});if(this.options.helper==="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");}else{this.currentItem.show();}
for(var i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("deactivate",null,this._uiHash(this));if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",null,this._uiHash(this));this.containers[i].containerCache.over=0;}}}
if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0]);}
if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove();}
$.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){$(this.domPosition.prev).after(this.currentItem);}else{$(this.domPosition.parent).prepend(this.currentItem);}}
return this;},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected),str=[];o=o||{};$(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||(/(.+)[\-=_](.+)/));if(res){str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]));}});if(!str.length&&o.key){str.push(o.key+"=");}
return str.join("&");},toArray:function(o){var items=this._getItemsAsjQuery(o&&o.connected),ret=[];o=o||{};items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"");});return ret;},_intersectsWith:function(item){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height,l=item.left,r=l+item.width,t=item.top,b=t+item.height,dyClick=this.offset.click.top,dxClick=this.offset.click.left,isOverElementHeight=(this.options.axis==="x")||((y1+dyClick)>t&&(y1+dyClick)<b),isOverElementWidth=(this.options.axis==="y")||((x1+dxClick)>l&&(x1+dxClick)<r),isOverElement=isOverElementHeight&&isOverElementWidth;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"])){return isOverElement;}else{return(l<x1+(this.helperProportions.width / 2)&&x2-(this.helperProportions.width / 2)<r&&t<y1+(this.helperProportions.height / 2)&&y2-(this.helperProportions.height / 2)<b);}},_intersectsWithPointer:function(item){var isOverElementHeight=(this.options.axis==="x")||this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),isOverElementWidth=(this.options.axis==="y")||this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width),isOverElement=isOverElementHeight&&isOverElementWidth,verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();if(!isOverElement){return false;}
return this.floating?(((horizontalDirection&&horizontalDirection==="right")||verticalDirection==="down")?2:1):(verticalDirection&&(verticalDirection==="down"?2:1));},_intersectsWithSides:function(item){var isOverBottomHalf=this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top+(item.height/2),item.height),isOverRightHalf=this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left+(item.width/2),item.width),verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();if(this.floating&&horizontalDirection){return((horizontalDirection==="right"&&isOverRightHalf)||(horizontalDirection==="left"&&!isOverRightHalf));}else{return verticalDirection&&((verticalDirection==="down"&&isOverBottomHalf)||(verticalDirection==="up"&&!isOverBottomHalf));}},_getDragVerticalDirection:function(){var delta=this.positionAbs.top-this.lastPositionAbs.top;return delta!==0&&(delta>0?"down":"up");},_getDragHorizontalDirection:function(){var delta=this.positionAbs.left-this.lastPositionAbs.left;return delta!==0&&(delta>0?"right":"left");},refresh:function(event){this._refreshItems(event);this._setHandleClassName();this.refreshPositions();return this;},_connectWith:function(){var options=this.options;return options.connectWith.constructor===String?[options.connectWith]:options.connectWith;},_getItemsAsjQuery:function(connected){var i,j,cur,inst,items=[],queries=[],connectWith=this._connectWith();if(connectWith&&connected){for(i=connectWith.length-1;i>=0;i--){cur=$(connectWith[i]);for(j=cur.length-1;j>=0;j--){inst=$.data(cur[j],this.widgetFullName);if(inst&&inst!==this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst]);}}}}
queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);function addItems(){items.push(this);}
for(i=queries.length-1;i>=0;i--){queries[i][0].each(addItems);}
return $(items);},_removeCurrentsFromItems:function(){var list=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(item){for(var j=0;j<list.length;j++){if(list[j]===item.item[0]){return false;}}
return true;});},_refreshItems:function(event){this.items=[];this.containers=[this];var i,j,cur,inst,targetData,_queries,item,queriesLength,items=this.items,queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]],connectWith=this._connectWith();if(connectWith&&this.ready){for(i=connectWith.length-1;i>=0;i--){cur=$(connectWith[i]);for(j=cur.length-1;j>=0;j--){inst=$.data(cur[j],this.widgetFullName);if(inst&&inst!==this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]);this.containers.push(inst);}}}}
for(i=queries.length-1;i>=0;i--){targetData=queries[i][1];_queries=queries[i][0];for(j=0,queriesLength=_queries.length;j<queriesLength;j++){item=$(_queries[j]);item.data(this.widgetName+"-item",targetData);items.push({item:item,instance:targetData,width:0,height:0,left:0,top:0});}}},refreshPositions:function(fast){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset();}
var i,item,t,p;for(i=this.items.length-1;i>=0;i--){item=this.items[i];if(item.instance!==this.currentContainer&&this.currentContainer&&item.item[0]!==this.currentItem[0]){continue;}
t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item;if(!fast){item.width=t.outerWidth();item.height=t.outerHeight();}
p=t.offset();item.left=p.left;item.top=p.top;}
if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this);}else{for(i=this.containers.length-1;i>=0;i--){p=this.containers[i].element.offset();this.containers[i].containerCache.left=p.left;this.containers[i].containerCache.top=p.top;this.containers[i].containerCache.width=this.containers[i].element.outerWidth();this.containers[i].containerCache.height=this.containers[i].element.outerHeight();}}
return this;},_createPlaceholder:function(that){that=that||this;var className,o=that.options;if(!o.placeholder||o.placeholder.constructor===String){className=o.placeholder;o.placeholder={element:function(){var nodeName=that.currentItem[0].nodeName.toLowerCase(),element=$("<"+nodeName+">",that.document[0]).addClass(className||that.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");if(nodeName==="tr"){that.currentItem.children().each(function(){$("<td>&#160;</td>",that.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(element);});}else if(nodeName==="img"){element.attr("src",that.currentItem.attr("src"));}
if(!className){element.css("visibility","hidden");}
return element;},update:function(container,p){if(className&&!o.forcePlaceholderSize){return;}
if(!p.height()){p.height(that.currentItem.innerHeight()-parseInt(that.currentItem.css("paddingTop")||0,10)-parseInt(that.currentItem.css("paddingBottom")||0,10));}
if(!p.width()){p.width(that.currentItem.innerWidth()-parseInt(that.currentItem.css("paddingLeft")||0,10)-parseInt(that.currentItem.css("paddingRight")||0,10));}}};}
that.placeholder=$(o.placeholder.element.call(that.element,that.currentItem));that.currentItem.after(that.placeholder);o.placeholder.update(that,that.placeholder);},_contactContainers:function(event){var i,j,dist,itemWithLeastDistance,posProperty,sizeProperty,cur,nearBottom,floating,axis,innermostContainer=null,innermostIndex=null;for(i=this.containers.length-1;i>=0;i--){if($.contains(this.currentItem[0],this.containers[i].element[0])){continue;}
if(this._intersectsWith(this.containers[i].containerCache)){if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0])){continue;}
innermostContainer=this.containers[i];innermostIndex=i;}else{if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",event,this._uiHash(this));this.containers[i].containerCache.over=0;}}}
if(!innermostContainer){return;}
if(this.containers.length===1){if(!this.containers[innermostIndex].containerCache.over){this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1;}}else{dist=10000;itemWithLeastDistance=null;floating=innermostContainer.floating||this._isFloating(this.currentItem);posProperty=floating?"left":"top";sizeProperty=floating?"width":"height";axis=floating?"clientX":"clientY";for(j=this.items.length-1;j>=0;j--){if(!$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])){continue;}
if(this.items[j].item[0]===this.currentItem[0]){continue;}
cur=this.items[j].item.offset()[posProperty];nearBottom=false;if(event[axis]-cur>this.items[j][sizeProperty]/ 2){nearBottom=true;}
if(Math.abs(event[axis]-cur)<dist){dist=Math.abs(event[axis]-cur);itemWithLeastDistance=this.items[j];this.direction=nearBottom?"up":"down";}}
if(!itemWithLeastDistance&&!this.options.dropOnEmpty){return;}
if(this.currentContainer===this.containers[innermostIndex]){return;}
itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,true):this._rearrange(event,null,this.containers[innermostIndex].element,true);this._trigger("change",event,this._uiHash());this.containers[innermostIndex]._trigger("change",event,this._uiHash(this));this.currentContainer=this.containers[innermostIndex];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1;}},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):(o.helper==="clone"?this.currentItem.clone():this.currentItem);if(!helper.parents("body").length){$(o.appendTo!=="parent"?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0]);}
if(helper[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")};}
if(!helper[0].style.width||o.forceHelperSize){helper.width(this.currentItem.width());}
if(!helper[0].style.height||o.forceHelperSize){helper.height(this.currentItem.height());}
return helper;},_adjustOffsetFromHelper:function(obj){if(typeof obj==="string"){obj=obj.split(" ");}
if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0};}
if("left"in obj){this.offset.click.left=obj.left+this.margins.left;}
if("right"in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left;}
if("top"in obj){this.offset.click.top=obj.top+this.margins.top;}
if("bottom"in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top;}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop();}
if(this.offsetParent[0]===document.body||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&$.ui.ie)){po={top:0,left:0};}
return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)};},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var p=this.currentItem.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()};}else{return{top:0,left:0};}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)};},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};},_setContainment:function(){var ce,co,over,o=this.options;if(o.containment==="parent"){o.containment=this.helper[0].parentNode;}
if(o.containment==="document"||o.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,$(o.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,($(o.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];}
if(!(/^(document|window|parent)$/).test(o.containment)){ce=$(o.containment)[0];co=$(o.containment).offset();over=($(ce).css("overflow")!=="hidden");this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top];}},_convertPositionTo:function(d,pos){if(!pos){pos=this.position;}
var mod=d==="absolute"?1:-1,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);return{top:(pos.top+
this.offset.relative.top*mod+
this.offset.parent.top*mod-
((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop()))*mod)),left:(pos.left+
this.offset.relative.left*mod+
this.offset.parent.left*mod-
((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod))};},_generatePosition:function(event){var top,left,o=this.options,pageX=event.pageX,pageY=event.pageY,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset();}
if(this.originalPosition){if(this.containment){if(event.pageX-this.offset.click.left<this.containment[0]){pageX=this.containment[0]+this.offset.click.left;}
if(event.pageY-this.offset.click.top<this.containment[1]){pageY=this.containment[1]+this.offset.click.top;}
if(event.pageX-this.offset.click.left>this.containment[2]){pageX=this.containment[2]+this.offset.click.left;}
if(event.pageY-this.offset.click.top>this.containment[3]){pageY=this.containment[3]+this.offset.click.top;}}
if(o.grid){top=this.originalPageY+Math.round((pageY-this.originalPageY)/ o.grid[1])*o.grid[1];pageY=this.containment?((top-this.offset.click.top>=this.containment[1]&&top-this.offset.click.top<=this.containment[3])?top:((top-this.offset.click.top>=this.containment[1])?top-o.grid[1]:top+o.grid[1])):top;left=this.originalPageX+Math.round((pageX-this.originalPageX)/ o.grid[0])*o.grid[0];pageX=this.containment?((left-this.offset.click.left>=this.containment[0]&&left-this.offset.click.left<=this.containment[2])?left:((left-this.offset.click.left>=this.containment[0])?left-o.grid[0]:left+o.grid[0])):left;}}
return{top:(pageY-
this.offset.click.top-
this.offset.relative.top-
this.offset.parent.top+
((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop())))),left:(pageX-
this.offset.click.left-
this.offset.relative.left-
this.offset.parent.left+
((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())))};},_rearrange:function(event,i,a,hardRefresh){a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction==="down"?i.item[0]:i.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var counter=this.counter;this._delay(function(){if(counter===this.counter){this.refreshPositions(!hardRefresh);}});},_clear:function(event,noPropagation){this.reverting=false;var i,delayedTriggers=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem);}
this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(i in this._storedCSS){if(this._storedCSS[i]==="auto"||this._storedCSS[i]==="static"){this._storedCSS[i]="";}}
this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper");}else{this.currentItem.show();}
if(this.fromOutside&&!noPropagation){delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside));});}
if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!noPropagation){delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash());});}
if(this!==this.currentContainer){if(!noPropagation){delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash());});delayedTriggers.push((function(c){return function(event){c._trigger("receive",event,this._uiHash(this));};}).call(this,this.currentContainer));delayedTriggers.push((function(c){return function(event){c._trigger("update",event,this._uiHash(this));};}).call(this,this.currentContainer));}}
function delayEvent(type,instance,container){return function(event){container._trigger(type,event,instance._uiHash(instance));};}
for(i=this.containers.length-1;i>=0;i--){if(!noPropagation){delayedTriggers.push(delayEvent("deactivate",this,this.containers[i]));}
if(this.containers[i].containerCache.over){delayedTriggers.push(delayEvent("out",this,this.containers[i]));this.containers[i].containerCache.over=0;}}
if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove();}
if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity);}
if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex);}
this.dragging=false;if(this.cancelHelperRemoval){if(!noPropagation){this._trigger("beforeStop",event,this._uiHash());for(i=0;i<delayedTriggers.length;i++){delayedTriggers[i].call(this,event);}
this._trigger("stop",event,this._uiHash());}
this.fromOutside=false;return false;}
if(!noPropagation){this._trigger("beforeStop",event,this._uiHash());}
this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.helper[0]!==this.currentItem[0]){this.helper.remove();}
this.helper=null;if(!noPropagation){for(i=0;i<delayedTriggers.length;i++){delayedTriggers[i].call(this,event);}
this._trigger("stop",event,this._uiHash());}
this.fromOutside=false;return true;},_trigger:function(){if($.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel();}},_uiHash:function(_inst){var inst=_inst||this;return{helper:inst.helper,placeholder:inst.placeholder||$([]),position:inst.position,originalPosition:inst.originalPosition,offset:inst.positionAbs,item:inst.currentItem,sender:_inst?_inst.element:null};}});/*!
	 * jQuery UI Tabs 1.11.1
	 * http://jqueryui.com
	 *
	 * Copyright 2014 jQuery Foundation and other contributors
	 * Released under the MIT license.
	 * http://jquery.org/license
	 *
	 * http://api.jqueryui.com/tabs/
	 */
var tabs=$.widget("ui.tabs",{version:"1.11.1",delay:300,options:{active:null,collapsible:false,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:(function(){var rhash=/#.*$/;return function(anchor){var anchorUrl,locationUrl;anchor=anchor.cloneNode(false);anchorUrl=anchor.href.replace(rhash,"");locationUrl=location.href.replace(rhash,"");try{anchorUrl=decodeURIComponent(anchorUrl);}catch(error){}
try{locationUrl=decodeURIComponent(locationUrl);}catch(error){}
return anchor.hash.length>1&&anchorUrl===locationUrl;};})(),_create:function(){var that=this,options=this.options;this.running=false;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",options.collapsible);this._processTabs();options.active=this._initialActive();if($.isArray(options.disabled)){options.disabled=$.unique(options.disabled.concat($.map(this.tabs.filter(".ui-state-disabled"),function(li){return that.tabs.index(li);}))).sort();}
if(this.options.active!==false&&this.anchors.length){this.active=this._findActive(options.active);}else{this.active=$();}
this._refresh();if(this.active.length){this.load(options.active);}},_initialActive:function(){var active=this.options.active,collapsible=this.options.collapsible,locationHash=location.hash.substring(1);if(active===null){if(locationHash){this.tabs.each(function(i,tab){if($(tab).attr("aria-controls")===locationHash){active=i;return false;}});}
if(active===null){active=this.tabs.index(this.tabs.filter(".ui-tabs-active"));}
if(active===null||active===-1){active=this.tabs.length?0:false;}}
if(active!==false){active=this.tabs.index(this.tabs.eq(active));if(active===-1){active=collapsible?false:0;}}
if(!collapsible&&active===false&&this.anchors.length){active=0;}
return active;},_getCreateEventData:function(){return{tab:this.active,panel:!this.active.length?$():this._getPanelForTab(this.active)};},_tabKeydown:function(event){var focusedTab=$(this.document[0].activeElement).closest("li"),selectedIndex=this.tabs.index(focusedTab),goingForward=true;if(this._handlePageNav(event)){return;}
switch(event.keyCode){case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:selectedIndex++;break;case $.ui.keyCode.UP:case $.ui.keyCode.LEFT:goingForward=false;selectedIndex--;break;case $.ui.keyCode.END:selectedIndex=this.anchors.length-1;break;case $.ui.keyCode.HOME:selectedIndex=0;break;case $.ui.keyCode.SPACE:event.preventDefault();clearTimeout(this.activating);this._activate(selectedIndex);return;case $.ui.keyCode.ENTER:event.preventDefault();clearTimeout(this.activating);this._activate(selectedIndex===this.options.active?false:selectedIndex);return;default:return;}
event.preventDefault();clearTimeout(this.activating);selectedIndex=this._focusNextTab(selectedIndex,goingForward);if(!event.ctrlKey){focusedTab.attr("aria-selected","false");this.tabs.eq(selectedIndex).attr("aria-selected","true");this.activating=this._delay(function(){this.option("active",selectedIndex);},this.delay);}},_panelKeydown:function(event){if(this._handlePageNav(event)){return;}
if(event.ctrlKey&&event.keyCode===$.ui.keyCode.UP){event.preventDefault();this.active.focus();}},_handlePageNav:function(event){if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_UP){this._activate(this._focusNextTab(this.options.active-1,false));return true;}
if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_DOWN){this._activate(this._focusNextTab(this.options.active+1,true));return true;}},_findNextTab:function(index,goingForward){var lastTabIndex=this.tabs.length-1;function constrain(){if(index>lastTabIndex){index=0;}
if(index<0){index=lastTabIndex;}
return index;}
while($.inArray(constrain(),this.options.disabled)!==-1){index=goingForward?index+1:index-1;}
return index;},_focusNextTab:function(index,goingForward){index=this._findNextTab(index,goingForward);this.tabs.eq(index).focus();return index;},_setOption:function(key,value){if(key==="active"){this._activate(value);return;}
if(key==="disabled"){this._setupDisabled(value);return;}
this._super(key,value);if(key==="collapsible"){this.element.toggleClass("ui-tabs-collapsible",value);if(!value&&this.options.active===false){this._activate(0);}}
if(key==="event"){this._setupEvents(value);}
if(key==="heightStyle"){this._setupHeightStyle(value);}},_sanitizeSelector:function(hash){return hash?hash.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):"";},refresh:function(){var options=this.options,lis=this.tablist.children(":has(a[href])");options.disabled=$.map(lis.filter(".ui-state-disabled"),function(tab){return lis.index(tab);});this._processTabs();if(options.active===false||!this.anchors.length){options.active=false;this.active=$();}else if(this.active.length&&!$.contains(this.tablist[0],this.active[0])){if(this.tabs.length===options.disabled.length){options.active=false;this.active=$();}else{this._activate(this._findNextTab(Math.max(0,options.active-1),false));}}else{options.active=this.tabs.index(this.active);}
this._refresh();},_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"});if(!this.active.length){this.tabs.eq(0).attr("tabIndex",0);}else{this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"});}},_processTabs:function(){var that=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(event){if($(this).is(".ui-state-disabled")){event.preventDefault();}}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){if($(this).closest("li").is(".ui-state-disabled")){this.blur();}});this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return $("a",this)[0];}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=$();this.anchors.each(function(i,anchor){var selector,panel,panelId,anchorId=$(anchor).uniqueId().attr("id"),tab=$(anchor).closest("li"),originalAriaControls=tab.attr("aria-controls");if(that._isLocal(anchor)){selector=anchor.hash;panelId=selector.substring(1);panel=that.element.find(that._sanitizeSelector(selector));}else{panelId=tab.attr("aria-controls")||$({}).uniqueId()[0].id;selector="#"+panelId;panel=that.element.find(selector);if(!panel.length){panel=that._createPanel(panelId);panel.insertAfter(that.panels[i-1]||that.tablist);}
panel.attr("aria-live","polite");}
if(panel.length){that.panels=that.panels.add(panel);}
if(originalAriaControls){tab.data("ui-tabs-aria-controls",originalAriaControls);}
tab.attr({"aria-controls":panelId,"aria-labelledby":anchorId});panel.attr("aria-labelledby",anchorId);});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel");},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0);},_createPanel:function(id){return $("<div>").attr("id",id).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",true);},_setupDisabled:function(disabled){if($.isArray(disabled)){if(!disabled.length){disabled=false;}else if(disabled.length===this.anchors.length){disabled=true;}}
for(var i=0,li;(li=this.tabs[i]);i++){if(disabled===true||$.inArray(i,disabled)!==-1){$(li).addClass("ui-state-disabled").attr("aria-disabled","true");}else{$(li).removeClass("ui-state-disabled").removeAttr("aria-disabled");}}
this.options.disabled=disabled;},_setupEvents:function(event){var events={};if(event){$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler";});}
this._off(this.anchors.add(this.tabs).add(this.panels));this._on(true,this.anchors,{click:function(event){event.preventDefault();}});this._on(this.anchors,events);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs);},_setupHeightStyle:function(heightStyle){var maxHeight,parent=this.element.parent();if(heightStyle==="fill"){maxHeight=parent.height();maxHeight-=this.element.outerHeight()-this.element.height();this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");if(position==="absolute"||position==="fixed"){return;}
maxHeight-=elem.outerHeight(true);});this.element.children().not(this.panels).each(function(){maxHeight-=$(this).outerHeight(true);});this.panels.each(function(){$(this).height(Math.max(0,maxHeight-
$(this).innerHeight()+$(this).height()));}).css("overflow","auto");}else if(heightStyle==="auto"){maxHeight=0;this.panels.each(function(){maxHeight=Math.max(maxHeight,$(this).height("").height());}).height(maxHeight);}},_eventHandler:function(event){var options=this.options,active=this.active,anchor=$(event.currentTarget),tab=anchor.closest("li"),clickedIsActive=tab[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():this._getPanelForTab(tab),toHide=!active.length?$():this._getPanelForTab(active),eventData={oldTab:active,oldPanel:toHide,newTab:collapsing?$():tab,newPanel:toShow};event.preventDefault();if(tab.hasClass("ui-state-disabled")||tab.hasClass("ui-tabs-loading")||this.running||(clickedIsActive&&!options.collapsible)||(this._trigger("beforeActivate",event,eventData)===false)){return;}
options.active=collapsing?false:this.tabs.index(tab);this.active=clickedIsActive?$():tab;if(this.xhr){this.xhr.abort();}
if(!toHide.length&&!toShow.length){$.error("jQuery UI Tabs: Mismatching fragment identifier.");}
if(toShow.length){this.load(this.tabs.index(tab),event);}
this._toggle(event,eventData);},_toggle:function(event,eventData){var that=this,toShow=eventData.newPanel,toHide=eventData.oldPanel;this.running=true;function complete(){that.running=false;that._trigger("activate",event,eventData);}
function show(){eventData.newTab.closest("li").addClass("ui-tabs-active ui-state-active");if(toShow.length&&that.options.show){that._show(toShow,that.options.show,complete);}else{toShow.show();complete();}}
if(toHide.length&&this.options.hide){this._hide(toHide,this.options.hide,function(){eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");show();});}else{eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");toHide.hide();show();}
toHide.attr("aria-hidden","true");eventData.oldTab.attr({"aria-selected":"false","aria-expanded":"false"});if(toShow.length&&toHide.length){eventData.oldTab.attr("tabIndex",-1);}else if(toShow.length){this.tabs.filter(function(){return $(this).attr("tabIndex")===0;}).attr("tabIndex",-1);}
toShow.attr("aria-hidden","false");eventData.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});},_activate:function(index){var anchor,active=this._findActive(index);if(active[0]===this.active[0]){return;}
if(!active.length){active=this.active;}
anchor=active.find(".ui-tabs-anchor")[0];this._eventHandler({target:anchor,currentTarget:anchor,preventDefault:$.noop});},_findActive:function(index){return index===false?$():this.tabs.eq(index);},_getIndex:function(index){if(typeof index==="string"){index=this.anchors.index(this.anchors.filter("[href$='"+index+"']"));}
return index;},_destroy:function(){if(this.xhr){this.xhr.abort();}
this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId();this.tablist.unbind(this.eventNamespace);this.tabs.add(this.panels).each(function(){if($.data(this,"ui-tabs-destroy")){$(this).remove();}else{$(this).removeClass("ui-state-default ui-state-active ui-state-disabled "+"ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role");}});this.tabs.each(function(){var li=$(this),prev=li.data("ui-tabs-aria-controls");if(prev){li.attr("aria-controls",prev).removeData("ui-tabs-aria-controls");}else{li.removeAttr("aria-controls");}});this.panels.show();if(this.options.heightStyle!=="content"){this.panels.css("height","");}},enable:function(index){var disabled=this.options.disabled;if(disabled===false){return;}
if(index===undefined){disabled=false;}else{index=this._getIndex(index);if($.isArray(disabled)){disabled=$.map(disabled,function(num){return num!==index?num:null;});}else{disabled=$.map(this.tabs,function(li,num){return num!==index?num:null;});}}
this._setupDisabled(disabled);},disable:function(index){var disabled=this.options.disabled;if(disabled===true){return;}
if(index===undefined){disabled=true;}else{index=this._getIndex(index);if($.inArray(index,disabled)!==-1){return;}
if($.isArray(disabled)){disabled=$.merge([index],disabled).sort();}else{disabled=[index];}}
this._setupDisabled(disabled);},load:function(index,event){index=this._getIndex(index);var that=this,tab=this.tabs.eq(index),anchor=tab.find(".ui-tabs-anchor"),panel=this._getPanelForTab(tab),eventData={tab:tab,panel:panel};if(this._isLocal(anchor[0])){return;}
this.xhr=$.ajax(this._ajaxSettings(anchor,event,eventData));if(this.xhr&&this.xhr.statusText!=="canceled"){tab.addClass("ui-tabs-loading");panel.attr("aria-busy","true");this.xhr.success(function(response){setTimeout(function(){panel.html(response);that._trigger("load",event,eventData);},1);}).complete(function(jqXHR,status){setTimeout(function(){if(status==="abort"){that.panels.stop(false,true);}
tab.removeClass("ui-tabs-loading");panel.removeAttr("aria-busy");if(jqXHR===that.xhr){delete that.xhr;}},1);});}},_ajaxSettings:function(anchor,event,eventData){var that=this;return{url:anchor.attr("href"),beforeSend:function(jqXHR,settings){return that._trigger("beforeLoad",event,$.extend({jqXHR:jqXHR,ajaxSettings:settings},eventData));}};},_getPanelForTab:function(tab){var id=$(tab).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+id));}});/*!
	 * jQuery UI Effects 1.11.1
	 * http://jqueryui.com
	 *
	 * Copyright 2014 jQuery Foundation and other contributors
	 * Released under the MIT license.
	 * http://jquery.org/license
	 *
	 * http://api.jqueryui.com/category/effects-core/
	 */
var dataSpace="ui-effects-",jQuery=$;$.effects={effect:{}};/*!
	 * jQuery Color Animations v2.1.2
	 * https://github.com/jquery/jquery-color
	 *
	 * Copyright 2014 jQuery Foundation and other contributors
	 * Released under the MIT license.
	 * http://jquery.org/license
	 *
	 * Date: Wed Jan 16 08:47:09 2013 -0600
	 */
(function(jQuery,undefined){var stepHooks="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",rplusequals=/^([\-+])=\s*(\d+\.?\d*)/,stringParsers=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]];}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1]*2.55,execResult[2]*2.55,execResult[3]*2.55,execResult[4]];}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16)];}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16)];}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(execResult){return[execResult[1],execResult[2]/ 100,execResult[3]/ 100,execResult[4]];}}],color=jQuery.Color=function(color,green,blue,alpha){return new jQuery.Color.fn.parse(color,green,blue,alpha);},spaces={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},propTypes={"byte":{floor:true,max:255},"percent":{max:1},"degrees":{mod:360,floor:true}},support=color.support={},supportElem=jQuery("<p>")[0],colors,each=jQuery.each;supportElem.style.cssText="background-color:rgba(1,1,1,.5)";support.rgba=supportElem.style.backgroundColor.indexOf("rgba")>-1;each(spaces,function(spaceName,space){space.cache="_"+spaceName;space.props.alpha={idx:3,type:"percent",def:1};});function clamp(value,prop,allowEmpty){var type=propTypes[prop.type]||{};if(value==null){return(allowEmpty||!prop.def)?null:prop.def;}
value=type.floor?~~value:parseFloat(value);if(isNaN(value)){return prop.def;}
if(type.mod){return(value+type.mod)%type.mod;}
return 0>value?0:type.max<value?type.max:value;}
function stringParse(string){var inst=color(),rgba=inst._rgba=[];string=string.toLowerCase();each(stringParsers,function(i,parser){var parsed,match=parser.re.exec(string),values=match&&parser.parse(match),spaceName=parser.space||"rgba";if(values){parsed=inst[spaceName](values);inst[spaces[spaceName].cache]=parsed[spaces[spaceName].cache];rgba=inst._rgba=parsed._rgba;return false;}});if(rgba.length){if(rgba.join()==="0,0,0,0"){jQuery.extend(rgba,colors.transparent);}
return inst;}
return colors[string];}
color.fn=jQuery.extend(color.prototype,{parse:function(red,green,blue,alpha){if(red===undefined){this._rgba=[null,null,null,null];return this;}
if(red.jquery||red.nodeType){red=jQuery(red).css(green);green=undefined;}
var inst=this,type=jQuery.type(red),rgba=this._rgba=[];if(green!==undefined){red=[red,green,blue,alpha];type="array";}
if(type==="string"){return this.parse(stringParse(red)||colors._default);}
if(type==="array"){each(spaces.rgba.props,function(key,prop){rgba[prop.idx]=clamp(red[prop.idx],prop);});return this;}
if(type==="object"){if(red instanceof color){each(spaces,function(spaceName,space){if(red[space.cache]){inst[space.cache]=red[space.cache].slice();}});}else{each(spaces,function(spaceName,space){var cache=space.cache;each(space.props,function(key,prop){if(!inst[cache]&&space.to){if(key==="alpha"||red[key]==null){return;}
inst[cache]=space.to(inst._rgba);}
inst[cache][prop.idx]=clamp(red[key],prop,true);});if(inst[cache]&&jQuery.inArray(null,inst[cache].slice(0,3))<0){inst[cache][3]=1;if(space.from){inst._rgba=space.from(inst[cache]);}}});}
return this;}},is:function(compare){var is=color(compare),same=true,inst=this;each(spaces,function(_,space){var localCache,isCache=is[space.cache];if(isCache){localCache=inst[space.cache]||space.to&&space.to(inst._rgba)||[];each(space.props,function(_,prop){if(isCache[prop.idx]!=null){same=(isCache[prop.idx]===localCache[prop.idx]);return same;}});}
return same;});return same;},_space:function(){var used=[],inst=this;each(spaces,function(spaceName,space){if(inst[space.cache]){used.push(spaceName);}});return used.pop();},transition:function(other,distance){var end=color(other),spaceName=end._space(),space=spaces[spaceName],startColor=this.alpha()===0?color("transparent"):this,start=startColor[space.cache]||space.to(startColor._rgba),result=start.slice();end=end[space.cache];each(space.props,function(key,prop){var index=prop.idx,startValue=start[index],endValue=end[index],type=propTypes[prop.type]||{};if(endValue===null){return;}
if(startValue===null){result[index]=endValue;}else{if(type.mod){if(endValue-startValue>type.mod / 2){startValue+=type.mod;}else if(startValue-endValue>type.mod / 2){startValue-=type.mod;}}
result[index]=clamp((endValue-startValue)*distance+startValue,prop);}});return this[spaceName](result);},blend:function(opaque){if(this._rgba[3]===1){return this;}
var rgb=this._rgba.slice(),a=rgb.pop(),blend=color(opaque)._rgba;return color(jQuery.map(rgb,function(v,i){return(1-a)*blend[i]+a*v;}));},toRgbaString:function(){var prefix="rgba(",rgba=jQuery.map(this._rgba,function(v,i){return v==null?(i>2?1:0):v;});if(rgba[3]===1){rgba.pop();prefix="rgb(";}
return prefix+rgba.join()+")";},toHslaString:function(){var prefix="hsla(",hsla=jQuery.map(this.hsla(),function(v,i){if(v==null){v=i>2?1:0;}
if(i&&i<3){v=Math.round(v*100)+"%";}
return v;});if(hsla[3]===1){hsla.pop();prefix="hsl(";}
return prefix+hsla.join()+")";},toHexString:function(includeAlpha){var rgba=this._rgba.slice(),alpha=rgba.pop();if(includeAlpha){rgba.push(~~(alpha*255));}
return"#"+jQuery.map(rgba,function(v){v=(v||0).toString(16);return v.length===1?"0"+v:v;}).join("");},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString();}});color.fn.parse.prototype=color.fn;function hue2rgb(p,q,h){h=(h+1)%1;if(h*6<1){return p+(q-p)*h*6;}
if(h*2<1){return q;}
if(h*3<2){return p+(q-p)*((2 / 3)-h)*6;}
return p;}
spaces.hsla.to=function(rgba){if(rgba[0]==null||rgba[1]==null||rgba[2]==null){return[null,null,null,rgba[3]];}
var r=rgba[0]/ 255,g=rgba[1]/ 255,b=rgba[2]/ 255,a=rgba[3],max=Math.max(r,g,b),min=Math.min(r,g,b),diff=max-min,add=max+min,l=add*0.5,h,s;if(min===max){h=0;}else if(r===max){h=(60*(g-b)/ diff)+360;}else if(g===max){h=(60*(b-r)/ diff)+120;}else{h=(60*(r-g)/ diff)+240;}
if(diff===0){s=0;}else if(l<=0.5){s=diff / add;}else{s=diff /(2-add);}
return[Math.round(h)%360,s,l,a==null?1:a];};spaces.hsla.from=function(hsla){if(hsla[0]==null||hsla[1]==null||hsla[2]==null){return[null,null,null,hsla[3]];}
var h=hsla[0]/ 360,s=hsla[1],l=hsla[2],a=hsla[3],q=l<=0.5?l*(1+s):l+s-l*s,p=2*l-q;return[Math.round(hue2rgb(p,q,h+(1 / 3))*255),Math.round(hue2rgb(p,q,h)*255),Math.round(hue2rgb(p,q,h-(1 / 3))*255),a];};each(spaces,function(spaceName,space){var props=space.props,cache=space.cache,to=space.to,from=space.from;color.fn[spaceName]=function(value){if(to&&!this[cache]){this[cache]=to(this._rgba);}
if(value===undefined){return this[cache].slice();}
var ret,type=jQuery.type(value),arr=(type==="array"||type==="object")?value:arguments,local=this[cache].slice();each(props,function(key,prop){var val=arr[type==="object"?key:prop.idx];if(val==null){val=local[prop.idx];}
local[prop.idx]=clamp(val,prop);});if(from){ret=color(from(local));ret[cache]=local;return ret;}else{return color(local);}};each(props,function(key,prop){if(color.fn[key]){return;}
color.fn[key]=function(value){var vtype=jQuery.type(value),fn=(key==="alpha"?(this._hsla?"hsla":"rgba"):spaceName),local=this[fn](),cur=local[prop.idx],match;if(vtype==="undefined"){return cur;}
if(vtype==="function"){value=value.call(this,cur);vtype=jQuery.type(value);}
if(value==null&&prop.empty){return this;}
if(vtype==="string"){match=rplusequals.exec(value);if(match){value=cur+parseFloat(match[2])*(match[1]==="+"?1:-1);}}
local[prop.idx]=value;return this[fn](local);};});});color.hook=function(hook){var hooks=hook.split(" ");each(hooks,function(i,hook){jQuery.cssHooks[hook]={set:function(elem,value){var parsed,curElem,backgroundColor="";if(value!=="transparent"&&(jQuery.type(value)!=="string"||(parsed=stringParse(value)))){value=color(parsed||value);if(!support.rgba&&value._rgba[3]!==1){curElem=hook==="backgroundColor"?elem.parentNode:elem;while((backgroundColor===""||backgroundColor==="transparent")&&curElem&&curElem.style){try{backgroundColor=jQuery.css(curElem,"backgroundColor");curElem=curElem.parentNode;}catch(e){}}
value=value.blend(backgroundColor&&backgroundColor!=="transparent"?backgroundColor:"_default");}
value=value.toRgbaString();}
try{elem.style[hook]=value;}catch(e){}}};jQuery.fx.step[hook]=function(fx){if(!fx.colorInit){fx.start=color(fx.elem,hook);fx.end=color(fx.end);fx.colorInit=true;}
jQuery.cssHooks[hook].set(fx.elem,fx.start.transition(fx.end,fx.pos));};});};color.hook(stepHooks);jQuery.cssHooks.borderColor={expand:function(value){var expanded={};each(["Top","Right","Bottom","Left"],function(i,part){expanded["border"+part+"Color"]=value;});return expanded;}};colors=jQuery.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"};})(jQuery);(function(){var classAnimationActions=["add","remove","toggle"],shorthandStyles={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};$.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(_,prop){$.fx.step[prop]=function(fx){if(fx.end!=="none"&&!fx.setAttr||fx.pos===1&&!fx.setAttr){jQuery.style(fx.elem,prop,fx.end);fx.setAttr=true;}};});function getElementStyles(elem){var key,len,style=elem.ownerDocument.defaultView?elem.ownerDocument.defaultView.getComputedStyle(elem,null):elem.currentStyle,styles={};if(style&&style.length&&style[0]&&style[style[0]]){len=style.length;while(len--){key=style[len];if(typeof style[key]==="string"){styles[$.camelCase(key)]=style[key];}}}else{for(key in style){if(typeof style[key]==="string"){styles[key]=style[key];}}}
return styles;}
function styleDifference(oldStyle,newStyle){var diff={},name,value;for(name in newStyle){value=newStyle[name];if(oldStyle[name]!==value){if(!shorthandStyles[name]){if($.fx.step[name]||!isNaN(parseFloat(value))){diff[name]=value;}}}}
return diff;}
if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector));};}
$.effects.animateClass=function(value,duration,easing,callback){var o=$.speed(duration,easing,callback);return this.queue(function(){var animated=$(this),baseClass=animated.attr("class")||"",applyClassChange,allAnimations=o.children?animated.find("*").addBack():animated;allAnimations=allAnimations.map(function(){var el=$(this);return{el:el,start:getElementStyles(this)};});applyClassChange=function(){$.each(classAnimationActions,function(i,action){if(value[action]){animated[action+"Class"](value[action]);}});};applyClassChange();allAnimations=allAnimations.map(function(){this.end=getElementStyles(this.el[0]);this.diff=styleDifference(this.start,this.end);return this;});animated.attr("class",baseClass);allAnimations=allAnimations.map(function(){var styleInfo=this,dfd=$.Deferred(),opts=$.extend({},o,{queue:false,complete:function(){dfd.resolve(styleInfo);}});this.el.animate(this.diff,opts);return dfd.promise();});$.when.apply($,allAnimations.get()).done(function(){applyClassChange();$.each(arguments,function(){var el=this.el;$.each(this.diff,function(key){el.css(key,"");});});o.complete.call(animated[0]);});});};$.fn.extend({addClass:(function(orig){return function(classNames,speed,easing,callback){return speed?$.effects.animateClass.call(this,{add:classNames},speed,easing,callback):orig.apply(this,arguments);};})($.fn.addClass),removeClass:(function(orig){return function(classNames,speed,easing,callback){return arguments.length>1?$.effects.animateClass.call(this,{remove:classNames},speed,easing,callback):orig.apply(this,arguments);};})($.fn.removeClass),toggleClass:(function(orig){return function(classNames,force,speed,easing,callback){if(typeof force==="boolean"||force===undefined){if(!speed){return orig.apply(this,arguments);}else{return $.effects.animateClass.call(this,(force?{add:classNames}:{remove:classNames}),speed,easing,callback);}}else{return $.effects.animateClass.call(this,{toggle:classNames},force,speed,easing);}};})($.fn.toggleClass),switchClass:function(remove,add,speed,easing,callback){return $.effects.animateClass.call(this,{add:add,remove:remove},speed,easing,callback);}});})();(function(){$.extend($.effects,{version:"1.11.1",save:function(element,set){for(var i=0;i<set.length;i++){if(set[i]!==null){element.data(dataSpace+set[i],element[0].style[set[i]]);}}},restore:function(element,set){var val,i;for(i=0;i<set.length;i++){if(set[i]!==null){val=element.data(dataSpace+set[i]);if(val===undefined){val="";}
element.css(set[i],val);}}},setMode:function(el,mode){if(mode==="toggle"){mode=el.is(":hidden")?"show":"hide";}
return mode;},getBaseline:function(origin,original){var y,x;switch(origin[0]){case"top":y=0;break;case"middle":y=0.5;break;case"bottom":y=1;break;default:y=origin[0]/ original.height;}
switch(origin[1]){case"left":x=0;break;case"center":x=0.5;break;case"right":x=1;break;default:x=origin[1]/ original.width;}
return{x:x,y:y};},createWrapper:function(element){if(element.parent().is(".ui-effects-wrapper")){return element.parent();}
var props={width:element.outerWidth(true),height:element.outerHeight(true),"float":element.css("float")},wrapper=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),size={width:element.width(),height:element.height()},active=document.activeElement;try{active.id;}catch(e){active=document.body;}
element.wrap(wrapper);if(element[0]===active||$.contains(element[0],active)){$(active).focus();}
wrapper=element.parent();if(element.css("position")==="static"){wrapper.css({position:"relative"});element.css({position:"relative"});}else{$.extend(props,{position:element.css("position"),zIndex:element.css("z-index")});$.each(["top","left","bottom","right"],function(i,pos){props[pos]=element.css(pos);if(isNaN(parseInt(props[pos],10))){props[pos]="auto";}});element.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"});}
element.css(size);return wrapper.css(props).show();},removeWrapper:function(element){var active=document.activeElement;if(element.parent().is(".ui-effects-wrapper")){element.parent().replaceWith(element);if(element[0]===active||$.contains(element[0],active)){$(active).focus();}}
return element;},setTransition:function(element,list,factor,value){value=value||{};$.each(list,function(i,x){var unit=element.cssUnit(x);if(unit[0]>0){value[x]=unit[0]*factor+unit[1];}});return value;}});function _normalizeArguments(effect,options,speed,callback){if($.isPlainObject(effect)){options=effect;effect=effect.effect;}
effect={effect:effect};if(options==null){options={};}
if($.isFunction(options)){callback=options;speed=null;options={};}
if(typeof options==="number"||$.fx.speeds[options]){callback=speed;speed=options;options={};}
if($.isFunction(speed)){callback=speed;speed=null;}
if(options){$.extend(effect,options);}
speed=speed||options.duration;effect.duration=$.fx.off?0:typeof speed==="number"?speed:speed in $.fx.speeds?$.fx.speeds[speed]:$.fx.speeds._default;effect.complete=callback||options.complete;return effect;}
function standardAnimationOption(option){if(!option||typeof option==="number"||$.fx.speeds[option]){return true;}
if(typeof option==="string"&&!$.effects.effect[option]){return true;}
if($.isFunction(option)){return true;}
if(typeof option==="object"&&!option.effect){return true;}
return false;}
$.fn.extend({effect:function(){var args=_normalizeArguments.apply(this,arguments),mode=args.mode,queue=args.queue,effectMethod=$.effects.effect[args.effect];if($.fx.off||!effectMethod){if(mode){return this[mode](args.duration,args.complete);}else{return this.each(function(){if(args.complete){args.complete.call(this);}});}}
function run(next){var elem=$(this),complete=args.complete,mode=args.mode;function done(){if($.isFunction(complete)){complete.call(elem[0]);}
if($.isFunction(next)){next();}}
if(elem.is(":hidden")?mode==="hide":mode==="show"){elem[mode]();done();}else{effectMethod.call(elem[0],args,done);}}
return queue===false?this.each(run):this.queue(queue||"fx",run);},show:(function(orig){return function(option){if(standardAnimationOption(option)){return orig.apply(this,arguments);}else{var args=_normalizeArguments.apply(this,arguments);args.mode="show";return this.effect.call(this,args);}};})($.fn.show),hide:(function(orig){return function(option){if(standardAnimationOption(option)){return orig.apply(this,arguments);}else{var args=_normalizeArguments.apply(this,arguments);args.mode="hide";return this.effect.call(this,args);}};})($.fn.hide),toggle:(function(orig){return function(option){if(standardAnimationOption(option)||typeof option==="boolean"){return orig.apply(this,arguments);}else{var args=_normalizeArguments.apply(this,arguments);args.mode="toggle";return this.effect.call(this,args);}};})($.fn.toggle),cssUnit:function(key){var style=this.css(key),val=[];$.each(["em","px","%","pt"],function(i,unit){if(style.indexOf(unit)>0){val=[parseFloat(style),unit];}});return val;}});})();(function(){var baseEasings={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(i,name){baseEasings[name]=function(p){return Math.pow(p,i+2);};});$.extend(baseEasings,{Sine:function(p){return 1-Math.cos(p*Math.PI / 2);},Circ:function(p){return 1-Math.sqrt(1-p*p);},Elastic:function(p){return p===0||p===1?p:-Math.pow(2,8*(p-1))*Math.sin(((p-1)*80-7.5)*Math.PI / 15);},Back:function(p){return p*p*(3*p-2);},Bounce:function(p){var pow2,bounce=4;while(p<((pow2=Math.pow(2,--bounce))-1)/ 11){}
return 1 / Math.pow(4,3-bounce)-7.5625*Math.pow((pow2*3-2)/ 22-p,2);}});$.each(baseEasings,function(name,easeIn){$.easing["easeIn"+name]=easeIn;$.easing["easeOut"+name]=function(p){return 1-easeIn(1-p);};$.easing["easeInOut"+name]=function(p){return p<0.5?easeIn(p*2)/ 2:1-easeIn(p*-2+2)/ 2;};});})();var effect=$.effects;}));/*!
 * jQuery Cookie Plugin v1.4.0
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else if(typeof exports==='object'){factory(require('jquery'));}else{factory(jQuery);}}(function($){var pluses=/\+/g;function encode(s){return config.raw?s:encodeURIComponent(s);}
function decode(s){return config.raw?s:decodeURIComponent(s);}
function stringifyCookieValue(value){return encode(config.json?JSON.stringify(value):String(value));}
function parseCookieValue(s){if(s.indexOf('"')===0){s=s.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,'\\');}
try{s=decodeURIComponent(s.replace(pluses,' '));return config.json?JSON.parse(s):s;}catch(e){}}
function read(s,converter){var value=config.raw?s:parseCookieValue(s);return $.isFunction(converter)?converter(value):value;}
var config=$.cookie=function(key,value,options){if(value!==undefined&&!$.isFunction(value)){options=$.extend({},config.defaults,options);if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setTime(+t+days*864e+5);}
return(document.cookie=[encode(key),'=',stringifyCookieValue(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}
var result=key?undefined:{};var cookies=document.cookie?document.cookie.split('; '):[];for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split('=');var name=decode(parts.shift());var cookie=parts.join('=');if(key&&key===name){result=read(cookie,value);break;}
if(!key&&(cookie=read(cookie))!==undefined){result[name]=cookie;}}
return result;};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)===undefined){return false;}
$.cookie(key,'',$.extend({},options,{expires:-1}));return!$.cookie(key);};}));(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var
push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var
nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj;};if(typeof exports!=='undefined'){if(typeof module!=='undefined'&&module.exports){exports=module.exports=_;}
exports._=_;}else{root._=_;}
_.VERSION='1.5.2';var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null)return;if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context);}else if(obj.length===+obj.length){for(var i=0,length=obj.length;i<length;i++){if(iterator.call(context,obj[i],i,obj)===breaker)return;}}else{var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){if(iterator.call(context,obj[keys[i]],keys[i],obj)===breaker)return;}}};_.map=_.collect=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeMap&&obj.map===nativeMap)return obj.map(iterator,context);each(obj,function(value,index,list){results.push(iterator.call(context,value,index,list));});return results;};var reduceError='Reduce of empty array with no initial value';_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduce&&obj.reduce===nativeReduce){if(context)iterator=_.bind(iterator,context);return initial?obj.reduce(iterator,memo):obj.reduce(iterator);}
each(obj,function(value,index,list){if(!initial){memo=value;initial=true;}else{memo=iterator.call(context,memo,value,index,list);}});if(!initial)throw new TypeError(reduceError);return memo;};_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null)obj=[];if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context)iterator=_.bind(iterator,context);return initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);}
var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length;}
each(obj,function(value,index,list){index=keys?keys[--length]:--length;if(!initial){memo=obj[index];initial=true;}else{memo=iterator.call(context,memo,obj[index],index,list);}});if(!initial)throw new TypeError(reduceError);return memo;};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true;}});return result;};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null)return results;if(nativeFilter&&obj.filter===nativeFilter)return obj.filter(iterator,context);each(obj,function(value,index,list){if(iterator.call(context,value,index,list))results.push(value);});return results;};_.reject=function(obj,iterator,context){return _.filter(obj,function(value,index,list){return!iterator.call(context,value,index,list);},context);};_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=true;if(obj==null)return result;if(nativeEvery&&obj.every===nativeEvery)return obj.every(iterator,context);each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list)))return breaker;});return!!result;};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=false;if(obj==null)return result;if(nativeSome&&obj.some===nativeSome)return obj.some(iterator,context);each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list)))return breaker;});return!!result;};_.contains=_.include=function(obj,target){if(obj==null)return false;if(nativeIndexOf&&obj.indexOf===nativeIndexOf)return obj.indexOf(target)!=-1;return any(obj,function(value){return value===target;});};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args);});};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key];});};_.where=function(obj,attrs,first){if(_.isEmpty(attrs))return first?void 0:[];return _[first?'find':'filter'](obj,function(value){for(var key in attrs){if(attrs[key]!==value[key])return false;}
return true;});};_.findWhere=function(obj,attrs){return _.where(obj,attrs,true);};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.max.apply(Math,obj);}
if(!iterator&&_.isEmpty(obj))return-Infinity;var result={computed:-Infinity,value:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>result.computed&&(result={value:value,computed:computed});});return result.value;};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.min.apply(Math,obj);}
if(!iterator&&_.isEmpty(obj))return Infinity;var result={computed:Infinity,value:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed});});return result.value;};_.shuffle=function(obj){var rand;var index=0;var shuffled=[];each(obj,function(value){rand=_.random(index++);shuffled[index-1]=shuffled[rand];shuffled[rand]=value;});return shuffled;};_.sample=function(obj,n,guard){if(arguments.length<2||guard){return obj[_.random(obj.length-1)];}
return _.shuffle(obj).slice(0,Math.max(0,n));};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value];};};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)};}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1;}
return left.index-right.index;}),'value');};var group=function(behavior){return function(obj,value,context){var result={};var iterator=value==null?_.identity:lookupIterator(value);each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value);});return result;};};_.groupBy=group(function(result,key,value){(_.has(result,key)?result[key]:(result[key]=[])).push(value);});_.indexBy=group(function(result,key,value){result[key]=value;});_.countBy=group(function(result,key){_.has(result,key)?result[key]++:result[key]=1;});_.sortedIndex=function(array,obj,iterator,context){iterator=iterator==null?_.identity:lookupIterator(iterator);var value=iterator.call(context,obj);var low=0,high=array.length;while(low<high){var mid=(low+high)>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid;}
return low;};_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(obj.length===+obj.length)return _.map(obj,_.identity);return _.values(obj);};_.size=function(obj){if(obj==null)return 0;return(obj.length===+obj.length)?obj.length:_.keys(obj).length;};_.first=_.head=_.take=function(array,n,guard){if(array==null)return void 0;return(n==null)||guard?array[0]:slice.call(array,0,n);};_.initial=function(array,n,guard){return slice.call(array,0,array.length-((n==null)||guard?1:n));};_.last=function(array,n,guard){if(array==null)return void 0;if((n==null)||guard){return array[array.length-1];}else{return slice.call(array,Math.max(array.length-n,0));}};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,(n==null)||guard?1:n);};_.compact=function(array){return _.filter(array,_.identity);};var flatten=function(input,shallow,output){if(shallow&&_.every(input,_.isArray)){return concat.apply(output,input);}
each(input,function(value){if(_.isArray(value)||_.isArguments(value)){shallow?push.apply(output,value):flatten(value,shallow,output);}else{output.push(value);}});return output;};_.flatten=function(array,shallow){return flatten(array,shallow,[]);};_.without=function(array){return _.difference(array,slice.call(arguments,1));};_.uniq=_.unique=function(array,isSorted,iterator,context){if(_.isFunction(isSorted)){context=iterator;iterator=isSorted;isSorted=false;}
var initial=iterator?_.map(array,iterator,context):array;var results=[];var seen=[];each(initial,function(value,index){if(isSorted?(!index||seen[seen.length-1]!==value):!_.contains(seen,value)){seen.push(value);results.push(array[index]);}});return results;};_.union=function(){return _.uniq(_.flatten(arguments,true));};_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0;});});};_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value);});};_.zip=function(){var length=_.max(_.pluck(arguments,"length").concat(0));var results=new Array(length);for(var i=0;i<length;i++){results[i]=_.pluck(arguments,''+i);}
return results;};_.object=function(list,values){if(list==null)return{};var result={};for(var i=0,length=list.length;i<length;i++){if(values){result[list[i]]=values[i];}else{result[list[i][0]]=list[i][1];}}
return result;};_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i=0,length=array.length;if(isSorted){if(typeof isSorted=='number'){i=(isSorted<0?Math.max(0,length+isSorted):isSorted);}else{i=_.sortedIndex(array,item);return array[i]===item?i:-1;}}
if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;i<length;i++)if(array[i]===item)return i;return-1;};_.lastIndexOf=function(array,item,from){if(array==null)return-1;var hasIndex=from!=null;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf){return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item);}
var i=(hasIndex?from:array.length);while(i--)if(array[i]===item)return i;return-1;};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0;}
step=arguments[2]||1;var length=Math.max(Math.ceil((stop-start)/ step),0);var idx=0;var range=new Array(length);while(idx<length){range[idx++]=start;start+=step;}
return range;};var ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;args=slice.call(arguments,2);return bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor;ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result)return result;return self;};};_.partial=function(func){var args=slice.call(arguments,1);return function(){return func.apply(this,args.concat(slice.call(arguments)));};};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length===0)throw new Error("bindAll must be passed function names");each(funcs,function(f){obj[f]=_.bind(obj[f],obj);});return obj;};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:(memo[key]=func.apply(this,arguments));};};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args);},wait);};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)));};_.throttle=function(func,wait,options){var context,args,result;var timeout=null;var previous=0;options||(options={});var later=function(){previous=options.leading===false?0:new Date;timeout=null;result=func.apply(context,args);};return function(){var now=new Date;if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args);}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining);}
return result;};};_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result;return function(){context=this;args=arguments;timestamp=new Date();var later=function(){var last=(new Date())-timestamp;if(last<wait){timeout=setTimeout(later,wait-last);}else{timeout=null;if(!immediate)result=func.apply(context,args);}};var callNow=immediate&&!timeout;if(!timeout){timeout=setTimeout(later,wait);}
if(callNow)result=func.apply(context,args);return result;};};_.once=function(func){var ran=false,memo;return function(){if(ran)return memo;ran=true;memo=func.apply(this,arguments);func=null;return memo;};};_.wrap=function(func,wrapper){return function(){var args=[func];push.apply(args,arguments);return wrapper.apply(this,args);};};_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)];}
return args[0];};};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments);}};};_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError('Invalid object');var keys=[];for(var key in obj)if(_.has(obj,key))keys.push(key);return keys;};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=new Array(length);for(var i=0;i<length;i++){values[i]=obj[keys[i]];}
return values;};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=new Array(length);for(var i=0;i<length;i++){pairs[i]=[keys[i],obj[keys[i]]];}
return pairs;};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i];}
return result;};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key);}
return names.sort();};_.extend=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){obj[prop]=source[prop];}}});return obj;};_.pick=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));each(keys,function(key){if(key in obj)copy[key]=obj[key];});return copy;};_.omit=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj){if(!_.contains(keys,key))copy[key]=obj[key];}
return copy;};_.defaults=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){if(obj[prop]===void 0)obj[prop]=source[prop];}}});return obj;};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj);};_.tap=function(obj,interceptor){interceptor(obj);return obj;};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1 / a==1 / b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!=toString.call(b))return false;switch(className){case'[object String]':return a==String(b);case'[object Number]':return a!=+a?b!=+b:(a==0?1 / a==1 / b:a==+b);case'[object Date]':case'[object Boolean]':return+a==+b;case'[object RegExp]':return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase;}
if(typeof a!='object'||typeof b!='object')return false;var length=aStack.length;while(length--){if(aStack[length]==a)return bStack[length]==b;}
var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&(aCtor instanceof aCtor)&&_.isFunction(bCtor)&&(bCtor instanceof bCtor))){return false;}
aStack.push(a);bStack.push(b);var size=0,result=true;if(className=='[object Array]'){size=a.length;result=size==b.length;if(result){while(size--){if(!(result=eq(a[size],b[size],aStack,bStack)))break;}}}else{for(var key in a){if(_.has(a,key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))break;}}
if(result){for(key in b){if(_.has(b,key)&&!(size--))break;}
result=!size;}}
aStack.pop();bStack.pop();return result;};_.isEqual=function(a,b){return eq(a,b,[],[]);};_.isEmpty=function(obj){if(obj==null)return true;if(_.isArray(obj)||_.isString(obj))return obj.length===0;for(var key in obj)if(_.has(obj,key))return false;return true;};_.isElement=function(obj){return!!(obj&&obj.nodeType===1);};_.isArray=nativeIsArray||function(obj){return toString.call(obj)=='[object Array]';};_.isObject=function(obj){return obj===Object(obj);};each(['Arguments','Function','String','Number','Date','RegExp'],function(name){_['is'+name]=function(obj){return toString.call(obj)=='[object '+name+']';};});if(!_.isArguments(arguments)){_.isArguments=function(obj){return!!(obj&&_.has(obj,'callee'));};}
if(typeof(/./)!=='function'){_.isFunction=function(obj){return typeof obj==='function';};}
_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj));};_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj;};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)=='[object Boolean]';};_.isNull=function(obj){return obj===null;};_.isUndefined=function(obj){return obj===void 0;};_.has=function(obj,key){return hasOwnProperty.call(obj,key);};_.noConflict=function(){root._=previousUnderscore;return this;};_.identity=function(value){return value;};_.times=function(n,iterator,context){var accum=Array(Math.max(0,n));for(var i=0;i<n;i++)accum[i]=iterator.call(context,i);return accum;};_.random=function(min,max){if(max==null){max=min;min=0;}
return min+Math.floor(Math.random()*(max-min+1));};var entityMap={escape:{'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#x27;'}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp('['+_.keys(entityMap.escape).join('')+']','g'),unescape:new RegExp('('+_.keys(entityMap.unescape).join('|')+')','g')};_.each(['escape','unescape'],function(method){_[method]=function(string){if(string==null)return'';return(''+string).replace(entityRegexes[method],function(match){return entityMap[method][match];});};});_.result=function(object,property){if(object==null)return void 0;var value=object[property];return _.isFunction(value)?value.call(object):value;};_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result.call(this,func.apply(_,args));};});};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+'';return prefix?prefix+id:id;};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'",'\\':'\\','\r':'r','\n':'n','\t':'t','\u2028':'u2028','\u2029':'u2029'};var escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(text,data,settings){var render;settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join('|')+'|$','g');var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,function(match){return'\\'+escapes[match];});if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'";}
if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'";}
if(evaluate){source+="';\n"+evaluate+"\n__p+='";}
index=offset+match.length;return match;});source+="';\n";if(!settings.variable)source='with(obj||{}){\n'+source+'}\n';source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+
source+"return __p;\n";try{render=new Function(settings.variable||'obj','_',source);}catch(e){e.source=source;throw e;}
if(data)return render(data,_);var template=function(data){return render.call(this,data,_);};template.source='function('+(settings.variable||'obj')+'){\n'+source+'}';return template;};_.chain=function(obj){return _(obj).chain();};var result=function(obj){return this._chain?_(obj).chain():obj;};_.mixin(_);each(['pop','push','reverse','shift','sort','splice','unshift'],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name=='shift'||name=='splice')&&obj.length===0)delete obj[0];return result.call(this,obj);};});each(['concat','join','slice'],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments));};});_.extend(_.prototype,{chain:function(){this._chain=true;return this;},value:function(){return this._wrapped;}});}).call(this);(function(){var root=this;var previousBackbone=root.Backbone;var array=[];var push=array.push;var slice=array.slice;var splice=array.splice;var Backbone;if(typeof exports!=='undefined'){Backbone=exports;}else{Backbone=root.Backbone={};}
Backbone.VERSION='1.1.0';var _=root._;if(!_&&(typeof require!=='undefined'))_=require('underscore');Backbone.$=root.jQuery||root.Zepto||root.ender||root.$;Backbone.noConflict=function(){root.Backbone=previousBackbone;return this;};Backbone.emulateHTTP=false;Backbone.emulateJSON=false;var Events=Backbone.Events={on:function(name,callback,context){if(!eventsApi(this,'on',name,[callback,context])||!callback)return this;this._events||(this._events={});var events=this._events[name]||(this._events[name]=[]);events.push({callback:callback,context:context,ctx:context||this});return this;},once:function(name,callback,context){if(!eventsApi(this,'once',name,[callback,context])||!callback)return this;var self=this;var once=_.once(function(){self.off(name,once);callback.apply(this,arguments);});once._callback=callback;return this.on(name,once,context);},off:function(name,callback,context){var retain,ev,events,names,i,l,j,k;if(!this._events||!eventsApi(this,'off',name,[callback,context]))return this;if(!name&&!callback&&!context){this._events={};return this;}
names=name?[name]:_.keys(this._events);for(i=0,l=names.length;i<l;i++){name=names[i];if(events=this._events[name]){this._events[name]=retain=[];if(callback||context){for(j=0,k=events.length;j<k;j++){ev=events[j];if((callback&&callback!==ev.callback&&callback!==ev.callback._callback)||(context&&context!==ev.context)){retain.push(ev);}}}
if(!retain.length)delete this._events[name];}}
return this;},trigger:function(name){if(!this._events)return this;var args=slice.call(arguments,1);if(!eventsApi(this,'trigger',name,args))return this;var events=this._events[name];var allEvents=this._events.all;if(events)triggerEvents(events,args);if(allEvents)triggerEvents(allEvents,arguments);return this;},stopListening:function(obj,name,callback){var listeningTo=this._listeningTo;if(!listeningTo)return this;var remove=!name&&!callback;if(!callback&&typeof name==='object')callback=this;if(obj)(listeningTo={})[obj._listenId]=obj;for(var id in listeningTo){obj=listeningTo[id];obj.off(name,callback,this);if(remove||_.isEmpty(obj._events))delete this._listeningTo[id];}
return this;}};var eventSplitter=/\s+/;var eventsApi=function(obj,action,name,rest){if(!name)return true;if(typeof name==='object'){for(var key in name){obj[action].apply(obj,[key,name[key]].concat(rest));}
return false;}
if(eventSplitter.test(name)){var names=name.split(eventSplitter);for(var i=0,l=names.length;i<l;i++){obj[action].apply(obj,[names[i]].concat(rest));}
return false;}
return true;};var triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:while(++i<l)(ev=events[i]).callback.call(ev.ctx);return;case 1:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);return;default:while(++i<l)(ev=events[i]).callback.apply(ev.ctx,args);}};var listenMethods={listenTo:'on',listenToOnce:'once'};_.each(listenMethods,function(implementation,method){Events[method]=function(obj,name,callback){var listeningTo=this._listeningTo||(this._listeningTo={});var id=obj._listenId||(obj._listenId=_.uniqueId('l'));listeningTo[id]=obj;if(!callback&&typeof name==='object')callback=this;obj[implementation](name,callback,this);return this;};});Events.bind=Events.on;Events.unbind=Events.off;_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var attrs=attributes||{};options||(options={});this.cid=_.uniqueId('c');this.attributes={};if(options.collection)this.collection=options.collection;if(options.parse)attrs=this.parse(attrs,options)||{};attrs=_.defaults({},attrs,_.result(this,'defaults'));this.set(attrs,options);this.changed={};this.initialize.apply(this,arguments);};_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:'id',initialize:function(){},toJSON:function(options){return _.clone(this.attributes);},sync:function(){return Backbone.sync.apply(this,arguments);},get:function(attr){return this.attributes[attr];},escape:function(attr){return _.escape(this.get(attr));},has:function(attr){return this.get(attr)!=null;},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,prev,current;if(key==null)return this;if(typeof key==='object'){attrs=key;options=val;}else{(attrs={})[key]=val;}
options||(options={});if(!this._validate(attrs,options))return false;unset=options.unset;silent=options.silent;changes=[];changing=this._changing;this._changing=true;if(!changing){this._previousAttributes=_.clone(this.attributes);this.changed={};}
current=this.attributes,prev=this._previousAttributes;if(this.idAttribute in attrs)this.id=attrs[this.idAttribute];for(attr in attrs){val=attrs[attr];if(!_.isEqual(current[attr],val))changes.push(attr);if(!_.isEqual(prev[attr],val)){this.changed[attr]=val;}else{delete this.changed[attr];}
unset?delete current[attr]:current[attr]=val;}
if(!silent){if(changes.length)this._pending=true;for(var i=0,l=changes.length;i<l;i++){this.trigger('change:'+changes[i],this,current[changes[i]],options);}}
if(changing)return this;if(!silent){while(this._pending){this._pending=false;this.trigger('change',this,options);}}
this._pending=false;this._changing=false;return this;},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:true}));},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:true}));},hasChanged:function(attr){if(attr==null)return!_.isEmpty(this.changed);return _.has(this.changed,attr);},changedAttributes:function(diff){if(!diff)return this.hasChanged()?_.clone(this.changed):false;var val,changed=false;var old=this._changing?this._previousAttributes:this.attributes;for(var attr in diff){if(_.isEqual(old[attr],(val=diff[attr])))continue;(changed||(changed={}))[attr]=val;}
return changed;},previous:function(attr){if(attr==null||!this._previousAttributes)return null;return this._previousAttributes[attr];},previousAttributes:function(){return _.clone(this._previousAttributes);},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var model=this;var success=options.success;options.success=function(resp){if(!model.set(model.parse(resp,options),options))return false;if(success)success(model,resp,options);model.trigger('sync',model,resp,options);};wrapError(this,options);return this.sync('read',this,options);},save:function(key,val,options){var attrs,method,xhr,attributes=this.attributes;if(key==null||typeof key==='object'){attrs=key;options=val;}else{(attrs={})[key]=val;}
options=_.extend({validate:true},options);if(attrs&&!options.wait){if(!this.set(attrs,options))return false;}else{if(!this._validate(attrs,options))return false;}
if(attrs&&options.wait){this.attributes=_.extend({},attributes,attrs);}
if(options.parse===void 0)options.parse=true;var model=this;var success=options.success;options.success=function(resp){model.attributes=attributes;var serverAttrs=model.parse(resp,options);if(options.wait)serverAttrs=_.extend(attrs||{},serverAttrs);if(_.isObject(serverAttrs)&&!model.set(serverAttrs,options)){return false;}
if(success)success(model,resp,options);model.trigger('sync',model,resp,options);};wrapError(this,options);method=this.isNew()?'create':(options.patch?'patch':'update');if(method==='patch')options.attrs=attrs;xhr=this.sync(method,this,options);if(attrs&&options.wait)this.attributes=attributes;return xhr;},destroy:function(options){options=options?_.clone(options):{};var model=this;var success=options.success;var destroy=function(){model.trigger('destroy',model,model.collection,options);};options.success=function(resp){if(options.wait||model.isNew())destroy();if(success)success(model,resp,options);if(!model.isNew())model.trigger('sync',model,resp,options);};if(this.isNew()){options.success();return false;}
wrapError(this,options);var xhr=this.sync('delete',this,options);if(!options.wait)destroy();return xhr;},url:function(){var base=_.result(this,'urlRoot')||_.result(this.collection,'url')||urlError();if(this.isNew())return base;return base+(base.charAt(base.length-1)==='/'?'':'/')+encodeURIComponent(this.id);},parse:function(resp,options){return resp;},clone:function(){return new this.constructor(this.attributes);},isNew:function(){return this.id==null;},isValid:function(options){return this._validate({},_.extend(options||{},{validate:true}));},_validate:function(attrs,options){if(!options.validate||!this.validate)return true;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;if(!error)return true;this.trigger('invalid',this,error,_.extend(options,{validationError:error}));return false;}});var modelMethods=['keys','values','pairs','invert','pick','omit'];_.each(modelMethods,function(method){Model.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.attributes);return _[method].apply(_,args);};});var Collection=Backbone.Collection=function(models,options){options||(options={});if(options.model)this.model=options.model;if(options.comparator!==void 0)this.comparator=options.comparator;this._reset();this.initialize.apply(this,arguments);if(models)this.reset(models,_.extend({silent:true},options));};var setOptions={add:true,remove:true,merge:true};var addOptions={add:true,remove:false};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options);});},sync:function(){return Backbone.sync.apply(this,arguments);},add:function(models,options){return this.set(models,_.extend({merge:false},options,addOptions));},remove:function(models,options){var singular=!_.isArray(models);models=singular?[models]:_.clone(models);options||(options={});var i,l,index,model;for(i=0,l=models.length;i<l;i++){model=models[i]=this.get(models[i]);if(!model)continue;delete this._byId[model.id];delete this._byId[model.cid];index=this.indexOf(model);this.models.splice(index,1);this.length--;if(!options.silent){options.index=index;model.trigger('remove',model,this,options);}
this._removeReference(model);}
return singular?models[0]:models;},set:function(models,options){options=_.defaults({},options,setOptions);if(options.parse)models=this.parse(models,options);var singular=!_.isArray(models);models=singular?(models?[models]:[]):_.clone(models);var i,l,id,model,attrs,existing,sort;var at=options.at;var targetModel=this.model;var sortable=this.comparator&&(at==null)&&options.sort!==false;var sortAttr=_.isString(this.comparator)?this.comparator:null;var toAdd=[],toRemove=[],modelMap={};var add=options.add,merge=options.merge,remove=options.remove;var order=!sortable&&add&&remove?[]:false;for(i=0,l=models.length;i<l;i++){attrs=models[i];if(attrs instanceof Model){id=model=attrs;}else{id=attrs[targetModel.prototype.idAttribute];}
if(existing=this.get(id)){if(remove)modelMap[existing.cid]=true;if(merge){attrs=attrs===model?model.attributes:attrs;if(options.parse)attrs=existing.parse(attrs,options);existing.set(attrs,options);if(sortable&&!sort&&existing.hasChanged(sortAttr))sort=true;}
models[i]=existing;}else if(add){model=models[i]=this._prepareModel(attrs,options);if(!model)continue;toAdd.push(model);model.on('all',this._onModelEvent,this);this._byId[model.cid]=model;if(model.id!=null)this._byId[model.id]=model;}
if(order)order.push(existing||model);}
if(remove){for(i=0,l=this.length;i<l;++i){if(!modelMap[(model=this.models[i]).cid])toRemove.push(model);}
if(toRemove.length)this.remove(toRemove,options);}
if(toAdd.length||(order&&order.length)){if(sortable)sort=true;this.length+=toAdd.length;if(at!=null){for(i=0,l=toAdd.length;i<l;i++){this.models.splice(at+i,0,toAdd[i]);}}else{if(order)this.models.length=0;var orderedModels=order||toAdd;for(i=0,l=orderedModels.length;i<l;i++){this.models.push(orderedModels[i]);}}}
if(sort)this.sort({silent:true});if(!options.silent){for(i=0,l=toAdd.length;i<l;i++){(model=toAdd[i]).trigger('add',model,this,options);}
if(sort||(order&&order.length))this.trigger('sort',this,options);}
return singular?models[0]:models;},reset:function(models,options){options||(options={});for(var i=0,l=this.models.length;i<l;i++){this._removeReference(this.models[i]);}
options.previousModels=this.models;this._reset();models=this.add(models,_.extend({silent:true},options));if(!options.silent)this.trigger('reset',this,options);return models;},push:function(model,options){return this.add(model,_.extend({at:this.length},options));},pop:function(options){var model=this.at(this.length-1);this.remove(model,options);return model;},unshift:function(model,options){return this.add(model,_.extend({at:0},options));},shift:function(options){var model=this.at(0);this.remove(model,options);return model;},slice:function(){return slice.apply(this.models,arguments);},get:function(obj){if(obj==null)return void 0;return this._byId[obj.id]||this._byId[obj.cid]||this._byId[obj];},at:function(index){return this.models[index];},where:function(attrs,first){if(_.isEmpty(attrs))return first?void 0:[];return this[first?'find':'filter'](function(model){for(var key in attrs){if(attrs[key]!==model.get(key))return false;}
return true;});},findWhere:function(attrs){return this.where(attrs,true);},sort:function(options){if(!this.comparator)throw new Error('Cannot sort a set without a comparator');options||(options={});if(_.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this);}else{this.models.sort(_.bind(this.comparator,this));}
if(!options.silent)this.trigger('sort',this,options);return this;},pluck:function(attr){return _.invoke(this.models,'get',attr);},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var success=options.success;var collection=this;options.success=function(resp){var method=options.reset?'reset':'set';collection[method](resp,options);if(success)success(collection,resp,options);collection.trigger('sync',collection,resp,options);};wrapError(this,options);return this.sync('read',this,options);},create:function(model,options){options=options?_.clone(options):{};if(!(model=this._prepareModel(model,options)))return false;if(!options.wait)this.add(model,options);var collection=this;var success=options.success;options.success=function(model,resp,options){if(options.wait)collection.add(model,options);if(success)success(model,resp,options);};model.save(null,options);return model;},parse:function(resp,options){return resp;},clone:function(){return new this.constructor(this.models);},_reset:function(){this.length=0;this.models=[];this._byId={};},_prepareModel:function(attrs,options){if(attrs instanceof Model){if(!attrs.collection)attrs.collection=this;return attrs;}
options=options?_.clone(options):{};options.collection=this;var model=new this.model(attrs,options);if(!model.validationError)return model;this.trigger('invalid',this,model.validationError,options);return false;},_removeReference:function(model){if(this===model.collection)delete model.collection;model.off('all',this._onModelEvent,this);},_onModelEvent:function(event,model,collection,options){if((event==='add'||event==='remove')&&collection!==this)return;if(event==='destroy')this.remove(model,options);if(model&&event==='change:'+model.idAttribute){delete this._byId[model.previous(model.idAttribute)];if(model.id!=null)this._byId[model.id]=model;}
this.trigger.apply(this,arguments);}});var methods=['forEach','each','map','collect','reduce','foldl','inject','reduceRight','foldr','find','detect','filter','select','reject','every','all','some','any','include','contains','invoke','max','min','toArray','size','first','head','take','initial','rest','tail','drop','last','without','difference','indexOf','shuffle','lastIndexOf','isEmpty','chain'];_.each(methods,function(method){Collection.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.models);return _[method].apply(_,args);};});var attributeMethods=['groupBy','countBy','sortBy'];_.each(attributeMethods,function(method){Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value);};return _[method](this.models,iterator,context);};});var View=Backbone.View=function(options){this.cid=_.uniqueId('view');options||(options={});_.extend(this,_.pick(options,viewOptions));this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents();};var delegateEventSplitter=/^(\S+)\s*(.*)$/;var viewOptions=['model','collection','el','id','attributes','className','tagName','events'];_.extend(View.prototype,Events,{tagName:'div',$:function(selector){return this.$el.find(selector);},initialize:function(){},render:function(){return this;},remove:function(){this.$el.remove();this.stopListening();return this;},setElement:function(element,delegate){if(this.$el)this.undelegateEvents();this.$el=element instanceof Backbone.$?element:Backbone.$(element);this.el=this.$el[0];if(delegate!==false)this.delegateEvents();return this;},delegateEvents:function(events){if(!(events||(events=_.result(this,'events'))))return this;this.undelegateEvents();for(var key in events){var method=events[key];if(!_.isFunction(method))method=this[events[key]];if(!method)continue;var match=key.match(delegateEventSplitter);var eventName=match[1],selector=match[2];method=_.bind(method,this);eventName+='.delegateEvents'+this.cid;if(selector===''){this.$el.on(eventName,method);}else{this.$el.on(eventName,selector,method);}}
return this;},undelegateEvents:function(){this.$el.off('.delegateEvents'+this.cid);return this;},_ensureElement:function(){if(!this.el){var attrs=_.extend({},_.result(this,'attributes'));if(this.id)attrs.id=_.result(this,'id');if(this.className)attrs['class']=_.result(this,'className');var $el=Backbone.$('<'+_.result(this,'tagName')+'>').attr(attrs);this.setElement($el,false);}else{this.setElement(_.result(this,'el'),false);}}});Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:'json'};if(!options.url){params.url=_.result(model,'url')||urlError();}
if(options.data==null&&model&&(method==='create'||method==='update'||method==='patch')){params.contentType='application/json';params.data=JSON.stringify(options.attrs||model.toJSON(options));}
if(options.emulateJSON){params.contentType='application/x-www-form-urlencoded';params.data=params.data?{model:params.data}:{};}
if(options.emulateHTTP&&(type==='PUT'||type==='DELETE'||type==='PATCH')){params.type='POST';if(options.emulateJSON)params.data._method=type;var beforeSend=options.beforeSend;options.beforeSend=function(xhr){xhr.setRequestHeader('X-HTTP-Method-Override',type);if(beforeSend)return beforeSend.apply(this,arguments);};}
if(params.type!=='GET'&&!options.emulateJSON){params.processData=false;}
if(params.type==='PATCH'&&noXhrPatch){params.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP");};}
var xhr=options.xhr=Backbone.ajax(_.extend(params,options));model.trigger('request',model,xhr,options);return xhr;};var noXhrPatch=typeof window!=='undefined'&&!!window.ActiveXObject&&!(window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent);var methodMap={'create':'POST','update':'PUT','patch':'PATCH','delete':'DELETE','read':'GET'};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments);};var Router=Backbone.Router=function(options){options||(options={});if(options.routes)this.routes=options.routes;this._bindRoutes();this.initialize.apply(this,arguments);};var optionalParam=/\((.*?)\)/g;var namedParam=/(\(\?)?:\w+/g;var splatParam=/\*\w+/g;var escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){if(!_.isRegExp(route))route=this._routeToRegExp(route);if(_.isFunction(name)){callback=name;name='';}
if(!callback)callback=this[name];var router=this;Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);callback&&callback.apply(router,args);router.trigger.apply(router,['route:'+name].concat(args));router.trigger('route',name,args);Backbone.history.trigger('route',router,name,args);});return this;},navigate:function(fragment,options){Backbone.history.navigate(fragment,options);return this;},_bindRoutes:function(){if(!this.routes)return;this.routes=_.result(this,'routes');var route,routes=_.keys(this.routes);while((route=routes.pop())!=null){this.route(route,this.routes[route]);}},_routeToRegExp:function(route){route=route.replace(escapeRegExp,'\\$&').replace(optionalParam,'(?:$1)?').replace(namedParam,function(match,optional){return optional?match:'([^\/]+)';}).replace(splatParam,'(.*?)');return new RegExp('^'+route+'$');},_extractParameters:function(route,fragment){var params=route.exec(fragment).slice(1);return _.map(params,function(param){return param?decodeURIComponent(param):null;});}});var History=Backbone.History=function(){this.handlers=[];_.bindAll(this,'checkUrl');if(typeof window!=='undefined'){this.location=window.location;this.history=window.history;}};var routeStripper=/^[#\/]|\s+$/g;var rootStripper=/^\/+|\/+$/g;var isExplorer=/msie [\w.]+/;var trailingSlash=/\/$/;var pathStripper=/[?#].*$/;History.started=false;_.extend(History.prototype,Events,{interval:50,getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:'';},getFragment:function(fragment,forcePushState){if(fragment==null){if(this._hasPushState||!this._wantsHashChange||forcePushState){fragment=this.location.pathname;var root=this.root.replace(trailingSlash,'');if(!fragment.indexOf(root))fragment=fragment.slice(root.length);}else{fragment=this.getHash();}}
return fragment.replace(routeStripper,'');},start:function(options){if(History.started)throw new Error("Backbone.history has already been started");History.started=true;this.options=_.extend({root:'/'},this.options,options);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var fragment=this.getFragment();var docMode=document.documentMode;var oldIE=(isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||docMode<=7));this.root=('/'+this.root+'/').replace(rootStripper,'/');if(oldIE&&this._wantsHashChange){this.iframe=Backbone.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo('body')[0].contentWindow;this.navigate(fragment);}
if(this._hasPushState){Backbone.$(window).on('popstate',this.checkUrl);}else if(this._wantsHashChange&&('onhashchange'in window)&&!oldIE){Backbone.$(window).on('hashchange',this.checkUrl);}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval);}
this.fragment=fragment;var loc=this.location;var atRoot=loc.pathname.replace(/[^\/]$/,'$&/')===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!atRoot){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+'#'+this.fragment);return true;}else if(this._hasPushState&&atRoot&&loc.hash){this.fragment=this.getHash().replace(routeStripper,'');this.history.replaceState({},document.title,this.root+this.fragment+loc.search);}}
if(!this.options.silent)return this.loadUrl();},stop:function(){Backbone.$(window).off('popstate',this.checkUrl).off('hashchange',this.checkUrl);clearInterval(this._checkUrlInterval);History.started=false;},route:function(route,callback){this.handlers.unshift({route:route,callback:callback});},checkUrl:function(e){var current=this.getFragment();if(current===this.fragment&&this.iframe){current=this.getFragment(this.getHash(this.iframe));}
if(current===this.fragment)return false;if(this.iframe)this.navigate(current);this.loadUrl();},loadUrl:function(fragment){fragment=this.fragment=this.getFragment(fragment);return _.any(this.handlers,function(handler){if(handler.route.test(fragment)){handler.callback(fragment);return true;}});},navigate:function(fragment,options){if(!History.started)return false;if(!options||options===true)options={trigger:!!options};var url=this.root+(fragment=this.getFragment(fragment||''));fragment=fragment.replace(pathStripper,'');if(this.fragment===fragment)return;this.fragment=fragment;if(fragment===''&&url!=='/')url=url.slice(0,-1);if(this._hasPushState){this.history[options.replace?'replaceState':'pushState']({},document.title,url);}else if(this._wantsHashChange){this._updateHash(this.location,fragment,options.replace);if(this.iframe&&(fragment!==this.getFragment(this.getHash(this.iframe)))){if(!options.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,fragment,options.replace);}}else{return this.location.assign(url);}
if(options.trigger)return this.loadUrl(fragment);},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,'');location.replace(href+'#'+fragment);}else{location.hash='#'+fragment;}}});Backbone.history=new History;var extend=function(protoProps,staticProps){var parent=this;var child;if(protoProps&&_.has(protoProps,'constructor')){child=protoProps.constructor;}else{child=function(){return parent.apply(this,arguments);};}
_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child;};Surrogate.prototype=parent.prototype;child.prototype=new Surrogate;if(protoProps)_.extend(child.prototype,protoProps);child.__super__=parent.prototype;return child;};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A "url" property or function must be specified');};var wrapError=function(model,options){var error=options.error;options.error=function(resp){if(error)error(model,resp,options);model.trigger('error',model,resp,options);};};}).call(this);
/*!
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */
Backbone.ChildViewContainer=(function(Backbone,_){var Container=function(views){this._views={};this._indexByModel={};this._indexByCustom={};this._updateLength();_.each(views,this.add,this);};_.extend(Container.prototype,{add:function(view,customIndex){var viewCid=view.cid;this._views[viewCid]=view;if(view.model){this._indexByModel[view.model.cid]=viewCid;}
if(customIndex){this._indexByCustom[customIndex]=viewCid;}
this._updateLength();},findByModel:function(model){return this.findByModelCid(model.cid);},findByModelCid:function(modelCid){var viewCid=this._indexByModel[modelCid];return this.findByCid(viewCid);},findByCustom:function(index){var viewCid=this._indexByCustom[index];return this.findByCid(viewCid);},findByIndex:function(index){return _.values(this._views)[index];},findByCid:function(cid){return this._views[cid];},remove:function(view){var viewCid=view.cid;if(view.model){delete this._indexByModel[view.model.cid];}
_.any(this._indexByCustom,function(cid,key){if(cid===viewCid){delete this._indexByCustom[key];return true;}},this);delete this._views[viewCid];this._updateLength();},call:function(method){this.apply(method,_.tail(arguments));},apply:function(method,args){_.each(this._views,function(view){if(_.isFunction(view[method])){view[method].apply(view,args||[]);}});},_updateLength:function(){this.length=_.size(this._views);}});var methods=['forEach','each','map','find','detect','filter','select','reject','every','all','some','any','include','contains','invoke','toArray','first','initial','rest','last','without','isEmpty','pluck'];_.each(methods,function(method){Container.prototype[method]=function(){var views=_.values(this._views);var args=[views].concat(_.toArray(arguments));return _[method].apply(_,args);};});return Container;})(Backbone,_);Backbone.Wreqr=(function(Backbone,Marionette,_){"use strict";var Wreqr={};Wreqr.Handlers=(function(Backbone,_){"use strict";var Handlers=function(options){this.options=options;this._wreqrHandlers={};if(_.isFunction(this.initialize)){this.initialize(options);}};Handlers.extend=Backbone.Model.extend;_.extend(Handlers.prototype,Backbone.Events,{setHandlers:function(handlers){_.each(handlers,function(handler,name){var context=null;if(_.isObject(handler)&&!_.isFunction(handler)){context=handler.context;handler=handler.callback;}
this.setHandler(name,handler,context);},this);},setHandler:function(name,handler,context){var config={callback:handler,context:context};this._wreqrHandlers[name]=config;this.trigger("handler:add",name,handler,context);},hasHandler:function(name){return!!this._wreqrHandlers[name];},getHandler:function(name){var config=this._wreqrHandlers[name];if(!config){throw new Error("Handler not found for '"+name+"'");}
return function(){var args=Array.prototype.slice.apply(arguments);return config.callback.apply(config.context,args);};},removeHandler:function(name){delete this._wreqrHandlers[name];},removeAllHandlers:function(){this._wreqrHandlers={};}});return Handlers;})(Backbone,_);Wreqr.CommandStorage=(function(){"use strict";var CommandStorage=function(options){this.options=options;this._commands={};if(_.isFunction(this.initialize)){this.initialize(options);}};_.extend(CommandStorage.prototype,Backbone.Events,{getCommands:function(commandName){var commands=this._commands[commandName];if(!commands){commands={command:commandName,instances:[]};this._commands[commandName]=commands;}
return commands;},addCommand:function(commandName,args){var command=this.getCommands(commandName);command.instances.push(args);},clearCommands:function(commandName){var command=this.getCommands(commandName);command.instances=[];}});return CommandStorage;})();Wreqr.Commands=(function(Wreqr){"use strict";return Wreqr.Handlers.extend({storageType:Wreqr.CommandStorage,constructor:function(options){this.options=options||{};this._initializeStorage(this.options);this.on("handler:add",this._executeCommands,this);var args=Array.prototype.slice.call(arguments);Wreqr.Handlers.prototype.constructor.apply(this,args);},execute:function(name,args){name=arguments[0];args=Array.prototype.slice.call(arguments,1);if(this.hasHandler(name)){this.getHandler(name).apply(this,args);}else{this.storage.addCommand(name,args);}},_executeCommands:function(name,handler,context){var command=this.storage.getCommands(name);_.each(command.instances,function(args){handler.apply(context,args);});this.storage.clearCommands(name);},_initializeStorage:function(options){var storage;var StorageType=options.storageType||this.storageType;if(_.isFunction(StorageType)){storage=new StorageType();}else{storage=StorageType;}
this.storage=storage;}});})(Wreqr);Wreqr.RequestResponse=(function(Wreqr){"use strict";return Wreqr.Handlers.extend({request:function(){var name=arguments[0];var args=Array.prototype.slice.call(arguments,1);return this.getHandler(name).apply(this,args);}});})(Wreqr);Wreqr.EventAggregator=(function(Backbone,_){"use strict";var EA=function(){};EA.extend=Backbone.Model.extend;_.extend(EA.prototype,Backbone.Events);return EA;})(Backbone,_);return Wreqr;})(Backbone,Backbone.Marionette,_);var Marionette=(function(global,Backbone,_){"use strict";var Marionette={};Backbone.Marionette=Marionette;Marionette.$=Backbone.$;var protoSlice=Array.prototype.slice;function slice(args){return protoSlice.call(args);}
function throwError(message,name){var error=new Error(message);error.name=name||'Error';throw error;}
Marionette.extend=Backbone.Model.extend;Marionette.getOption=function(target,optionName){if(!target||!optionName){return;}
var value;if(target.options&&(optionName in target.options)&&(target.options[optionName]!==undefined)){value=target.options[optionName];}else{value=target[optionName];}
return value;};Marionette.normalizeMethods=function(hash){var normalizedHash={},method;_.each(hash,function(fn,name){method=fn;if(!_.isFunction(method)){method=this[method];}
if(!method){return;}
normalizedHash[name]=method;},this);return normalizedHash;};Marionette.triggerMethod=(function(){var splitter=/(^|:)(\w)/gi;function getEventName(match,prefix,eventName){return eventName.toUpperCase();}
var triggerMethod=function(event){var methodName='on'+event.replace(splitter,getEventName);var method=this[methodName];if(_.isFunction(this.trigger)){this.trigger.apply(this,arguments);}
if(_.isFunction(method)){return method.apply(this,_.tail(arguments));}};return triggerMethod;})();Marionette.MonitorDOMRefresh=(function(documentElement){function handleShow(view){view._isShown=true;triggerDOMRefresh(view);}
function handleRender(view){view._isRendered=true;triggerDOMRefresh(view);}
function triggerDOMRefresh(view){if(view._isShown&&view._isRendered&&isInDOM(view)){if(_.isFunction(view.triggerMethod)){view.triggerMethod("dom:refresh");}}}
function isInDOM(view){return documentElement.contains(view.el);}
return function(view){view.listenTo(view,"show",function(){handleShow(view);});view.listenTo(view,"render",function(){handleRender(view);});};})(document.documentElement);(function(Marionette){"use strict";function bindFromStrings(target,entity,evt,methods){var methodNames=methods.split(/\s+/);_.each(methodNames,function(methodName){var method=target[methodName];if(!method){throwError("Method '"+methodName+"' was configured as an event handler, but does not exist.");}
target.listenTo(entity,evt,method,target);});}
function bindToFunction(target,entity,evt,method){target.listenTo(entity,evt,method,target);}
function unbindFromStrings(target,entity,evt,methods){var methodNames=methods.split(/\s+/);_.each(methodNames,function(methodName){var method=target[methodName];target.stopListening(entity,evt,method,target);});}
function unbindToFunction(target,entity,evt,method){target.stopListening(entity,evt,method,target);}
function iterateEvents(target,entity,bindings,functionCallback,stringCallback){if(!entity||!bindings){return;}
if(_.isFunction(bindings)){bindings=bindings.call(target);}
_.each(bindings,function(methods,evt){if(_.isFunction(methods)){functionCallback(target,entity,evt,methods);}else{stringCallback(target,entity,evt,methods);}});}
Marionette.bindEntityEvents=function(target,entity,bindings){iterateEvents(target,entity,bindings,bindToFunction,bindFromStrings);};Marionette.unbindEntityEvents=function(target,entity,bindings){iterateEvents(target,entity,bindings,unbindToFunction,unbindFromStrings);};})(Marionette);Marionette.Callbacks=function(){this._deferred=Marionette.$.Deferred();this._callbacks=[];};_.extend(Marionette.Callbacks.prototype,{add:function(callback,contextOverride){this._callbacks.push({cb:callback,ctx:contextOverride});this._deferred.done(function(context,options){if(contextOverride){context=contextOverride;}
callback.call(context,options);});},run:function(options,context){this._deferred.resolve(context,options);},reset:function(){var callbacks=this._callbacks;this._deferred=Marionette.$.Deferred();this._callbacks=[];_.each(callbacks,function(cb){this.add(cb.cb,cb.ctx);},this);}});Marionette.Controller=function(options){this.triggerMethod=Marionette.triggerMethod;this.options=options||{};if(_.isFunction(this.initialize)){this.initialize(this.options);}};Marionette.Controller.extend=Marionette.extend;_.extend(Marionette.Controller.prototype,Backbone.Events,{close:function(){this.stopListening();this.triggerMethod("close");this.unbind();}});Marionette.Region=function(options){this.options=options||{};this.el=Marionette.getOption(this,"el");if(!this.el){var err=new Error("An 'el' must be specified for a region.");err.name="NoElError";throw err;}
if(this.initialize){var args=Array.prototype.slice.apply(arguments);this.initialize.apply(this,args);}};_.extend(Marionette.Region,{buildRegion:function(regionConfig,defaultRegionType){var regionIsString=(typeof regionConfig==="string");var regionSelectorIsString=(typeof regionConfig.selector==="string");var regionTypeIsUndefined=(typeof regionConfig.regionType==="undefined");var regionIsType=(typeof regionConfig==="function");if(!regionIsType&&!regionIsString&&!regionSelectorIsString){throw new Error("Region must be specified as a Region type, a selector string or an object with selector property");}
var selector,RegionType;if(regionIsString){selector=regionConfig;}
if(regionConfig.selector){selector=regionConfig.selector;delete regionConfig.selector;}
if(regionIsType){RegionType=regionConfig;}
if(!regionIsType&&regionTypeIsUndefined){RegionType=defaultRegionType;}
if(regionConfig.regionType){RegionType=regionConfig.regionType;delete regionConfig.regionType;}
if(regionIsString||regionIsType){regionConfig={};}
regionConfig.el=selector;var region=new RegionType(regionConfig);if(regionConfig.parentEl){region.getEl=function(selector){var parentEl=regionConfig.parentEl;if(_.isFunction(parentEl)){parentEl=parentEl();}
return parentEl.find(selector);};}
return region;}});_.extend(Marionette.Region.prototype,Backbone.Events,{show:function(view){this.ensureEl();var isViewClosed=view.isClosed||_.isUndefined(view.$el);var isDifferentView=view!==this.currentView;if(isDifferentView){this.close();}
view.render();if(isDifferentView||isViewClosed){this.open(view);}
this.currentView=view;Marionette.triggerMethod.call(this,"show",view);Marionette.triggerMethod.call(view,"show");},ensureEl:function(){if(!this.$el||this.$el.length===0){this.$el=this.getEl(this.el);}},getEl:function(selector){return Marionette.$(selector);},open:function(view){this.$el.empty().append(view.el);},close:function(){var view=this.currentView;if(!view||view.isClosed){return;}
if(view.close){view.close();}
else if(view.remove){view.remove();}
Marionette.triggerMethod.call(this,"close",view);delete this.currentView;},attachView:function(view){this.currentView=view;},reset:function(){this.close();delete this.$el;}});Marionette.Region.extend=Marionette.extend;Marionette.RegionManager=(function(Marionette){var RegionManager=Marionette.Controller.extend({constructor:function(options){this._regions={};Marionette.Controller.prototype.constructor.call(this,options);},addRegions:function(regionDefinitions,defaults){var regions={};_.each(regionDefinitions,function(definition,name){if(typeof definition==="string"){definition={selector:definition};}
if(definition.selector){definition=_.defaults({},definition,defaults);}
var region=this.addRegion(name,definition);regions[name]=region;},this);return regions;},addRegion:function(name,definition){var region;var isObject=_.isObject(definition);var isString=_.isString(definition);var hasSelector=!!definition.selector;if(isString||(isObject&&hasSelector)){region=Marionette.Region.buildRegion(definition,Marionette.Region);}else if(_.isFunction(definition)){region=Marionette.Region.buildRegion(definition,Marionette.Region);}else{region=definition;}
this._store(name,region);this.triggerMethod("region:add",name,region);return region;},get:function(name){return this._regions[name];},removeRegion:function(name){var region=this._regions[name];this._remove(name,region);},removeRegions:function(){_.each(this._regions,function(region,name){this._remove(name,region);},this);},closeRegions:function(){_.each(this._regions,function(region,name){region.close();},this);},close:function(){this.removeRegions();var args=Array.prototype.slice.call(arguments);Marionette.Controller.prototype.close.apply(this,args);},_store:function(name,region){this._regions[name]=region;this._setLength();},_remove:function(name,region){region.close();delete this._regions[name];this._setLength();this.triggerMethod("region:remove",name,region);},_setLength:function(){this.length=_.size(this._regions);}});var methods=['forEach','each','map','find','detect','filter','select','reject','every','all','some','any','include','contains','invoke','toArray','first','initial','rest','last','without','isEmpty','pluck'];_.each(methods,function(method){RegionManager.prototype[method]=function(){var regions=_.values(this._regions);var args=[regions].concat(_.toArray(arguments));return _[method].apply(_,args);};});return RegionManager;})(Marionette);Marionette.TemplateCache=function(templateId){this.templateId=templateId;};_.extend(Marionette.TemplateCache,{templateCaches:{},get:function(templateId){var cachedTemplate=this.templateCaches[templateId];if(!cachedTemplate){cachedTemplate=new Marionette.TemplateCache(templateId);this.templateCaches[templateId]=cachedTemplate;}
return cachedTemplate.load();},clear:function(){var i;var args=slice(arguments);var length=args.length;if(length>0){for(i=0;i<length;i++){delete this.templateCaches[args[i]];}}else{this.templateCaches={};}}});_.extend(Marionette.TemplateCache.prototype,{load:function(){if(this.compiledTemplate){return this.compiledTemplate;}
var template=this.loadTemplate(this.templateId);this.compiledTemplate=this.compileTemplate(template);return this.compiledTemplate;},loadTemplate:function(templateId){var template=Marionette.$(templateId).html();if(!template||template.length===0){throwError("Could not find template: '"+templateId+"'","NoTemplateError");}
return template;},compileTemplate:function(rawTemplate){return _.template(rawTemplate);}});Marionette.Renderer={render:function(template,data){if(!template){var error=new Error("Cannot render the template since it's false, null or undefined.");error.name="TemplateNotFoundError";throw error;}
var templateFunc;if(typeof template==="function"){templateFunc=template;}else{templateFunc=Marionette.TemplateCache.get(template);}
return templateFunc(data);}};Marionette.View=Backbone.View.extend({constructor:function(options){_.bindAll(this,"render");var args=Array.prototype.slice.apply(arguments);this.options=_.extend({},_.result(this,'options'),_.isFunction(options)?options.call(this):options);this.events=this.normalizeUIKeys(_.result(this,'events'));Backbone.View.prototype.constructor.apply(this,args);Marionette.MonitorDOMRefresh(this);this.listenTo(this,"show",this.onShowCalled,this);},triggerMethod:Marionette.triggerMethod,normalizeMethods:Marionette.normalizeMethods,getTemplate:function(){return Marionette.getOption(this,"template");},mixinTemplateHelpers:function(target){target=target||{};var templateHelpers=Marionette.getOption(this,"templateHelpers");if(_.isFunction(templateHelpers)){templateHelpers=templateHelpers.call(this);}
return _.extend(target,templateHelpers);},normalizeUIKeys:function(hash){if(typeof(hash)==="undefined"){return;}
_.each(_.keys(hash),function(v){var split=v.split("@ui.");if(split.length===2){hash[split[0]+this.ui[split[1]]]=hash[v];delete hash[v];}},this);return hash;},configureTriggers:function(){if(!this.triggers){return;}
var triggerEvents={};var triggers=this.normalizeUIKeys(_.result(this,"triggers"));_.each(triggers,function(value,key){var hasOptions=_.isObject(value);var eventName=hasOptions?value.event:value;triggerEvents[key]=function(e){if(e){var prevent=e.preventDefault;var stop=e.stopPropagation;var shouldPrevent=hasOptions?value.preventDefault:prevent;var shouldStop=hasOptions?value.stopPropagation:stop;if(shouldPrevent&&prevent){prevent.apply(e);}
if(shouldStop&&stop){stop.apply(e);}}
var args={view:this,model:this.model,collection:this.collection};this.triggerMethod(eventName,args);};},this);return triggerEvents;},delegateEvents:function(events){this._delegateDOMEvents(events);Marionette.bindEntityEvents(this,this.model,Marionette.getOption(this,"modelEvents"));Marionette.bindEntityEvents(this,this.collection,Marionette.getOption(this,"collectionEvents"));},_delegateDOMEvents:function(events){events=events||this.events;if(_.isFunction(events)){events=events.call(this);}
var combinedEvents={};var triggers=this.configureTriggers();_.extend(combinedEvents,events,triggers);Backbone.View.prototype.delegateEvents.call(this,combinedEvents);},undelegateEvents:function(){var args=Array.prototype.slice.call(arguments);Backbone.View.prototype.undelegateEvents.apply(this,args);Marionette.unbindEntityEvents(this,this.model,Marionette.getOption(this,"modelEvents"));Marionette.unbindEntityEvents(this,this.collection,Marionette.getOption(this,"collectionEvents"));},onShowCalled:function(){},close:function(){if(this.isClosed){return;}
var shouldClose=this.triggerMethod("before:close");if(shouldClose===false){return;}
this.isClosed=true;this.triggerMethod("close");this.unbindUIElements();this.remove();},bindUIElements:function(){if(!this.ui){return;}
if(!this._uiBindings){this._uiBindings=this.ui;}
var bindings=_.result(this,"_uiBindings");this.ui={};_.each(_.keys(bindings),function(key){var selector=bindings[key];this.ui[key]=this.$(selector);},this);},unbindUIElements:function(){if(!this.ui||!this._uiBindings){return;}
_.each(this.ui,function($el,name){delete this.ui[name];},this);this.ui=this._uiBindings;delete this._uiBindings;}});Marionette.ItemView=Marionette.View.extend({constructor:function(){Marionette.View.prototype.constructor.apply(this,slice(arguments));},serializeData:function(){var data={};if(this.model){data=this.model.toJSON();}
else if(this.collection){data={items:this.collection.toJSON()};}
return data;},render:function(){this.isClosed=false;this.triggerMethod("before:render",this);this.triggerMethod("item:before:render",this);var data=this.serializeData();data=this.mixinTemplateHelpers(data);var template=this.getTemplate();var html=Marionette.Renderer.render(template,data);this.$el.html(html);this.bindUIElements();this.triggerMethod("render",this);this.triggerMethod("item:rendered",this);return this;},close:function(){if(this.isClosed){return;}
this.triggerMethod('item:before:close');Marionette.View.prototype.close.apply(this,slice(arguments));this.triggerMethod('item:closed');}});Marionette.CollectionView=Marionette.View.extend({itemViewEventPrefix:"itemview",constructor:function(options){this._initChildViewStorage();Marionette.View.prototype.constructor.apply(this,slice(arguments));this._initialEvents();this.initRenderBuffer();},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment();this._bufferedChildren=[];},startBuffering:function(){this.initRenderBuffer();this.isBuffering=true;},endBuffering:function(){this.isBuffering=false;this.appendBuffer(this,this.elBuffer);this._triggerShowBufferedChildren();this.initRenderBuffer();},_triggerShowBufferedChildren:function(){if(this._isShown){_.each(this._bufferedChildren,function(child){Marionette.triggerMethod.call(child,"show");});this._bufferedChildren=[];}},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this.render,this);}},addChildView:function(item,collection,options){this.closeEmptyView();var ItemView=this.getItemView(item);var index=this.collection.indexOf(item);this.addItemView(item,ItemView,index);},onShowCalled:function(){this.children.each(function(child){Marionette.triggerMethod.call(child,"show");});},triggerBeforeRender:function(){this.triggerMethod("before:render",this);this.triggerMethod("collection:before:render",this);},triggerRendered:function(){this.triggerMethod("render",this);this.triggerMethod("collection:rendered",this);},render:function(){this.isClosed=false;this.triggerBeforeRender();this._renderChildren();this.triggerRendered();return this;},_renderChildren:function(){this.startBuffering();this.closeEmptyView();this.closeChildren();if(!this.isEmpty(this.collection)){this.showCollection();}else{this.showEmptyView();}
this.endBuffering();},showCollection:function(){var ItemView;this.collection.each(function(item,index){ItemView=this.getItemView(item);this.addItemView(item,ItemView,index);},this);},showEmptyView:function(){var EmptyView=this.getEmptyView();if(EmptyView&&!this._showingEmptyView){this._showingEmptyView=true;var model=new Backbone.Model();this.addItemView(model,EmptyView,0);}},closeEmptyView:function(){if(this._showingEmptyView){this.closeChildren();delete this._showingEmptyView;}},getEmptyView:function(){return Marionette.getOption(this,"emptyView");},getItemView:function(item){var itemView=Marionette.getOption(this,"itemView");if(!itemView){throwError("An `itemView` must be specified","NoItemViewError");}
return itemView;},addItemView:function(item,ItemView,index){var itemViewOptions=Marionette.getOption(this,"itemViewOptions");if(_.isFunction(itemViewOptions)){itemViewOptions=itemViewOptions.call(this,item,index);}
var view=this.buildItemView(item,ItemView,itemViewOptions);this.addChildViewEventForwarding(view);this.triggerMethod("before:item:added",view);this.children.add(view);this.renderItemView(view,index);if(this._isShown&&!this.isBuffering){Marionette.triggerMethod.call(view,"show");}
this.triggerMethod("after:item:added",view);return view;},addChildViewEventForwarding:function(view){var prefix=Marionette.getOption(this,"itemViewEventPrefix");this.listenTo(view,"all",function(){var args=slice(arguments);var rootEvent=args[0];var itemEvents=this.normalizeMethods(this.getItemEvents());args[0]=prefix+":"+rootEvent;args.splice(1,0,view);if(typeof itemEvents!=="undefined"&&_.isFunction(itemEvents[rootEvent])){itemEvents[rootEvent].apply(this,args);}
Marionette.triggerMethod.apply(this,args);},this);},getItemEvents:function(){if(_.isFunction(this.itemEvents)){return this.itemEvents.call(this);}
return this.itemEvents;},renderItemView:function(view,index){view.render();this.appendHtml(this,view,index);},buildItemView:function(item,ItemViewType,itemViewOptions){var options=_.extend({model:item},itemViewOptions);return new ItemViewType(options);},removeItemView:function(item){var view=this.children.findByModel(item);this.removeChildView(view);this.checkEmpty();},removeChildView:function(view){if(view){this.stopListening(view);if(view.close){view.close();}
else if(view.remove){view.remove();}
this.children.remove(view);}
this.triggerMethod("item:removed",view);},isEmpty:function(collection){return!this.collection||this.collection.length===0;},checkEmpty:function(){if(this.isEmpty(this.collection)){this.showEmptyView();}},appendBuffer:function(collectionView,buffer){collectionView.$el.append(buffer);},appendHtml:function(collectionView,itemView,index){if(collectionView.isBuffering){collectionView.elBuffer.appendChild(itemView.el);collectionView._bufferedChildren.push(itemView);}
else{collectionView.$el.append(itemView.el);}},_initChildViewStorage:function(){this.children=new Backbone.ChildViewContainer();},close:function(){if(this.isClosed){return;}
this.triggerMethod("collection:before:close");this.closeChildren();this.triggerMethod("collection:closed");Marionette.View.prototype.close.apply(this,slice(arguments));},closeChildren:function(){this.children.each(function(child){this.removeChildView(child);},this);this.checkEmpty();}});Marionette.CompositeView=Marionette.CollectionView.extend({constructor:function(){Marionette.CollectionView.prototype.constructor.apply(this,slice(arguments));},_initialEvents:function(){this.once('render',function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this._renderChildren,this);}});},getItemView:function(item){var itemView=Marionette.getOption(this,"itemView")||this.constructor;if(!itemView){throwError("An `itemView` must be specified","NoItemViewError");}
return itemView;},serializeData:function(){var data={};if(this.model){data=this.model.toJSON();}
return data;},render:function(){this.isRendered=true;this.isClosed=false;this.resetItemViewContainer();this.triggerBeforeRender();var html=this.renderModel();this.$el.html(html);this.bindUIElements();this.triggerMethod("composite:model:rendered");this._renderChildren();this.triggerMethod("composite:rendered");this.triggerRendered();return this;},_renderChildren:function(){if(this.isRendered){this.triggerMethod("composite:collection:before:render");Marionette.CollectionView.prototype._renderChildren.call(this);this.triggerMethod("composite:collection:rendered");}},renderModel:function(){var data={};data=this.serializeData();data=this.mixinTemplateHelpers(data);var template=this.getTemplate();return Marionette.Renderer.render(template,data);},appendBuffer:function(compositeView,buffer){var $container=this.getItemViewContainer(compositeView);$container.append(buffer);},appendHtml:function(compositeView,itemView,index){if(compositeView.isBuffering){compositeView.elBuffer.appendChild(itemView.el);compositeView._bufferedChildren.push(itemView);}
else{var $container=this.getItemViewContainer(compositeView);$container.append(itemView.el);}},getItemViewContainer:function(containerView){if("$itemViewContainer"in containerView){return containerView.$itemViewContainer;}
var container;var itemViewContainer=Marionette.getOption(containerView,"itemViewContainer");if(itemViewContainer){var selector=_.isFunction(itemViewContainer)?itemViewContainer.call(this):itemViewContainer;container=containerView.$(selector);if(container.length<=0){throwError("The specified `itemViewContainer` was not found: "+containerView.itemViewContainer,"ItemViewContainerMissingError");}}else{container=containerView.$el;}
containerView.$itemViewContainer=container;return container;},resetItemViewContainer:function(){if(this.$itemViewContainer){delete this.$itemViewContainer;}}});Marionette.Layout=Marionette.ItemView.extend({regionType:Marionette.Region,constructor:function(options){options=options||{};this._firstRender=true;this._initializeRegions(options);Marionette.ItemView.prototype.constructor.call(this,options);},render:function(){if(this.isClosed){this._initializeRegions();}
if(this._firstRender){this._firstRender=false;}else if(!this.isClosed){this._reInitializeRegions();}
var args=Array.prototype.slice.apply(arguments);var result=Marionette.ItemView.prototype.render.apply(this,args);return result;},close:function(){if(this.isClosed){return;}
this.regionManager.close();var args=Array.prototype.slice.apply(arguments);Marionette.ItemView.prototype.close.apply(this,args);},addRegion:function(name,definition){var regions={};regions[name]=definition;return this._buildRegions(regions)[name];},addRegions:function(regions){this.regions=_.extend({},this.regions,regions);return this._buildRegions(regions);},removeRegion:function(name){delete this.regions[name];return this.regionManager.removeRegion(name);},_buildRegions:function(regions){var that=this;var defaults={regionType:Marionette.getOption(this,"regionType"),parentEl:function(){return that.$el;}};return this.regionManager.addRegions(regions,defaults);},_initializeRegions:function(options){var regions;this._initRegionManager();if(_.isFunction(this.regions)){regions=this.regions(options);}else{regions=this.regions||{};}
this.addRegions(regions);},_reInitializeRegions:function(){this.regionManager.closeRegions();this.regionManager.each(function(region){region.reset();});},_initRegionManager:function(){this.regionManager=new Marionette.RegionManager();this.listenTo(this.regionManager,"region:add",function(name,region){this[name]=region;this.trigger("region:add",name,region);});this.listenTo(this.regionManager,"region:remove",function(name,region){delete this[name];this.trigger("region:remove",name,region);});}});Marionette.AppRouter=Backbone.Router.extend({constructor:function(options){Backbone.Router.prototype.constructor.apply(this,slice(arguments));this.options=options||{};var appRoutes=Marionette.getOption(this,"appRoutes");var controller=this._getController();this.processAppRoutes(controller,appRoutes);},appRoute:function(route,methodName){var controller=this._getController();this._addAppRoute(controller,route,methodName);},processAppRoutes:function(controller,appRoutes){if(!appRoutes){return;}
var routeNames=_.keys(appRoutes).reverse();_.each(routeNames,function(route){this._addAppRoute(controller,route,appRoutes[route]);},this);},_getController:function(){return Marionette.getOption(this,"controller");},_addAppRoute:function(controller,route,methodName){var method=controller[methodName];if(!method){throw new Error("Method '"+methodName+"' was not found on the controller");}
this.route(route,methodName,_.bind(method,controller));}});Marionette.Application=function(options){this._initRegionManager();this._initCallbacks=new Marionette.Callbacks();this.vent=new Backbone.Wreqr.EventAggregator();this.commands=new Backbone.Wreqr.Commands();this.reqres=new Backbone.Wreqr.RequestResponse();this.submodules={};_.extend(this,options);this.triggerMethod=Marionette.triggerMethod;};_.extend(Marionette.Application.prototype,Backbone.Events,{execute:function(){var args=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,args);},request:function(){var args=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,args);},addInitializer:function(initializer){this._initCallbacks.add(initializer);},start:function(options){this.triggerMethod("initialize:before",options);this._initCallbacks.run(options,this);this.triggerMethod("initialize:after",options);this.triggerMethod("start",options);},addRegions:function(regions){return this._regionManager.addRegions(regions);},closeRegions:function(){this._regionManager.closeRegions();},removeRegion:function(region){this._regionManager.removeRegion(region);},getRegion:function(region){return this._regionManager.get(region);},module:function(moduleNames,moduleDefinition){var ModuleClass=Marionette.Module;if(moduleDefinition){ModuleClass=moduleDefinition.moduleClass||ModuleClass;}
var args=slice(arguments);args.unshift(this);return ModuleClass.create.apply(ModuleClass,args);},_initRegionManager:function(){this._regionManager=new Marionette.RegionManager();this.listenTo(this._regionManager,"region:add",function(name,region){this[name]=region;});this.listenTo(this._regionManager,"region:remove",function(name,region){delete this[name];});}});Marionette.Application.extend=Marionette.extend;Marionette.Module=function(moduleName,app,options){this.moduleName=moduleName;this.options=_.extend({},this.options,options);this.initialize=options.initialize||this.initialize;this.submodules={};this._setupInitializersAndFinalizers();this.app=app;this.startWithParent=true;this.triggerMethod=Marionette.triggerMethod;if(_.isFunction(this.initialize)){this.initialize(this.options,moduleName,app);}};Marionette.Module.extend=Marionette.extend;_.extend(Marionette.Module.prototype,Backbone.Events,{initialize:function(){},addInitializer:function(callback){this._initializerCallbacks.add(callback);},addFinalizer:function(callback){this._finalizerCallbacks.add(callback);},start:function(options){if(this._isInitialized){return;}
_.each(this.submodules,function(mod){if(mod.startWithParent){mod.start(options);}});this.triggerMethod("before:start",options);this._initializerCallbacks.run(options,this);this._isInitialized=true;this.triggerMethod("start",options);},stop:function(){if(!this._isInitialized){return;}
this._isInitialized=false;Marionette.triggerMethod.call(this,"before:stop");_.each(this.submodules,function(mod){mod.stop();});this._finalizerCallbacks.run(undefined,this);this._initializerCallbacks.reset();this._finalizerCallbacks.reset();Marionette.triggerMethod.call(this,"stop");},addDefinition:function(moduleDefinition,customArgs){this._runModuleDefinition(moduleDefinition,customArgs);},_runModuleDefinition:function(definition,customArgs){if(!definition){return;}
var args=_.flatten([this,this.app,Backbone,Marionette,Marionette.$,_,customArgs]);definition.apply(this,args);},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new Marionette.Callbacks();this._finalizerCallbacks=new Marionette.Callbacks();}});_.extend(Marionette.Module,{create:function(app,moduleNames,moduleDefinition){var module=app;var customArgs=slice(arguments);customArgs.splice(0,3);moduleNames=moduleNames.split(".");var length=moduleNames.length;var moduleDefinitions=[];moduleDefinitions[length-1]=moduleDefinition;_.each(moduleNames,function(moduleName,i){var parentModule=module;module=this._getModule(parentModule,moduleName,app,moduleDefinition);this._addModuleDefinition(parentModule,module,moduleDefinitions[i],customArgs);},this);return module;},_getModule:function(parentModule,moduleName,app,def,args){var ModuleClass=Marionette.Module;var options=_.extend({},def);if(def){ModuleClass=def.moduleClass||ModuleClass;}
var module=parentModule[moduleName];if(!module){module=new ModuleClass(moduleName,app,options);parentModule[moduleName]=module;parentModule.submodules[moduleName]=module;}
return module;},_addModuleDefinition:function(parentModule,module,def,args){var fn;var startWithParent;if(_.isFunction(def)){fn=def;startWithParent=true;}else if(_.isObject(def)){fn=def.define;startWithParent=(typeof def.startWithParent!=='undefined')?def.startWithParent:true;}else{startWithParent=true;}
if(fn){module.addDefinition(fn,args);}
module.startWithParent=module.startWithParent&&startWithParent;if(module.startWithParent&&!module.startWithParentIsConfigured){module.startWithParentIsConfigured=true;parentModule.addInitializer(function(options){if(module.startWithParent){module.start(options);}});}}});return Marionette;})(this,Backbone,_);Backbone.Picky=(function(Backbone,_){var Picky={};Picky.SingleSelect=function(collection,models){this._pickyCid=_.uniqueId('singleSelect-');this.collection=collection;if(arguments.length>1){_.each(models||[],function(model){registerCollectionWithModel(model,this);if(model.selected)this.selected=model;},this);this.collection.listenTo(this.collection,'_selected',this.select);this.collection.listenTo(this.collection,'_deselected',this.deselect);this.collection.listenTo(this.collection,'reset',onResetSingleSelect);this.collection.listenTo(this.collection,'add',onAdd);this.collection.listenTo(this.collection,'remove',onRemove);}};_.extend(Picky.SingleSelect.prototype,{select:function(model,options){options||(options={});if(model&&this.selected===model){return;}
this.deselect(undefined,_.omit(options,"_localSilent"));this.selected=model;this.selected.select(_.omit(options,"_localSilent"));if(!(options.silent||options._localSilent))this.trigger("select:one",model);},deselect:function(model,options){options||(options={});if(!this.selected){return;}
model=model||this.selected;if(this.selected!==model){return;}
delete this.selected;if(!options._skipModelCall)model.deselect(_.omit(options,"_localSilent"));if(!(options.silent||options._localSilent))this.trigger("deselect:one",model);},close:function(){this.stopListening();}});Picky.MultiSelect=function(collection,models){this._pickyCid=_.uniqueId('multiSelect-');this.collection=collection;this.selected={};if(arguments.length>1){_.each(models||[],function(model){registerCollectionWithModel(model,this);if(model.selected)this.selected[model.cid]=model;},this);this.collection.listenTo(this.collection,'_selected',this.select);this.collection.listenTo(this.collection,'_deselected',this.deselect);this.collection.listenTo(this.collection,'reset',onResetMultiSelect);this.collection.listenTo(this.collection,'add',onAdd);this.collection.listenTo(this.collection,'remove',onRemove);}};_.extend(Picky.MultiSelect.prototype,{select:function(model,options){if(this.selected[model.cid]){return;}
this.selected[model.cid]=model;this.selectedLength=_.size(this.selected);model.select(_.omit(options,"_localSilent"));triggerMultiSelectEvents(this,options);},deselect:function(model,options){options||(options={});if(!this.selected[model.cid]){return;}
delete this.selected[model.cid];this.selectedLength=_.size(this.selected);if(!options._skipModelCall)model.deselect(_.omit(options,"_localSilent"));triggerMultiSelectEvents(this,options);},selectAll:function(options){this.selectedLength=0;this.each(function(model){this.selectedLength++;model.select(_.omit(options,"_localSilent"));},this);triggerMultiSelectEvents(this,options);},deselectAll:function(options){if(this.selectedLength===0){return;}
this.each(function(model){if(model.selected)this.selectedLength--;model.deselect(_.omit(options,"_localSilent"));},this);this.selectedLength=0;triggerMultiSelectEvents(this,options);},selectNone:function(options){this.deselectAll(options);},toggleSelectAll:function(options){if(this.selectedLength===this.length){this.deselectAll(options);}else{this.selectAll(options);}},close:function(){this.stopListening();}});Picky.Selectable=function(model){this.model=model;};_.extend(Picky.Selectable.prototype,{select:function(options){options||(options={});if(this.selected){return;}
this.selected=true;if(this._pickyCollections){this.trigger("_selected",this,_.omit(options,"_localSilent"));}else if(this.collection){this.collection.select(this,_.omit(options,"_localSilent"));}
if(!(options.silent||options._localSilent))this.trigger("selected",this);},deselect:function(options){options||(options={});if(!this.selected){return;}
this.selected=false;if(this._pickyCollections){this.trigger("_deselected",this,_.omit(options,"_localSilent"));}else if(this.collection){this.collection.deselect(this,_.omit(options,"_localSilent"));}
if(!(options.silent||options._localSilent))this.trigger("deselected",this);},toggleSelected:function(options){if(this.selected){this.deselect(options);}else{this.select(options);}}});var triggerMultiSelectEvents=function(collection,options){options||(options={});if(options.silent||options._localSilent)return;var selectedLength=collection.selectedLength;var length=collection.length;if(selectedLength===length){collection.trigger("select:all",collection);return;}
if(selectedLength===0){collection.trigger("select:none",collection);return;}
if(selectedLength>0&&selectedLength<length){collection.trigger("select:some",collection);return;}};function onAdd(model,collection){registerCollectionWithModel(model,collection);if(model.selected)collection.select(model);}
function onRemove(model,collection,options){if(model._pickyCollections)model._pickyCollections=_.without(model._pickyCollections,collection._pickyCid);if(model.selected){if(model._pickyCollections&&model._pickyCollections.length==0){collection.deselect(model,options);}else{collection.deselect(model,_.extend({},options,{_skipModelCall:true}));}}}
function onResetSingleSelect(collection,options){var selected,excessiveSelections,deselectOnRemove=_.find(options.previousModels,function(model){return model.selected;});if(deselectOnRemove)onRemove(deselectOnRemove,collection,{_localSilent:true});selected=collection.filter(function(model){return model.selected;});excessiveSelections=_.initial(selected);if(excessiveSelections.length)_.each(excessiveSelections,function(model){model.deselect();});if(selected.length)collection.select(_.last(selected),{silent:true});}
function onResetMultiSelect(collection,options){var select,deselect=_.filter(options.previousModels,function(model){return model.selected;});if(deselect)_.each(deselect,function(model){onRemove(model,collection,{_localSilent:true});});select=collection.filter(function(model){return model.selected;});if(select.length)_.each(select,function(model){collection.select(model,{silent:true});});}
function registerCollectionWithModel(model,collection){model._pickyCollections||(model._pickyCollections=[]);model._pickyCollections.push(collection._pickyCid);}
return Picky;})(Backbone,_);(function(factory){if(typeof define==='function'&&define.amd){define(['underscore','backbone','exports'],factory);}
else if(typeof exports==='object'){factory(require('underscore'),require('backbone'),exports);}
else{factory(_,Backbone,{});}}(function(_,Backbone,Stickit){Stickit._handlers=[];Stickit.addHandler=function(handlers){handlers=_.map(_.flatten([handlers]),function(handler){return _.defaults({},handler,{updateModel:true,updateView:true,updateMethod:'text'});});this._handlers=this._handlers.concat(handlers);};Stickit.ViewMixin={_modelBindings:null,unstickit:function(model,bindingSelector){if(_.isObject(bindingSelector)){_.each(bindingSelector,function(v,selector){this.unstickit(model,selector);},this);return;}
var models=[],destroyFns=[],bindings=_.clone(this._modelBindings);_.each(bindings,function(binding,i){if(model&&binding.model!==model)return;if(bindingSelector&&binding.config.selector!=bindingSelector)return;binding.model.off(binding.event,binding.fn);destroyFns.push(binding.config._destroy);models.push(binding.model);delete this._modelBindings[i];},this);_.invoke(_.uniq(models),'trigger','stickit:unstuck',this.cid);_.each(_.uniq(destroyFns),function(fn){fn.call(this);},this);this._modelBindings=_.compact(this._modelBindings);this.$el.off('.stickit'+(model?'.'+model.cid:''),bindingSelector);},stickit:function(optionalModel,optionalBindingsConfig){var model=optionalModel||this.model,bindings=optionalBindingsConfig||_.result(this,"bindings")||{};this._modelBindings||(this._modelBindings=[]);this.addBinding(model,bindings);var remove=this.remove;if(!remove.stickitWrapped){this.remove=function(){var ret=this;this.unstickit();if(remove)ret=remove.apply(this,arguments);return ret;};}
this.remove.stickitWrapped=true;return this;},addBinding:function(optionalModel,selector,binding){var model=optionalModel||this.model,namespace='.stickit.'+model.cid,binding=binding||{};if(_.isObject(selector)){var bindings=selector;_.each(bindings,function(val,key){this.addBinding(model,key,val);},this);return;}
var $el=selector===':el'?this.$el:this.$(selector);this.unstickit(model,selector);if(!$el.length)return;if(_.isString(binding))binding={observe:binding};if(_.isFunction(binding.observe))binding.observe=binding.observe.call(this);var config=getConfiguration($el,binding);var modelAttr=config.observe;config.selector=selector;config.view=this;var bindId=config.bindId=_.uniqueId();var options=_.extend({stickitChange:config},config.setOptions);config._destroy=function(){applyViewFn.call(this,config.destroy,$el,model,config);};initializeAttributes($el,config,model,modelAttr);initializeVisible($el,config,model,modelAttr);initializeClasses($el,config,model,modelAttr);if(modelAttr){_.each(config.events,function(type){var eventName=type+namespace;var listener=function(event){var val=applyViewFn.call(this,config.getVal,$el,event,config,slice.call(arguments,1));var currentVal=evaluateBoolean(config.updateModel,val,event,config);if(currentVal)setAttr(model,modelAttr,val,options,config);};var sel=selector===':el'?'':selector;this.$el.on(eventName,sel,_.bind(listener,this));},this);_.each(_.flatten([modelAttr]),function(attr){observeModelEvent(model,'change:'+attr,config,function(model,val,options){var changeId=options&&options.stickitChange&&options.stickitChange.bindId;if(changeId!==bindId){var currentVal=getAttr(model,modelAttr,config);updateViewBindEl($el,config,currentVal,model);}});});var currentVal=getAttr(model,modelAttr,config);updateViewBindEl($el,config,currentVal,model,true);}
applyViewFn.call(this,config.initialize,$el,model,config);}};_.extend(Backbone.View.prototype,Stickit.ViewMixin);var slice=[].slice;var evaluatePath=function(obj,path){var parts=(path||'').split('.');var result=_.reduce(parts,function(memo,i){return memo[i];},obj);return result==null?obj:result;};var applyViewFn=function(fn){fn=_.isString(fn)?evaluatePath(this,fn):fn;if(fn)return(fn).apply(this,slice.call(arguments,1));};var evaluateBoolean=function(reference,val,config){if(_.isBoolean(reference)){return reference;}else if(_.isFunction(reference)||_.isString(reference)){var view=_.last(arguments).view;return applyViewFn.apply(view,arguments);}
return false;};var observeModelEvent=function(model,event,config,fn){var view=config.view;model.on(event,fn,view);view._modelBindings.push({model:model,event:event,fn:fn,config:config});};var setAttr=function(model,attr,val,options,config){var value={},view=config.view;if(config.onSet){val=applyViewFn.call(view,config.onSet,val,config);}
if(config.set){applyViewFn.call(view,config.set,attr,val,options,config);}else{value[attr]=val;if(_.isArray(attr)&&_.isArray(val)){value=_.reduce(attr,function(memo,attribute,index){memo[attribute]=_.has(val,index)?val[index]:null;return memo;},{});}
model.set(value,options);}};var getAttr=function(model,attr,config){var view=config.view;var retrieveVal=function(field){return model[config.escape?'escape':'get'](field);};var sanitizeVal=function(val){return val==null?'':val;};var val=_.isArray(attr)?_.map(attr,retrieveVal):retrieveVal(attr);if(config.onGet)val=applyViewFn.call(view,config.onGet,val,config);return _.isArray(val)?_.map(val,sanitizeVal):sanitizeVal(val);};var getConfiguration=Stickit.getConfiguration=function($el,binding){var handlers=[{updateModel:false,updateMethod:'text',update:function($el,val,m,opts){if($el[opts.updateMethod])$el[opts.updateMethod](val);},getVal:function($el,e,opts){return $el[opts.updateMethod]();}}];handlers=handlers.concat(_.filter(Stickit._handlers,function(handler){return $el.is(handler.selector);}));handlers.push(binding);var config=_.extend.apply(_,handlers);if(!_.has(config,'updateView'))config.updateView=!config.visible;return config;};var initializeAttributes=function($el,config,model,modelAttr){var props=['autofocus','autoplay','async','checked','controls','defer','disabled','hidden','indeterminate','loop','multiple','open','readonly','required','scoped','selected'];var view=config.view;_.each(config.attributes||[],function(attrConfig){attrConfig=_.clone(attrConfig);attrConfig.view=view;var lastClass='';var observed=attrConfig.observe||(attrConfig.observe=modelAttr);var updateAttr=function(){var updateType=_.contains(props,attrConfig.name)?'prop':'attr',val=getAttr(model,observed,attrConfig);if(attrConfig.name==='class'){$el.removeClass(lastClass).addClass(val);lastClass=val;}else{$el[updateType](attrConfig.name,val);}};_.each(_.flatten([observed]),function(attr){observeModelEvent(model,'change:'+attr,config,updateAttr);});updateAttr();});};var initializeClasses=function($el,config,model,modelAttr){_.each(config.classes||[],function(classConfig,name){if(_.isString(classConfig))classConfig={observe:classConfig};classConfig.view=config.view;var observed=classConfig.observe;var updateClass=function(){var val=getAttr(model,observed,classConfig);$el.toggleClass(name,!!val);};_.each(_.flatten([observed]),function(attr){observeModelEvent(model,'change:'+attr,config,updateClass);});updateClass();});};var initializeVisible=function($el,config,model,modelAttr){if(config.visible==null)return;var view=config.view;var visibleCb=function(){var visible=config.visible,visibleFn=config.visibleFn,val=getAttr(model,modelAttr,config),isVisible=!!val;if(_.isFunction(visible)||_.isString(visible)){isVisible=!!applyViewFn.call(view,visible,val,config);}
if(visibleFn){applyViewFn.call(view,visibleFn,$el,isVisible,config);}else{$el.toggle(isVisible);}};_.each(_.flatten([modelAttr]),function(attr){observeModelEvent(model,'change:'+attr,config,visibleCb);});visibleCb();};var updateViewBindEl=function($el,config,val,model,isInitializing){var view=config.view;if(!evaluateBoolean(config.updateView,val,config))return;applyViewFn.call(view,config.update,$el,val,model,config);if(!isInitializing)applyViewFn.call(view,config.afterUpdate,$el,val,config);};Stickit.addHandler([{selector:'[contenteditable="true"]',updateMethod:'html',events:['input','change']},{selector:'input',events:['propertychange','input','change'],update:function($el,val){$el.val(val);},getVal:function($el){return $el.val();}},{selector:'textarea',events:['propertychange','input','change'],update:function($el,val){$el.val(val);},getVal:function($el){return $el.val();}},{selector:'input[type="radio"]',events:['change'],update:function($el,val){$el.filter('[value="'+val+'"]').prop('checked',true);},getVal:function($el){return $el.filter(':checked').val();}},{selector:'input[type="checkbox"]',events:['change'],update:function($el,val,model,options){if($el.length>1){val||(val=[]);$el.each(function(i,el){var checkbox=Backbone.$(el);var checked=_.contains(val,checkbox.val());checkbox.prop('checked',checked);});}else{var checked=_.isBoolean(val)?val:val===$el.val();$el.prop('checked',checked);}},getVal:function($el){var val;if($el.length>1){val=_.reduce($el,function(memo,el){var checkbox=Backbone.$(el);if(checkbox.prop('checked'))memo.push(checkbox.val());return memo;},[]);}else{val=$el.prop('checked');var boxval=$el.val();if(boxval!=='on'&&boxval!=null){val=val?$el.val():null;}}
return val;}},{selector:'select',events:['change'],update:function($el,val,model,options){var optList,selectConfig=options.selectOptions,list=selectConfig&&selectConfig.collection||undefined,isMultiple=$el.prop('multiple');if(!selectConfig){selectConfig={};var getList=function($el){return $el.map(function(){return{value:this.value,label:this.text};}).get();};if($el.find('optgroup').length){list={opt_labels:[]};if($el.find('> option').length){list.opt_labels.push(undefined);_.each($el.find('> option'),function(el){list[undefined]=getList(Backbone.$(el));});}
_.each($el.find('optgroup'),function(el){var label=Backbone.$(el).attr('label');list.opt_labels.push(label);list[label]=getList(Backbone.$(el).find('option'));});}else{list=getList($el.find('option'));}}
selectConfig.valuePath=selectConfig.valuePath||'value';selectConfig.labelPath=selectConfig.labelPath||'label';var addSelectOptions=function(optList,$el,fieldVal){_.each(optList,function(obj){var option=Backbone.$('<option/>'),optionVal=obj;var fillOption=function(text,val){option.text(text);optionVal=val;option.data('stickit_bind_val',optionVal);if(!_.isArray(optionVal)&&!_.isObject(optionVal))option.val(optionVal);};var text,val;if(obj==='__default__'){text=fieldVal.label,val=fieldVal.value;}else{text=evaluatePath(obj,selectConfig.labelPath),val=evaluatePath(obj,selectConfig.valuePath);}
fillOption(text,val);var isSelected=function(){if(!isMultiple&&optionVal!=null&&fieldVal!=null&&optionVal===fieldVal){return true}else if(_.isObject(fieldVal)&&_.isEqual(optionVal,fieldVal)){return true;}
return false;}
if(isSelected()){option.prop('selected',true);}else if(isMultiple&&_.isArray(fieldVal)){_.each(fieldVal,function(val){if(_.isObject(val))val=evaluatePath(val,selectConfig.valuePath);if(val===optionVal||(_.isObject(val)&&_.isEqual(optionVal,val)))
option.prop('selected',true);});}
$el.append(option);});};$el.find('*').remove();if(_.isString(list)){var context=window;if(list.indexOf('this.')===0)context=this;list=list.replace(/^[a-z]*\.(.+)$/,'$1');optList=evaluatePath(context,list);}else if(_.isFunction(list)){optList=applyViewFn.call(this,list,$el,options);}else{optList=list;}
if(optList instanceof Backbone.Collection)optList=optList.toJSON();if(selectConfig.defaultOption){var option=_.isFunction(selectConfig.defaultOption)?selectConfig.defaultOption.call(this,$el,options):selectConfig.defaultOption;addSelectOptions(["__default__"],$el,option);}
if(_.isArray(optList)){addSelectOptions(optList,$el,val);}else if(optList.opt_labels){_.each(optList.opt_labels,function(label){var $group=Backbone.$('<optgroup/>').attr('label',label);addSelectOptions(optList[label],$group,val);$el.append($group);});}else{var opts=[],opt;for(var i in optList){opt={};opt[selectConfig.valuePath]=i;opt[selectConfig.labelPath]=optList[i];opts.push(opt);}
opts=_.sortBy(opts,selectConfig.comparator||selectConfig.labelPath);addSelectOptions(opts,$el,val);}},getVal:function($el){var selected=$el.find('option:selected');if($el.prop('multiple')){return _.map(selected,function(el){return Backbone.$(el).data('stickit_bind_val');});}else{return selected.data('stickit_bind_val');}}}]);Backbone.Stickit=Stickit;return Backbone.Stickit;}));(function(factory){if(typeof define==='function'&&define.amd){define(['backbone','underscore'],factory);}else if(typeof exports==='object'){module.exports=factory(require('backbone'),require('underscore'));}else{factory(window.Backbone,window._);}})(function(Backbone,_){'use strict';var Validator=Backbone.Validator={version:'0.3.0',validate:function(attrs,validations,context){var errors={};_.each(attrs,function(attrValue,attrName){var validation=validations[attrName];if(validation){var error=this._validateAll(validation,attrName,attrValue,context,attrs);if(error.length){errors[attrName]=_.uniq(error);}}},this);return _.size(errors)?errors:null;},_validateAll:function(validations,attrName,attrValue,context,allAttrs){context=context||this;return _.inject(_.flatten([validations||[]]),function(errors,validation){_.chain(validation).omit('message').each(function(attrExpectation,validatorName){var validator=this._validators[validatorName];if(!validator){throw new Error('Missed validator: '+validatorName);}
var result=validator.fn.apply(context,[attrValue,attrExpectation,allAttrs]);if(result!==true){var error=validation.message||result||createErrorMessage(attrName,attrValue,attrExpectation,validatorName,context)||validator.message||'Invalid';if(_.isFunction(error)){error=error.apply(context,[attrName,attrValue,attrExpectation,validatorName]);}
errors.push(error);}},this);return errors;},[],this);},add:function(validatorName,validatorFn,errorMessage){this._validators[validatorName]={fn:validatorFn,message:errorMessage};},_validators:{}};Validator.Extensions={View:{bindValidation:function(model,options){model=model||this.model;if(!model){throw'Model is not provided';}
this.listenTo(model,'validated',function(model,attributes,errors){var callbacks=_.extend({},Validator.ViewCallbacks,_.pick(this,'onInvalidField','onValidField'),options);errors=errors||{};_.each(attributes,function(value,name){var attrErrors=errors[name];if(attrErrors&&attrErrors.length){callbacks.onInvalidField.call(this,name,value,attrErrors,model);}else{callbacks.onValidField.call(this,name,value,model);}},this);});}},Model:{validate:function(attributes,options){var validation=_.result(this,'validation')||{},attrs=getAttrsToValidate(this,attributes),errors=Validator.validate(attrs,validation,this);options=options||{};errors=options.processErrors?options.processErrors(errors):Validator.ModelCallbacks.processErrors(errors);if(!options.silent){_.defer(_.bind(this.triggerValidated,this),attrs,errors);}
return options&&options.suppress?null:errors;},_validate:function(attributes,options){if(!options.validate||!this.validate)return true;var attrs=getAttrsToValidate(this,attributes),errors=this.validationError=this.validate(attrs,options)||null;if(errors){this.trigger('invalid',this,errors,_.extend(options||{},{validationError:errors}));}
return!errors;},triggerValidated:function(attributes,errors){var attrs=getAttrsToValidate(this,attributes),errs=getCleanErrors(errors);this.validationError=errs;this.trigger('validated',this,attrs,errs);this.trigger('validated:'+(errs?'invalid':'valid'),this,attrs,errs);},isValid:function(attributes,options){var attrs=getAttrsToValidate(this,attributes);return!this.validate||!this.validate(attrs,options);}}};var pick=function(object,keys){return _.inject(_.flatten([keys]),function(memo,key){memo[key]=object[key];return memo;},{});};var getAttrsToValidate=function(model,passedAttrs){var modelAttrs=model.attributes,validationAttrs=_.result(model,'validation'),attrs,all;if(_.isArray(passedAttrs)||_.isString(passedAttrs)){attrs=pick(modelAttrs,passedAttrs);}else if(!passedAttrs){all=_.extend({},modelAttrs,validationAttrs||{});attrs=pick(modelAttrs,_.keys(all));}else{attrs=passedAttrs;}
return attrs;};var getCleanErrors=function(allErrors){var cleanErrors=_.inject(allErrors,function(memo,fieldErrors,attr){if(fieldErrors.length){memo[attr]=_.isString(fieldErrors)?[fieldErrors]:fieldErrors;}
return memo;},{});return _.size(cleanErrors)?cleanErrors:null;};var createErrorMessage=function(){return Validator.createMessage?Validator.createMessage.apply(null,arguments):false;};Validator.ViewCallbacks={onValidField:function(name){var input=this.$('input[name="'+name+'"]');input.removeClass('error');input.next('.error-text').remove();},onInvalidField:function(name,value,errors){var input=this.$('input[name="'+name+'"]');input.next('.error-text').remove();input.addClass('error').after('<div class="error-text">'+errors.join(', ')+'</div>');}};Validator.ModelCallbacks={processErrors:function(errors){return errors;}};var validators=[{name:'required',message:'Is required',fn:function(value,expectation){return expectation===false||!!value;}},{name:'blank',message:'Could not be blank',fn:function(value,expectation){if(expectation===true){return true;}
if(_.isString(value)){return!value.match(/^[\s\t\r\n]*$/);}if(_.isArray(value)){return!!value.length;}else if(_.isObject(value)){return!_.isEmpty(value);}else{return!!value;}}},{name:'collection',fn:function(collection,expectation){if(expectation===false||!collection){return true;}
if(typeof expectation==='function'){collection=expectation.call(this,collection);}
var errors=_.inject(collection.models||collection,function(memo,model,index){var error=model.validate();if(error){memo.push([index,error]);}
return memo;},[]);return errors.length?errors:true;}},{name:'model',fn:function(model,expectation){if(expectation===false||!model){return true;}
if(typeof expectation==='function'){model=expectation.call(this,model);}
return model.validate()||true;}},{name:'minLength',message:'Is too short',fn:function(value,expectation){return!value||value.length>=expectation;}},{name:'maxLength',message:'Is too long',fn:function(value,expectation){return!value||value.length<=expectation;}},{name:'format',message:'Does not match format',fn:function(value,expectation){return!value||!!value.toString().match(Validator.formats[expectation]||expectation);}},{name:'fn',fn:function(value,expectation,allAttrs){return expectation.call(this,value,allAttrs);}}];Validator.formats={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i};_.each(validators,function(validator){Validator.add(validator.name,validator.fn,validator.message);});_.extend(Backbone.Model.prototype,Validator.Extensions.Model);_.extend(Backbone.View.prototype,Validator.Extensions.View);return Validator;});
/*!
 * Backbone.GoogleMaps
 * A Backbone JS layer for the GoogleMaps API
 * Copyright (c)2012 Edan Schwartz
 * Distributed under MIT license
 * https://github.com/eschwartz/backbone.googlemaps
 */
(function(root,factory){if(typeof define==='function'&&define.amd){define(['backbone','underscore','jquery'],factory);}
else{factory(root.Backbone,root._,root.jQuery||root.Zepto||root.ender);}}(this,function(Backbone,_,$){'use strict';var GoogleMaps={};GoogleMaps.Location=Backbone.Model.extend({constructor:function(){_.bindAll(this,'select','deselect','toggleSelect','getLatLng','getLatlng');this.defaults=_.extend({},{lat:0,lng:0,selected:false,highlighted:false,title:""},this.defaults);Backbone.Model.prototype.constructor.apply(this,arguments);this.on("change:selected",function(model,isSelected){var topic=isSelected?"selected":"deselected";this.trigger(topic,this);},this);},select:function(){this.set("selected",true);},deselect:function(){this.set("selected",false);},highlight:function(){this.set("highlighted",true);},dehighlight:function(){this.set("highlighted",false);},toggleSelect:function(){this.set("selected",!this.get("selected"));},getLatlng:function(){return this.getLatLng();},getLatLng:function(){return new google.maps.LatLng(this.get("lat"),this.get("lng"));}});GoogleMaps.LocationCollection=Backbone.Collection.extend({constructor:function(opt_models,opt_options){var options=_.defaults({},opt_options,{model:GoogleMaps.Location});options.model||(options.model=GoogleMaps.Location);Backbone.Collection.prototype.constructor.call(this,opt_models,options);this.on("change:selected",function(selectedModel,isSelected){if(isSelected){this.each(function(model){if(selectedModel.cid!==model.cid){model.deselect();}});}},this);}});GoogleMaps.MapView=Backbone.View.extend({constructor:function(options){_.bindAll(this,'render','close');this.mapEvents=this.mapEvents||{};this.overlayOptions=this.overlayOptions||{};Backbone.View.prototype.constructor.apply(this,arguments);this.options=options;if(!google||!google.maps)throw new Error("Google maps API is not loaded.");if(!this.options.map&&!this.map)throw new Error("A map must be specified.");this.gOverlay=this.map=this.options.map||this.map;_.extend(this.overlayOptions,this.options.overlayOptions);},bindMapEvents:function(mapEvents,opt_context){var context=opt_context||this;mapEvents||(mapEvents=this.mapEvents);_.each(mapEvents,function(handlerRef,topic){var handler=this._getHandlerFromReference(handlerRef);this._addGoogleMapsListener(topic,handler,context);},this);},_getHandlerFromReference:function(handlerRef){var handler=_.isString(handlerRef)?this[handlerRef]:handlerRef;if(!_.isFunction(handler)){throw new Error("Unable to bind map event. "+handlerRef+" is not a valid event handler method");}
return handler;},_addGoogleMapsListener:function(topic,handler,opt_context){if(opt_context){handler=_.bind(handler,opt_context);}
google.maps.event.addListener(this.gOverlay,topic,handler);},render:function(){this.trigger('before:render');if(this.beforeRender){this.beforeRender();}
this.bindMapEvents();this.trigger('render');if(this.onRender){this.onRender();}
return this;},close:function(){this.trigger('before:close');if(this.beforeClose){this.beforeClose();}
google.maps.event.clearInstanceListeners(this.gOverlay);if(this.gOverlay.setMap){this.gOverlay.setMap(null);}
this.gOverlay=null;this.trigger('close');if(this.onClose){this.onClose();}}});GoogleMaps.InfoWindow=GoogleMaps.MapView.extend({constructor:function(){GoogleMaps.MapView.prototype.constructor.apply(this,arguments);_.bindAll(this,'render','close');if(!this.options.marker&&!this.marker)throw new Error("A marker must be specified for InfoWindow view.");this.marker=this.options.marker||this.marker;this.template=this.template||this.options.template;},render:function(){this.trigger('before:render');if(this.beforeRender){this.beforeRender();}
GoogleMaps.MapView.prototype.render.apply(this,arguments);var tmpl=(this.template)?$(this.template).html():'<h2><%=title %></h2>';this.$el.html(_.template(tmpl,this.model.toJSON()));this.gOverlay=new google.maps.InfoWindow(_.extend({content:this.$el[0]},this.overlayOptions));this.gOverlay.open(this.map,this.marker);this.trigger('render');if(this.onRender){this.onRender();}
return this;},close:function(){this.trigger('before:close');if(this.beforeClose){this.beforeClose();}
GoogleMaps.MapView.prototype.close.apply(this,arguments);this.trigger('close');if(this.onClose){this.onClose();}
return this;}});GoogleMaps.MarkerView=GoogleMaps.MapView.extend({constructor:function(){this.infoWindow=this.infoWindow||GoogleMaps.InfoWindow;GoogleMaps.MapView.prototype.constructor.apply(this,arguments);_.bindAll(this,'render','close','openDetail','closeDetail','toggleSelect');if(!this.model)throw new Error("A model must be specified for a MarkerView");this.gOverlay=new google.maps.Marker(_.extend({position:this.model.getLatLng(),map:this.map,title:this.model.get('title'),animation:google.maps.Animation.DROP,visible:false},this.overlayOptions));_.extend(this.mapEvents,{'click':'toggleSelect'});this.model.on("change:selected",function(model,isSelected){if(isSelected){this.openDetail();}
else{this.closeDetail();}},this);this.model.on("change:lat change:lng",this.refreshOverlay,this);this.bindMapEvents({'position_changed':'updateModelPosition'});},refreshOverlay:function(){if(!this.model.getLatLng().equals(this.gOverlay.getPosition())){this.gOverlay.setOptions({position:this.model.getLatLng()});}},updateModelPosition:function(){var newPosition=this.gOverlay.getPosition();if(!this.model.getLatLng().equals(newPosition)){this.model.set({lat:newPosition.lat(),lng:newPosition.lng()});}},toggleSelect:function(){this.model.toggleSelect();},render:function(){this.trigger('before:render');if(this.beforeRender){this.beforeRender();}
GoogleMaps.MapView.prototype.render.apply(this,arguments);this.gOverlay.setVisible(true);this.trigger('render');if(this.onRender){this.onRender();}
return this;},close:function(){this.trigger('before:close');if(this.beforeClose){this.beforeClose();}
this.closeDetail();GoogleMaps.MapView.prototype.close.apply(this,arguments);this.model.off();this.trigger('close');if(this.onClose){this.onClose()}
return this;},openDetail:function(){this.detailView=new this.infoWindow({model:this.model,map:this.map,marker:this.gOverlay});this.detailView.render();},closeDetail:function(){if(this.detailView){this.detailView.close();this.detailView=null;}}});GoogleMaps.MarkerCollectionView=Backbone.View.extend({constructor:function(options){this.markerView=this.markerView||GoogleMaps.MarkerView;this.markerViewChildren=this.markerViewChildren||{};Backbone.View.prototype.constructor.apply(this,arguments);this.options=options;_.bindAll(this,'render','closeChildren','closeChild','addChild','refresh','close');if(!this.options.map&&!this.map)throw new Error("A map must be specified on MarkerCollectionView instantiation");this.map||(this.map=this.options.map);this.collection.on("reset",this.refresh,this);this.collection.on("add",this.addChild,this);this.collection.on("remove",this.closeChild,this);},render:function(collection){var collection=collection||this.collection;this.trigger('before:render');if(this.beforeRender){this.beforeRender();}
collection.each(this.addChild);this.trigger('render');if(this.onRender){this.onRender();}
return this;},closeChildren:function(){for(var cid in this.markerViewChildren){this.closeChild(this.markerViewChildren[cid]);}},closeChild:function(child){var childView=(child instanceof Backbone.Model)?this.markerViewChildren[child.cid]:child;childView.close();delete this.markerViewChildren[childView.model.cid];},addChild:function(childModel){var markerView=new this.markerView({model:childModel,map:this.map});this.markerViewChildren[childModel.cid]=markerView;markerView.render();},refresh:function(){this.closeChildren();this.render();},close:function(){this.closeChildren();this.collection.off();}});Backbone.GoogleMaps=GoogleMaps;return GoogleMaps;}));(function(factory){if(typeof exports=="object"){module.exports=factory(require("underscore"),require("backbone"));}
else if(typeof define=="function"&&define.amd){define(["underscore","backbone"],factory);}
else if(typeof _!=="undefined"&&typeof Backbone!=="undefined"){var oldPageableCollection=Backbone.PageableCollection;var PageableCollection=factory(_,Backbone);Backbone.PageableCollection.noConflict=function(){Backbone.PageableCollection=oldPageableCollection;return PageableCollection;};}}(function(_,Backbone){"use strict";var _extend=_.extend;var _omit=_.omit;var _clone=_.clone;var _each=_.each;var _pick=_.pick;var _contains=_.contains;var _isEmpty=_.isEmpty;var _pairs=_.pairs;var _invert=_.invert;var _isArray=_.isArray;var _isFunction=_.isFunction;var _isObject=_.isObject;var _keys=_.keys;var _isUndefined=_.isUndefined;var _result=_.result;var ceil=Math.ceil;var floor=Math.floor;var max=Math.max;var BBColProto=Backbone.Collection.prototype;function finiteInt(val,name){if(!_.isNumber(val)||_.isNaN(val)||!_.isFinite(val)||~~val!==val){throw new TypeError("`"+name+"` must be a finite integer");}
return val;}
function queryStringToParams(qs){var kvp,k,v,ls,params={},decode=decodeURIComponent;var kvps=qs.split('&');for(var i=0,l=kvps.length;i<l;i++){var param=kvps[i];kvp=param.split('='),k=kvp[0],v=kvp[1]||true;k=decode(k),v=decode(v),ls=params[k];if(_isArray(ls))ls.push(v);else if(ls)params[k]=[ls,v];else params[k]=v;}
return params;}
function runOnceAtLastHandler(col,event,func){var eventHandlers=col._events[event];if(eventHandlers&&eventHandlers.length){var lastHandler=eventHandlers[eventHandlers.length-1];var oldCallback=lastHandler.callback;lastHandler.callback=function(){try{oldCallback.apply(this,arguments);func();}
catch(e){throw e;}
finally{lastHandler.callback=oldCallback;}};}
else func();}
var PARAM_TRIM_RE=/[\s'"]/g;var URL_TRIM_RE=/[<>\s'"]/g;var PageableCollection=Backbone.PageableCollection=Backbone.Collection.extend({state:{firstPage:1,lastPage:null,currentPage:null,pageSize:25,totalPages:null,totalRecords:null,sortKey:null,order:-1},mode:"server",queryParams:{currentPage:"page",pageSize:"per_page",totalPages:"total_pages",totalRecords:"total_entries",sortKey:"sort_by",order:"order",directions:{"-1":"asc","1":"desc"}},constructor:function(models,options){BBColProto.constructor.apply(this,arguments);options=options||{};var mode=this.mode=options.mode||this.mode||PageableProto.mode;var queryParams=_extend({},PageableProto.queryParams,this.queryParams,options.queryParams||{});queryParams.directions=_extend({},PageableProto.queryParams.directions,this.queryParams.directions,queryParams.directions||{});this.queryParams=queryParams;var state=this.state=_extend({},PageableProto.state,this.state,options.state||{});state.currentPage=state.currentPage==null?state.firstPage:state.currentPage;if(!_isArray(models))models=models?[models]:[];models=models.slice();if(mode!="server"&&state.totalRecords==null&&!_isEmpty(models)){state.totalRecords=models.length;}
this.switchMode(mode,_extend({fetch:false,resetState:false,models:models},options));var comparator=options.comparator;if(state.sortKey&&!comparator){this.setSorting(state.sortKey,state.order,options);}
if(mode!="server"){var fullCollection=this.fullCollection;if(comparator&&options.full){this.comparator=null;fullCollection.comparator=comparator;}
if(options.full)fullCollection.sort();if(models&&!_isEmpty(models)){this.reset(models,_extend({silent:true},options));this.getPage(state.currentPage);models.splice.apply(models,[0,models.length].concat(this.models));}}
this._initState=_clone(this.state);},_makeFullCollection:function(models,options){var properties=["url","model","sync","comparator"];var thisProto=this.constructor.prototype;var i,length,prop;var proto={};for(i=0,length=properties.length;i<length;i++){prop=properties[i];if(!_isUndefined(thisProto[prop])){proto[prop]=thisProto[prop];}}
var fullCollection=new(Backbone.Collection.extend(proto))(models,options);for(i=0,length=properties.length;i<length;i++){prop=properties[i];if(this[prop]!==thisProto[prop]){fullCollection[prop]=this[prop];}}
return fullCollection;},_makeCollectionEventHandler:function(pageCol,fullCol){return function collectionEventHandler(event,model,collection,options){var handlers=pageCol._handlers;_each(_keys(handlers),function(event){var handler=handlers[event];pageCol.off(event,handler);fullCol.off(event,handler);});var state=_clone(pageCol.state);var firstPage=state.firstPage;var currentPage=firstPage===0?state.currentPage:state.currentPage-1;var pageSize=state.pageSize;var pageStart=currentPage*pageSize,pageEnd=pageStart+pageSize;if(event=="add"){var pageIndex,fullIndex,addAt,colToAdd,options=options||{};if(collection==fullCol){fullIndex=fullCol.indexOf(model);if(fullIndex>=pageStart&&fullIndex<pageEnd){colToAdd=pageCol;pageIndex=addAt=fullIndex-pageStart;}}
else{pageIndex=pageCol.indexOf(model);fullIndex=pageStart+pageIndex;colToAdd=fullCol;var addAt=!_isUndefined(options.at)?options.at+pageStart:fullIndex;}
if(!options.onRemove){++state.totalRecords;delete options.onRemove;}
pageCol.state=pageCol._checkState(state);if(colToAdd){colToAdd.add(model,_extend({},options||{},{at:addAt}));var modelToRemove=pageIndex>=pageSize?model:!_isUndefined(options.at)&&addAt<pageEnd&&pageCol.length>pageSize?pageCol.at(pageSize):null;if(modelToRemove){runOnceAtLastHandler(collection,event,function(){pageCol.remove(modelToRemove,{onAdd:true});});}}}
if(event=="remove"){if(!options.onAdd){if(!--state.totalRecords){state.totalRecords=null;state.totalPages=null;}
else{var totalPages=state.totalPages=ceil(state.totalRecords / pageSize);state.lastPage=firstPage===0?totalPages-1:totalPages||firstPage;if(state.currentPage>totalPages)state.currentPage=state.lastPage;}
pageCol.state=pageCol._checkState(state);var nextModel,removedIndex=options.index;if(collection==pageCol){if(nextModel=fullCol.at(pageEnd)){runOnceAtLastHandler(pageCol,event,function(){pageCol.push(nextModel,{onRemove:true});});}
fullCol.remove(model);}
else if(removedIndex>=pageStart&&removedIndex<pageEnd){if(nextModel=fullCol.at(pageEnd-1)){runOnceAtLastHandler(pageCol,event,function(){pageCol.push(nextModel,{onRemove:true});});}
pageCol.remove(model);}}
else delete options.onAdd;}
if(event=="reset"){options=collection;collection=model;if(collection==pageCol&&options.from==null&&options.to==null){var head=fullCol.models.slice(0,pageStart);var tail=fullCol.models.slice(pageStart+pageCol.models.length);fullCol.reset(head.concat(pageCol.models).concat(tail),options);}
else if(collection==fullCol){if(!(state.totalRecords=fullCol.models.length)){state.totalRecords=null;state.totalPages=null;}
if(pageCol.mode=="client"){state.lastPage=state.currentPage=state.firstPage;}
pageCol.state=pageCol._checkState(state);pageCol.reset(fullCol.models.slice(pageStart,pageEnd),_extend({},options,{parse:false}));}}
if(event=="sort"){options=collection;collection=model;if(collection===fullCol){pageCol.reset(fullCol.models.slice(pageStart,pageEnd),_extend({},options,{parse:false}));}}
_each(_keys(handlers),function(event){var handler=handlers[event];_each([pageCol,fullCol],function(col){col.on(event,handler);var callbacks=col._events[event]||[];callbacks.unshift(callbacks.pop());});});};},_checkState:function(state){var mode=this.mode;var links=this.links;var totalRecords=state.totalRecords;var pageSize=state.pageSize;var currentPage=state.currentPage;var firstPage=state.firstPage;var totalPages=state.totalPages;if(totalRecords!=null&&pageSize!=null&&currentPage!=null&&firstPage!=null&&(mode=="infinite"?links:true)){totalRecords=finiteInt(totalRecords,"totalRecords");pageSize=finiteInt(pageSize,"pageSize");currentPage=finiteInt(currentPage,"currentPage");firstPage=finiteInt(firstPage,"firstPage");if(pageSize<1){throw new RangeError("`pageSize` must be >= 1");}
totalPages=state.totalPages=ceil(totalRecords / pageSize);if(firstPage<0||firstPage>1){throw new RangeError("`firstPage must be 0 or 1`");}
state.lastPage=firstPage===0?max(0,totalPages-1):totalPages||firstPage;if(mode=="infinite"){if(!links[currentPage+'']){throw new RangeError("No link found for page "+currentPage);}}
else if(currentPage<firstPage||(totalPages>0&&(firstPage?currentPage>totalPages:currentPage>=totalPages))){throw new RangeError("`currentPage` must be firstPage <= currentPage "+
(firstPage?">":">=")+" totalPages if "+firstPage+"-based. Got "+
currentPage+'.');}}
return state;},setPageSize:function(pageSize,options){pageSize=finiteInt(pageSize,"pageSize");options=options||{first:false};var state=this.state;var totalPages=ceil(state.totalRecords / pageSize);var currentPage=totalPages?max(state.firstPage,floor(totalPages*state.currentPage / state.totalPages)):state.firstPage;state=this.state=this._checkState(_extend({},state,{pageSize:pageSize,currentPage:options.first?state.firstPage:currentPage,totalPages:totalPages}));return this.getPage(state.currentPage,_omit(options,["first"]));},switchMode:function(mode,options){if(!_contains(["server","client","infinite"],mode)){throw new TypeError('`mode` must be one of "server", "client" or "infinite"');}
options=options||{fetch:true,resetState:true};var state=this.state=options.resetState?_clone(this._initState):this._checkState(_extend({},this.state));this.mode=mode;var self=this;var fullCollection=this.fullCollection;var handlers=this._handlers=this._handlers||{},handler;if(mode!="server"&&!fullCollection){fullCollection=this._makeFullCollection(options.models||[],options);fullCollection.pageableCollection=this;this.fullCollection=fullCollection;var allHandler=this._makeCollectionEventHandler(this,fullCollection);_each(["add","remove","reset","sort"],function(event){handlers[event]=handler=_.bind(allHandler,{},event);self.on(event,handler);fullCollection.on(event,handler);});fullCollection.comparator=this._fullComparator;}
else if(mode=="server"&&fullCollection){_each(_keys(handlers),function(event){handler=handlers[event];self.off(event,handler);fullCollection.off(event,handler);});delete this._handlers;this._fullComparator=fullCollection.comparator;delete this.fullCollection;}
if(mode=="infinite"){var links=this.links={};var firstPage=state.firstPage;var totalPages=ceil(state.totalRecords / state.pageSize);var lastPage=firstPage===0?max(0,totalPages-1):totalPages||firstPage;for(var i=state.firstPage;i<=lastPage;i++){links[i]=this.url;}}
else if(this.links)delete this.links;return options.fetch?this.fetch(_omit(options,"fetch","resetState")):this;},hasPreviousPage:function(){var state=this.state;var currentPage=state.currentPage;if(this.mode!="infinite")return currentPage>state.firstPage;return!!this.links[currentPage-1];},hasNextPage:function(){var state=this.state;var currentPage=this.state.currentPage;if(this.mode!="infinite")return currentPage<state.lastPage;return!!this.links[currentPage+1];},getFirstPage:function(options){return this.getPage("first",options);},getPreviousPage:function(options){return this.getPage("prev",options);},getNextPage:function(options){return this.getPage("next",options);},getLastPage:function(options){return this.getPage("last",options);},getPage:function(index,options){var mode=this.mode,fullCollection=this.fullCollection;options=options||{fetch:false};var state=this.state,firstPage=state.firstPage,currentPage=state.currentPage,lastPage=state.lastPage,pageSize=state.pageSize;var pageNum=index;switch(index){case"first":pageNum=firstPage;break;case"prev":pageNum=currentPage-1;break;case"next":pageNum=currentPage+1;break;case"last":pageNum=lastPage;break;default:pageNum=finiteInt(index,"index");}
this.state=this._checkState(_extend({},state,{currentPage:pageNum}));options.from=currentPage,options.to=pageNum;var pageStart=(firstPage===0?pageNum:pageNum-1)*pageSize;var pageModels=fullCollection&&fullCollection.length?fullCollection.models.slice(pageStart,pageStart+pageSize):[];if((mode=="client"||(mode=="infinite"&&!_isEmpty(pageModels)))&&!options.fetch){this.reset(pageModels,_omit(options,"fetch"));return this;}
if(mode=="infinite")options.url=this.links[pageNum];return this.fetch(_omit(options,"fetch"));},getPageByOffset:function(offset,options){if(offset<0){throw new RangeError("`offset must be > 0`");}
offset=finiteInt(offset);var page=floor(offset / this.state.pageSize);if(this.state.firstPage!==0)page++;if(page>this.state.lastPage)page=this.state.lastPage;return this.getPage(page,options);},sync:function(method,model,options){var self=this;if(self.mode=="infinite"){var success=options.success;var currentPage=self.state.currentPage;options.success=function(resp,status,xhr){var links=self.links;var newLinks=self.parseLinks(resp,_extend({xhr:xhr},options));if(newLinks.first)links[self.state.firstPage]=newLinks.first;if(newLinks.prev)links[currentPage-1]=newLinks.prev;if(newLinks.next)links[currentPage+1]=newLinks.next;if(success)success(resp,status,xhr);};}
return(BBColProto.sync||Backbone.sync).call(self,method,model,options);},parseLinks:function(resp,options){var links={};var linkHeader=options.xhr.getResponseHeader("Link");if(linkHeader){var relations=["first","prev","next"];_each(linkHeader.split(","),function(linkValue){var linkParts=linkValue.split(";");var url=linkParts[0].replace(URL_TRIM_RE,'');var params=linkParts.slice(1);_each(params,function(param){var paramParts=param.split("=");var key=paramParts[0].replace(PARAM_TRIM_RE,'');var value=paramParts[1].replace(PARAM_TRIM_RE,'');if(key=="rel"&&_contains(relations,value))links[value]=url;});});}
return links;},parse:function(resp,options){var newState=this.parseState(resp,_clone(this.queryParams),_clone(this.state),options);if(newState)this.state=this._checkState(_extend({},this.state,newState));return this.parseRecords(resp,options);},parseState:function(resp,queryParams,state,options){if(resp&&resp.length===2&&_isObject(resp[0])&&_isArray(resp[1])){var newState=_clone(state);var serverState=resp[0];_each(_pairs(_omit(queryParams,"directions")),function(kvp){var k=kvp[0],v=kvp[1];var serverVal=serverState[v];if(!_isUndefined(serverVal)&&!_.isNull(serverVal))newState[k]=serverState[v];});if(serverState.order){newState.order=_invert(queryParams.directions)[serverState.order]*1;}
return newState;}},parseRecords:function(resp,options){if(resp&&resp.length===2&&_isObject(resp[0])&&_isArray(resp[1])){return resp[1];}
return resp;},fetch:function(options){options=options||{};var state=this._checkState(this.state);var mode=this.mode;if(mode=="infinite"&&!options.url){options.url=this.links[state.currentPage];}
var data=options.data||{};var url=_result(options,"url")||_result(this,"url")||'';var qsi=url.indexOf('?');if(qsi!=-1){_extend(data,queryStringToParams(url.slice(qsi+1)));url=url.slice(0,qsi);}
options.url=url;options.data=data;var queryParams=this.mode=="client"?_pick(this.queryParams,"sortKey","order"):_omit(_pick(this.queryParams,_keys(PageableProto.queryParams)),"directions");var i,kvp,k,v,kvps=_pairs(queryParams),thisCopy=_clone(this);for(i=0;i<kvps.length;i++){kvp=kvps[i],k=kvp[0],v=kvp[1];v=_isFunction(v)?v.call(thisCopy):v;if(state[k]!=null&&v!=null){data[v]=state[k];}}
if(state.sortKey&&state.order){var o=_isFunction(queryParams.order)?queryParams.order.call(thisCopy):queryParams.order;data[o]=this.queryParams.directions[state.order+""];}
else if(!state.sortKey)delete data[queryParams.order];var extraKvps=_pairs(_omit(this.queryParams,_keys(PageableProto.queryParams)));for(i=0;i<extraKvps.length;i++){kvp=extraKvps[i];v=kvp[1];v=_isFunction(v)?v.call(thisCopy):v;if(v!=null)data[kvp[0]]=v;}
if(mode!="server"){var self=this,fullCol=this.fullCollection;var success=options.success;options.success=function(col,resp,opts){opts=opts||{};if(_isUndefined(options.silent))delete opts.silent;else opts.silent=options.silent;var models=col.models;if(mode=="client")fullCol.reset(models,opts);else{fullCol.add(models,_extend({at:fullCol.length},_extend(opts,{parse:false})));self.trigger("reset",self,opts);}
if(success)success(col,resp,opts);};return BBColProto.fetch.call(this,_extend({},options,{silent:true}));}
return BBColProto.fetch.call(this,options);},_makeComparator:function(sortKey,order,sortValue){var state=this.state;sortKey=sortKey||state.sortKey;order=order||state.order;if(!sortKey||!order)return;if(!sortValue)sortValue=function(model,attr){return model.get(attr);};return function(left,right){var l=sortValue(left,sortKey),r=sortValue(right,sortKey),t;if(order===1)t=l,l=r,r=t;if(l===r)return 0;else if(l<r)return-1;return 1;};},setSorting:function(sortKey,order,options){var state=this.state;state.sortKey=sortKey;state.order=order=order||state.order;var fullCollection=this.fullCollection;var delComp=false,delFullComp=false;if(!sortKey)delComp=delFullComp=true;var mode=this.mode;options=_extend({side:mode=="client"?mode:"server",full:true},options);var comparator=this._makeComparator(sortKey,order,options.sortValue);var full=options.full,side=options.side;if(side=="client"){if(full){if(fullCollection)fullCollection.comparator=comparator;delComp=true;}
else{this.comparator=comparator;delFullComp=true;}}
else if(side=="server"&&!full){this.comparator=comparator;}
if(delComp)this.comparator=null;if(delFullComp&&fullCollection)fullCollection.comparator=null;return this;}});var PageableProto=PageableCollection.prototype;return PageableCollection;}));Handlebars.registerHelper('ifCond',function(v1,operator,v2,options){switch(operator){case'==':return(v1==v2)?options.fn(this):options.inverse(this);case'===':return(v1===v2)?options.fn(this):options.inverse(this);case'<':return(v1<v2)?options.fn(this):options.inverse(this);case'<=':return(v1<=v2)?options.fn(this):options.inverse(this);case'>':return(v1>v2)?options.fn(this):options.inverse(this);case'>=':return(v1>=v2)?options.fn(this):options.inverse(this);case'&&':return(v1&&v2)?options.fn(this):options.inverse(this);case'||':return(v1||v2)?options.fn(this):options.inverse(this);case'!==':return(v1!==v2)?options.fn(this):options.inverse(this);default:return options.inverse(this);}});Handlebars.registerHelper("last",function(array){return array[array.length-1];});Backbone.Marionette.TemplateCache.prototype.compileTemplate=function(rawTemplate){return Handlebars.compile(rawTemplate);};var HotspotsManager=new Marionette.Application();HotspotsManager.navigate=function(route,options){options||(options={});Backbone.history.navigate(route,options);};HotspotsManager.Router=Marionette.AppRouter.extend({routes:{':lat/:lng/:z(/cats/:cats)(/page/:page)(/search/:search)(/hotspot/:hotspot)':'init'},init:function(lat,lng,z,cats,page,search,hotspot){var filter=HotspotsManager.request('filter:entity');HotspotsManager.trigger('map:coordinates',lat,lng,z);if(cats){var catCollection=HotspotsManager.request('category:entities');var catIds=cats.split(';');catCollection.deselectAll();_.each(catIds,function(value){catCollection.select(catCollection.get(value));});}
if(page){filter.set('page',parseInt(page,10))}
if(search){filter.set('search',search);}
if(hotspot){filter.set('hotspot:selected',hotspot);var collection=HotspotsManager.request('hotspots:collection');collection.once('sync',function(){var model=collection.get(hotspot);HotspotsManager.trigger('hotspot:selected',model);});}}});HotspotsManager.getCurrentRoute=function(){return Backbone.history.fragment};HotspotsManager.on('initialize:after',function(options){Backbone.history.start();});HotspotsManager.addInitializer(function(){new HotspotsManager.Router();});jQuery(document).ready(function(){HotspotsManager.start();});HotspotsManager.module("Entities",function(Entities,HotspotsManager,Backbone,Marionette,$,_){Entities.Map=Backbone.Model.extend({defaults:{myLocation:'',mapStartPosition:HotspotsConfig.mapStartPosition,zoom:HotspotsConfig.mapStartZoom,backgroundColor:HotspotsConfig.mapBackgroundColor,mapTypeId:google.maps.MapTypeId[{0:"ROADMAP",1:"ROADMAP",2:"SATELLITE",3:"HYBRID",4:"TERRAIN"}[HotspotsConfig.mapType]],panControl:HotspotsConfig.panControl,panControlOptions:{position:google.maps.ControlPosition[HotspotsConfig.panControlPosition]},zoomControl:HotspotsConfig.zoomControl,zoomControlOptions:{style:google.maps.ZoomControlStyle[HotspotsConfig.zoomControlStyle],position:google.maps.ControlPosition[HotspotsConfig.zoomControlPosition]},mapTypeControl:HotspotsConfig.mapTypeControl,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle[HotspotsConfig.mapTypeControlStyle],position:google.maps.ControlPosition[HotspotsConfig.mapTypeControlPosition]},scaleControl:HotspotsConfig.scaleControl,streetViewControl:HotspotsConfig.streetViewControl,streetViewControlOptions:{position:google.maps.ControlPosition[HotspotsConfig.streetViewPosition]},overviewMapControl:HotspotsConfig.overviewMapControl,scrollwheel:HotspotsConfig.scrollwheel,gestureHandling:HotspotsConfig.gestureHandling,weatherLayer:HotspotsConfig.weatherLayer,weatherTemperatureUnit:HotspotsConfig.weatherTemperatureUnit,trafficLayer:HotspotsConfig.trafficLayer,transitLayer:HotspotsConfig.transitLayer,bicyclingLayer:HotspotsConfig.bicyclingLayer,fullscreenControl:HotspotsConfig.fullscreenControl},setCenter:function(){var self=this,myLocation=this.getMyLocation();if(myLocation){this.geocoder.geocode({'address':myLocation},function(results,status){self.set('center',results[0].geometry.location);});}else{var center=this.get('mapStartPosition'),type;if(((center).replace(/\s+/g,'')).match(/^-?\d+\.\d+\,-?\d+\.\d+$/)){center=(center.replace(/\s+/g,'')).split(',');for(var i=0;i<center.length;i++){center[i]=parseFloat(center[i]);}}
type=typeof center;if(type==='string'){this.geocoder.geocode({'address':center},function(point){if(!point.length){alert(center+" "+this.options.notFound);}else{self.set('center',point[0].geometry.location);}});}
if(type==='object'&&_.isArray(center)){this.set('center',new google.maps.LatLng(center[0],center[1]));}
if(HotspotsConfig.centerType==2&&HotspotsConfig.highAccuracy){navigator.geolocation.getCurrentPosition(function(position){self.set('center',new google.maps.LatLng(position.coords.latitude,position.coords.longitude));});}}},getMyLocation:function(){return $.cookie('hs-my-location');},setMyLocation:function(){$.cookie('hs-my-location',this.get('myLocation'),{expires:7,path:'/'});},initialize:function(){if(HotspotsConfig.styledMaps){try{this.set('styles',JSON.parse(HotspotsConfig.styledMaps));}catch(exception){console.log('Hotspots error: provided map style is incorrect');}}
this.trafficLayer=new google.maps.TrafficLayer();this.transitLayer=new google.maps.TransitLayer();this.bicyclingLayer=new google.maps.BicyclingLayer();this.geocoder=new google.maps.Geocoder();this.svService=new google.maps.StreetViewService();this.on('change:myLocation',this.setMyLocation,this);this.set('myLocation',this.getMyLocation());this.getBounds();},getBounds:function(){if(HotspotsManager.reqres.hasHandler('category:entities')){var cats=HotspotsManager.request('category:entities'),selected=cats.selected,south,west,north,east;if(!_.isEmpty(selected)){cats=new Backbone.Collection(_.values(selected));}
cats.each(function(cat){var bounds=cat.get('boundaries');if(bounds){south=south?Math.min(south,bounds.south):bounds.south;west=west?Math.min(west,bounds.west):bounds.west;north=north?Math.max(north,bounds.north):bounds.north;east=east?Math.max(east,bounds.east):bounds.east;}},this);if(south&&west&&north&&east){this.set('boundaries',new google.maps.LatLngBounds(new google.maps.LatLng(south,west),new google.maps.LatLng(north,east)));}}}});var API={model:false,getMapEntity:function(){if(!this.model){this.model=new Entities.Map()}
return this.model;}};HotspotsManager.reqres.setHandler("map:entity",function(){return API.getMapEntity();});});HotspotsManager.module("Entities",function(Entities,HotspotsManager,Backbone,Marionette,$,_){Entities.Direction=Backbone.Model.extend({defaults:{origin:'',originDisplayName:'',destination:'',destinationDisplayName:'',waypoints:[],mode:'DRIVING',units:'METRIC',avoidHighways:false,avoidTolls:false},validation:{origin:{required:true,message:HotspotsConfig.translations.enterValidAddress}},initialize:function(){this.on('change:origin',function(model,value){var self=this;if(typeof value==='object'){this.set('origin',new google.maps.LatLng(value.lat,value.lng),{silent:true});if(value.name.length){this.set('originDisplayName',value.name,{silent:true});}else{var geocoder=new google.maps.Geocoder();geocoder.geocode({location:{lat:value.lat,lng:value.lng}},function(results,status){if(status==google.maps.GeocoderStatus.OK){self.set('originDisplayName',results[0].formatted_address,{silent:true});}});}}else{this.set('originDisplayName',value);}});this.on('change:destination',function(model,value){var self=this;if(typeof value==='object'){this.set('destination',new google.maps.LatLng(value.lat,value.lng),{silent:true});if(value.name.length){this.set('destinationDisplayName',value.name,{silent:true});}else{var geocoder=new google.maps.Geocoder();geocoder.geocode({location:{lat:value.lat,lng:value.lng}},function(results,status){if(status==google.maps.GeocoderStatus.OK){self.set('destinationDisplayName',results[0].formatted_address,{silent:true});}});}}else{this.set('destinationDisplayName',value);}});},searchAddress:function(){var geocoder=new google.maps.Geocoder();geocoder.geocode({'address':this.get('origin')},function(results,status){HotspotsManager.trigger('directions:address',results,status);});},searchDirections:function(){var directions=new google.maps.DirectionsService();var request={origin:this.get('origin'),destination:this.get('destination'),waypoints:this.get('waypoints'),travelMode:google.maps.DirectionsTravelMode[this.get('mode')],unitSystem:google.maps.UnitSystem[this.get('units')],avoidHighways:this.get('avoidHighways'),avoidTolls:this.get('avoidTolls')};directions.route(request,function(result,status){HotspotsManager.trigger('directions:directions',result,status);});}});var API={renderer:false,entity:false,getDirectionEntity:function(){if(!this.entity){this.entity=new Entities.Direction();}
return this.entity;},getDirectionRenderer:function(){if(!this.renderer){this.renderer=new google.maps.DirectionsRenderer({draggable:true});}
return this.renderer;}};HotspotsManager.reqres.setHandler("direction:entity",function(){return API.getDirectionEntity();});HotspotsManager.reqres.setHandler("direction:renderer",function(){return API.getDirectionRenderer();});});HotspotsManager.module("Entities",function(Entities,HotspotsManager,Backbone,Marionette,$,_){Entities.Marker=Backbone.GoogleMaps.Location.extend({});Entities.MarkerCollection=Backbone.Collection.extend({model:Entities.Marker,coord:{x:0,y:0},url:function(){var map=HotspotsManager.request('map:object'),filter=HotspotsManager.request('filter:entity'),zoom=map.mapObj.getZoom(),categories=filter.getCatIds().join(';'),search=filter.get('search'),params=['x='+this.coord.x,'y='+this.coord.y,'z='+zoom,'hs-language='+HotspotsConfig.language];if(categories){params.push('cats='+categories);}
if(search){params.push('search='+search);}
return HotspotsConfig.baseUrl+'?option=com_hotspots&view=tile&format=json&'+params.join('&');}});var entity;var API={getMarkerCollection:function(){return new Entities.MarkerCollection();},getMarkerEntity:function(){if(!entity)
{entity=new Entities.Marker(HotspotsMarker);}
return entity;}};HotspotsManager.reqres.setHandler("marker:collection",function(options){return API.getMarkerCollection();});HotspotsManager.reqres.setHandler("marker:entity",function(){return API.getMarkerEntity();});});HotspotsManager.module("Common.Views",function(Views,ContactManager,Backbone,Marionette,$,_){Views.PaginatedView=Marionette.Layout.extend({template:"#paginated-view",regions:{paginationControlsRegionTop:"#js-pagination-controls-top",paginationControlsRegionBottom:"#js-pagination-controls-bottom",paginationMainRegion:".js-pagination-main"},initialize:function(options){var self=this,listView,topControls,bottomControls;this.collection=options.collection;this.listenTo(this.collection,'request',this.loading);this.listenTo(this.collection,'sync',this.hide);this.listenTo(this.collection,'error',this.hide);listView=new options.mainView({collection:this.collection});topControls=new Views.PaginationControls({paginatedCollection:this.collection});bottomControls=new Views.PaginationControls({paginatedCollection:this.collection});this.listenTo(topControls,'page:change',function(page){self.trigger('page:change',page);});this.listenTo(bottomControls,'page:change',function(page){self.trigger('page:change',page);});this.on("show",function(){this.paginationControlsRegionTop.show(bottomControls);this.paginationControlsRegionBottom.show(topControls);this.paginationMainRegion.show(listView);});},loading:function(){this.$el.addClass('hs-loading');},hide:function(){this.$el.removeClass('hs-loading');}});Views.PaginationControls=Marionette.ItemView.extend({template:"#pagination-controls",className:"pagination pagination-mini text-center",events:{'click a[class=navigatable]':'navigateToPage'},initialize:function(options){this.paginatedCollection=options.paginatedCollection;this.listenTo(this.paginatedCollection,'sync',this.render);this.listenTo(this.paginatedCollection,"page:change:after",this.render);},navigateToPage:function(e){e.preventDefault();var page=parseInt($(e.target).data('page'),10);HotspotsManager.trigger('hotspots:page',page);this.trigger('page:change',page);},serializeData:function(){var info=_.clone(this.paginatedCollection.state);info.pageSet=this.paginatedCollection.setPagination(info);if(info.currentPage>1){info.previous=info.currentPage-1;}
if(info.currentPage<info.totalPages){info.next=info.currentPage+1;}
return info;}});Views.Loading=Marionette.ItemView.extend({template:"#loading-view",className:'hs-init-loading'});});HotspotsManager.module("Common.MapApp",function(MapApp,HotspotsManager,Backbone,Marionette,$,_){MapApp.MapView=Backbone.View.extend({template:'#map-template',id:'map'});MapApp.Map=Marionette.ItemView.extend({tagName:"div",template:'#main-map-template',id:'map-container',className:'hs-map-container',widthRestriction:0,events:{'click .js-hs-fullscreen-toggle':function(e){e.stopPropagation();HotspotsManager.trigger('map:fullscreen');var span=$(e.currentTarget).find('span');if(span.hasClass('fa-expand')){span.removeClass('fa-expand').addClass('fa-compress');}else{span.removeClass('fa-compress').addClass('fa-expand');}
this.resize();google.maps.event.trigger(this.mapObj,'resize');},'click .js-hs-geocode-center':'findUserPosition','click .js-hs-hotspots-share-mail':function(){HotspotsManager.trigger('share:mail');}},modelEvents:{'change:weatherLayer':function(){this.weather();},'change:trafficLayer':function(){this.setLayer('trafficLayer')},'change:transitLayer':function(){this.setLayer('transitLayer')},'change:bicyclingLayer':function(){this.setLayer('bicyclingLayer')},'change:center':function(){this.mapObj.setCenter(this.model.get('center'));},'change:zoom':function(){this.mapObj.setZoom(this.model.get('zoom'));}},kmlLayers:[],initialize:function(){var self=this;this.mapView=new MapApp.MapView();this.mapObj=new google.maps.Map(this.mapView.el,this.model.toJSON());HotspotsManager.on('directions:directions',function(results,status){self.renderDirections(results,status);});HotspotsManager.on('directions:clear',function(){self.clearDirections();});this.addCustomButtons();},addCustomButtons:function(){var topRight=document.createElement('div');topRight.innerHTML=$('#hs-fullscreen-template').html();topRight.index=-1;this.mapObj.controls[google.maps.ControlPosition.TOP_RIGHT].push(topRight);var rightBottom=document.createElement('div');rightBottom.innerHTML=$('#hs-action-buttons-map-template').html();rightBottom.index=-1;this.mapObj.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(rightBottom);},renderDirections:function(results,status){var directionsDisplay=HotspotsManager.request('direction:renderer');directionsDisplay.setMap(this.mapObj);},clearDirections:function(){var directionsDisplay=HotspotsManager.request('direction:renderer');directionsDisplay.setMap(null);},onRender:function(){this.$el.html(this.mapView.el);},onShow:function(){this.resize();},weather:function(){HotspotsManager.trigger('weather:toggle',this.mapObj);},setLayer:function(name){if(this.model.get(name)){this.model[name].setMap(this.mapObj);}
else{this.model[name].setMap(null);}},setWidthRestriction:function(width){this.widthRestriction=width;},zoomOnPoint:function(point,zoom){this.mapObj.setCenter(point);this.mapObj.setZoom(zoom);},streetView:function(pano,close){var panorama=this.mapObj.getStreetView();if(close){if(panorama.getVisible()){panorama.setVisible(false);}}else{panorama.setPano(pano);panorama.setVisible(panorama.getVisible()?false:true);}},findUserPosition:function(e){var self=this;$(e.target).removeClass('fa-crosshairs').addClass('fa-refresh fa-spin');navigator.geolocation.getCurrentPosition(function(position){var latlng=new google.maps.LatLng(position.coords.latitude,position.coords.longitude),imgUrl=HotspotsConfig.rootUrl+'/media/com_hotspots/images/v4/icons/bluedot_retina.png';self.zoomOnPoint(latlng,15);$(e.target).removeClass('fa-refresh fa-spin').addClass('fa-crosshairs');var image=new google.maps.MarkerImage(imgUrl,null,null,new google.maps.Point(8,8),new google.maps.Size(17,17));new google.maps.Marker({flat:true,icon:image,optimized:false,position:latlng,map:self.mapObj,title:HotspotsConfig.translations.myLocation,visible:true});setTimeout(function(){self.$el.find('div.gmnoprint:has(img[src="'+imgUrl+'"])').addClass('hs-my-position-dot')},2000)});},showKmlLayers:function(kmls){var self=this;_.each(self.kmlLayers,function(layer){layer.setMap(null);});self.kmlLayers.length=0;_.each(kmls,function(kml){var kmlLayer=new google.maps.KmlLayer(kml.file,{preserveViewport:true});kmlLayer.setMap(self.mapObj);self.kmlLayers.push(kmlLayer);});}});});HotspotsManager.module("HotspotMapApp",function(HotspotMapApp,HotspotsManager,Backbone,Marionette,$,_){var API={show:function(){HotspotMapApp.Show.Controller.show();},markers:function(marker){HotspotMapApp.Marker.Controller.draw(marker);}};this.listenTo(HotspotsManager,"map:show",function(){API.show();});this.listenTo(HotspotsManager,'initialize:after',function(options){HotspotsManager.trigger('map:show');var marker=HotspotsManager.request('marker:entity');marker.set(HotspotsMarker);API.markers(marker);});});HotspotsManager.module("HotspotMapApp.Show",function(Show,HotspotsManager,Backbone,Marionette,$,_){var Controller=Marionette.Controller.extend({show:function(){var view=HotspotsManager.request("map:object"),marker=HotspotsManager.request('marker:entity'),mapModel=HotspotsManager.request('map:entity');mapModel.set('center',new google.maps.LatLng(marker.get('lat'),marker.get('lng')));mapModel.set('zoom',HotspotsConfig.mapStartZoomSingle);['trafficLayer','transitLayer','bicyclingLayer'].forEach(function(layer){view.setLayer(layer);});var region=new Marionette.Region({el:"#js-hs-main-app"});region.show(view);},zoomInOnModel:function(model){var view=HotspotsManager.request("map:object");var point={lat:model.get('lat'),lng:model.get('lng')};view.zoomOnPoint(point,15);}});Show.Controller=new Controller();});HotspotsManager.module("HotspotMapApp.Show",function(Show,HotspotsManager,Backbone,Marionette,$,_){Show.MapView=HotspotsManager.Common.MapApp.MapView;Show.Map=HotspotsManager.Common.MapApp.Map.extend({cssCache:{},events:{'click .js-hs-fullscreen-toggle':function(e){e.stopPropagation();this.fullScreen();}},addCustomButtons:function(){var topRight=document.createElement('div');topRight.innerHTML=$('#hs-fullscreen-template').html();topRight.index=-1;this.mapObj.controls[google.maps.ControlPosition.TOP_RIGHT].push(topRight);},resize:function(){this.mapView.$el.css('height',HotspotsConfig.mapHeightSingle);google.maps.event.trigger(this.mapObj,'resize');},fullScreen:function(){var self=this,$=jQuery,$el=$(document.body);if(!$el.hasClass('hs-fullscreen')){$el.addClass('hs-fullscreen');this.cssCache.height=self.$el.height();$el.css('overflow','hidden').addClass('hotspots-fullscreen');this.mapView.$el.height($(window).height());}else{$el.removeClass('hs-fullscreen');$el.css('overflow','auto').removeClass('hotspots-fullscreen');this.mapView.$el.height(self.cssCache.height);}
google.maps.event.trigger(this.mapObj,'resize');}});var map;HotspotsManager.reqres.setHandler("map:object",function(){return(function(){if(!map){var model=HotspotsManager.request('map:entity');map=new Show.Map({model:model});}
return map;}());});});HotspotsManager.module("HotspotMapApp.Marker",function(Marker,HotspotsManager,Backbone,Marionette,$,_){Marker.Controller={places:false,render:false,addressMarker:'',draw:function(marker){var map=HotspotsManager.request("map:object");var markerView=new Marker.MarkerView({model:marker,map:map.mapObj});markerView.render();},fetchMarkers:function(){var entities=HotspotsManager.request('hotspots:entities');entities.done(function(hotspots){HotspotsManager.trigger('hotspots:fetchedData',hotspots);});},renderAddress:function(results,status){var map=HotspotsManager.request("map:object");if(status==google.maps.GeocoderStatus.OK){map.mapObj.setCenter(results[0].geometry.location);this.addressMarker=new google.maps.Marker({map:map.mapObj,position:results[0].geometry.location});}},clearAddressMarker:function(){this.addressMarker.setMap(null);}};});HotspotsManager.module("HotspotMapApp.Marker",function(Marker,HotspotsManager,Backbone,Marionette,$,_){Marker.MarkerView=Backbone.GoogleMaps.MarkerView.extend({beforeRender:function(){this.gOverlay.setIcon(this.model.get('icon'));},openDetail:function(){}});});HotspotsManager.module("DirectionsApp",function(DirectionsApp,HotspotsManager,Backbone,Marionette,$,_){var API={show:function(){DirectionsApp.Show.Controller.show();},search:function(origin,destination){DirectionsApp.Show.Controller.search(origin,destination);}};HotspotsManager.on('directions:search',function(origin,destination){API.search(origin,destination);});this.listenTo(HotspotsManager,'initialize:after',function(options){API.show();});});HotspotsManager.module("DirectionsApp.Show",function(Show,HotspotsManager,Backbone,Marionette,$,_){Show.Controller={show:function(){var model=HotspotsManager.request('direction:entity'),markerModel=HotspotsManager.request('marker:entity');var view=new Show.DirectionsView({model:model,markerModel:markerModel});var region=new Marionette.Region({el:'#js-hs-item-direction-region'});region.show(view);},search:function(origin,destination){var model=HotspotsManager.request('direction:entity');model.set('origin',origin);model.set('destination',destination);var view=new Show.DirectionsView({model:model});view.searchDestination();}};});HotspotsManager.module("DirectionsApp.Show",function(Show,HotspotsManager,Backbone,Marionette,$,_){Show.DirectionsView=Marionette.ItemView.extend({tagName:'div',className:'hs-directions',bindings:{'.js-hs-input-dir-desktop':{observe:'origin',onGet:'onGetOrigin'},'.js-hs-input-dir-phone':{observe:'origin',onGet:'onGetOrigin'}},onGetOrigin:function(value,options){if(this.model.get('originDisplayName')){return this.model.get('originDisplayName');}
return value;},events:{'keypress .js-hs-get-directions input':'keypressSearchDir','click .hs-quick-dir':'changeDir','click .js-hs-get-directions .js-hs-close':'clearDirections','click .js-hs-get-directions .js-hs-search':'searchDir'},keypressSearchDir:function(e){if(e.which===13){this.searchDir(e);}},clearDirections:function(e){HotspotsManager.trigger('directions:clear');var directionsDisplay=HotspotsManager.request("direction:renderer");$(directionsDisplay.getPanel()).html('');this.$el.find('input[type=text]').val('');},changeDir:function(e){e.stopPropagation();$(e.currentTarget).closest('.hs-get-directions').find('.hs-quick-dir').each(function(key,el){$(el).removeClass('active');});$(e.currentTarget).addClass('active');},searchDir:function(e){e.stopPropagation();var input=this.$el.find('.hs-get-directions input'),active=this.$el.find('.hs-quick-dir.active').data('id'),origin,destination;if(active=='from'){origin=input.val();destination={lat:this.markerModel.get('lat'),lng:this.markerModel.get('lng'),name:''}}else{destination=input.val();origin={lat:this.markerModel.get('lat'),lng:this.markerModel.get('lng'),name:''}}
HotspotsManager.trigger('directions:search',origin,destination);},template:'#js-hs-item-direction',initialize:function(options){this.markerModel=options.markerModel;},onRender:function(){var self=this;HotspotsManager.on('directions:directions',function(results,status){self.renderDirections(results,status);});this.bindValidation();this.stickit();},searchDestination:function(){this.model.searchDirections();},renderDirections:function(results,status){var map=HotspotsManager.request("map:object");var directionsDisplay=HotspotsManager.request("direction:renderer");directionsDisplay.setPanel(this.$el.find('.hs-directions-results')[0]);if(status==google.maps.DirectionsStatus.OK){$(directionsDisplay.getPanel()).html('');directionsDisplay.setDirections(results);}else if(status==google.maps.DirectionsStatus.NOT_FOUND){directionsDisplay.getPanel().set('html',Joomla.JText._('COM_HOTSPOTS_COULDNT_FIND_LOCATION'));}else if(status==google.maps.DirectionsStatus.ZERO_RESULTS){directionsDisplay.getPanel().set('html',Joomla.JText._('COM_HOTSPOTS_ZERO_RESULTS_LOCATION'));}}});});